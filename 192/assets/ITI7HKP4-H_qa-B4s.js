import{t as fe,c as X,s as N,i as me,g as ee,f as R,b as ve}from"./YV4JVR4I-I2hr8F_N.js";import{P as h,Q as q,T as Ie,E as D,J as Se,U as ge,R as pe,k as Ee,c as xe,_ as se,i as ye,V as be,S as te,W as z,C as we,d as H,n as W,u as Pe,o as ie,z as Ce,e as he,g as _e,h as ne,f as Fe,j as Ae,X as ke}from"./LMDWO4NN-UKOJDKde.js";import{C as Re,a as ae,b as Be,g as M,s as Ke,i as Q,f as Le,c as Te}from"./P2CTZE2T-CCDtm-Cx.js";import{P as Me,a as De}from"./MTZPJQMC-CDd5RuKT.js";import{r as K,j as Oe}from"./chunk-D52XG6IA-DUkyOzkQ.js";import{f as ze,h as We,u as Ue}from"./LVA2YJMS-PSCN4cPZ.js";function Ve(e){var s;const n=e.find(c=>!!c.element),t=[...e].reverse().find(c=>!!c.element);let i=(s=n==null?void 0:n.element)==null?void 0:s.parentElement;for(;i&&(t!=null&&t.element);){if(t&&i.contains(t.element))return i;i=i.parentElement}return Se(i).body}function He(e){return e==null?void 0:e.__unstablePrivateStore}function $e(e={}){var s;fe(e,e.store);const n=(s=e.store)==null?void 0:s.getState(),t=h(e.items,n==null?void 0:n.items,e.defaultItems,[]),i=new Map(t.map(a=>[a.id,a])),c={items:t,renderedItems:h(n==null?void 0:n.renderedItems,[])},l=He(e.store),u=X({items:t,renderedItems:c.renderedItems},l),r=X(c,e.store),P=a=>{const f=ge(a,m=>m.element);u.setState("renderedItems",f),r.setState("renderedItems",f)};N(r,()=>me(u)),N(u,()=>ee(u,["items"],a=>{r.setState("items",a.items)})),N(u,()=>ee(u,["renderedItems"],a=>{let f=!0,m=requestAnimationFrame(()=>{const{renderedItems:g}=r.getState();a.renderedItems!==g&&P(a.renderedItems)});if(typeof IntersectionObserver!="function")return()=>cancelAnimationFrame(m);const y=()=>{if(f){f=!1;return}cancelAnimationFrame(m),m=requestAnimationFrame(()=>P(a.renderedItems))},L=Ve(a.renderedItems),S=new IntersectionObserver(y,{root:L});for(const g of a.renderedItems)g.element&&S.observe(g.element);return()=>{cancelAnimationFrame(m),S.disconnect()}}));const I=(a,f,m=!1)=>{let y;return f(S=>{const g=S.findIndex(({id:b})=>b===a.id),_=S.slice();if(g!==-1){y=S[g];const b=D(D({},y),a);_[g]=b,i.set(a.id,b)}else _.push(a),i.set(a.id,a);return _}),()=>{f(S=>{if(!y)return m&&i.delete(a.id),S.filter(({id:b})=>b!==a.id);const g=S.findIndex(({id:b})=>b===a.id);if(g===-1)return S;const _=S.slice();return _[g]=y,i.set(a.id,y),_})}},T=a=>I(a,f=>u.setState("items",f),!0);return q(D({},r),{registerItem:T,renderItem:a=>Ie(T(a),I(a,f=>u.setState("renderedItems",f))),item:a=>{if(!a)return null;let f=i.get(a);if(!f){const{items:m}=u.getState();f=m.find(y=>y.id===a),f&&i.set(a,f)}return f||null},__unstablePrivateStore:u})}function je(e,s,n){return pe(s,[n.store]),R(e,n,"items","setItems"),e}function ue(e){const s=[];for(const n of e)s.push(...n);return s}function Y(e){return e.slice().reverse()}var Ne={id:null};function B(e,s){return e.find(n=>s?!n.disabled&&n.id!==s:!n.disabled)}function qe(e,s){return e.filter(n=>s?!n.disabled&&n.id!==s:!n.disabled)}function re(e,s){return e.filter(n=>n.rowId===s)}function Ge(e,s,n=!1){const t=e.findIndex(i=>i.id===s);return[...e.slice(t+1),...n?[Ne]:[],...e.slice(0,t)]}function ce(e){const s=[];for(const n of e){const t=s.find(i=>{var c;return((c=i[0])==null?void 0:c.rowId)===n.rowId});t?t.push(n):s.push([n])}return s}function le(e){let s=0;for(const{length:n}of e)n>s&&(s=n);return s}function Je(e){return{id:"__EMPTY_ITEM__",disabled:!0,rowId:e}}function Qe(e,s,n){const t=le(e);for(const i of e)for(let c=0;c<t;c+=1){const l=i[c];if(!l||n&&l.disabled){const r=c===0&&n?B(i):i[c-1];i[c]=r&&s!==r.id&&n?r:Je(r==null?void 0:r.rowId)}}return e}function Xe(e){const s=ce(e),n=le(s),t=[];for(let i=0;i<n;i+=1)for(const c of s){const l=c[i];l&&t.push(q(D({},l),{rowId:l.rowId?`${i}`:void 0}))}return t}function vt(e={}){var s;const n=(s=e.store)==null?void 0:s.getState(),t=$e(e),i=h(e.activeId,n==null?void 0:n.activeId,e.defaultActiveId),c=q(D({},t.getState()),{id:h(e.id,n==null?void 0:n.id,`id-${Math.random().toString(36).slice(2,8)}`),activeId:i,baseElement:h(n==null?void 0:n.baseElement,null),includesBaseElement:h(e.includesBaseElement,n==null?void 0:n.includesBaseElement,i===null),moves:h(n==null?void 0:n.moves,0),orientation:h(e.orientation,n==null?void 0:n.orientation,"both"),rtl:h(e.rtl,n==null?void 0:n.rtl,!1),virtualFocus:h(e.virtualFocus,n==null?void 0:n.virtualFocus,!1),focusLoop:h(e.focusLoop,n==null?void 0:n.focusLoop,!1),focusWrap:h(e.focusWrap,n==null?void 0:n.focusWrap,!1),focusShift:h(e.focusShift,n==null?void 0:n.focusShift,!1)}),l=X(c,t,e.store);N(l,()=>ve(l,["renderedItems","activeId"],r=>{l.setState("activeId",P=>{var I;return P!==void 0?P:(I=B(r.renderedItems))==null?void 0:I.id})}));const u=(r="next",P={})=>{var I,T;const a=l.getState(),{skip:f=0,activeId:m=a.activeId,focusShift:y=a.focusShift,focusLoop:L=a.focusLoop,focusWrap:S=a.focusWrap,includesBaseElement:g=a.includesBaseElement,renderedItems:_=a.renderedItems,rtl:b=a.rtl}=P,F=r==="up"||r==="down",U=r==="next"||r==="down",G=U?b&&!F:!b||F,$=y&&!f;let p=F?ue(Qe(ce(_),m,$)):_;if(p=G?Y(p):p,p=F?Xe(p):p,m==null)return(I=B(p))==null?void 0:I.id;const O=p.find(v=>v.id===m);if(!O)return(T=B(p))==null?void 0:T.id;const j=p.some(v=>v.rowId),J=p.indexOf(O),o=p.slice(J+1),d=re(o,O.rowId);if(f){const v=qe(d,m),w=v.slice(f)[0]||v[v.length-1];return w==null?void 0:w.id}const E=L&&(F?L!=="horizontal":L!=="vertical"),x=j&&S&&(F?S!=="horizontal":S!=="vertical"),C=U?(!j||F)&&E&&g:F?g:!1;if(E){const v=x&&!C?p:re(p,O.rowId),w=Ge(v,m,C),k=B(w,m);return k==null?void 0:k.id}if(x){const v=B(C?d:o,m);return C?(v==null?void 0:v.id)||null:v==null?void 0:v.id}const A=B(d,m);return!A&&C?null:A==null?void 0:A.id};return q(D(D({},t),l),{setBaseElement:r=>l.setState("baseElement",r),setActiveId:r=>l.setState("activeId",r),move:r=>{r!==void 0&&(l.setState("activeId",r),l.setState("moves",P=>P+1))},first:()=>{var r;return(r=B(l.getState().renderedItems))==null?void 0:r.id},last:()=>{var r;return(r=B(Y(l.getState().renderedItems)))==null?void 0:r.id},next:r=>(r!==void 0&&typeof r=="number"&&(r={skip:r}),u("next",r)),previous:r=>(r!==void 0&&typeof r=="number"&&(r={skip:r}),u("previous",r)),down:r=>(r!==void 0&&typeof r=="number"&&(r={skip:r}),u("down",r)),up:r=>(r!==void 0&&typeof r=="number"&&(r={skip:r}),u("up",r))})}function It(e,s,n){return e=je(e,s,n),R(e,n,"activeId","setActiveId"),R(e,n,"includesBaseElement"),R(e,n,"virtualFocus"),R(e,n,"orientation"),R(e,n,"rtl"),R(e,n,"focusLoop"),R(e,n,"focusWrap"),R(e,n,"focusShift"),e}K.createContext(void 0);var de=Ee([De,ae],[Me,Re]),St=de.useContext,gt=de.useProviderContext;K.createContext(void 0);K.createContext(!1);var Ye="div";function Ze(e){return e.some(s=>!!s.rowId)}function et(e){const s=e.target;return s&&!ie(s)?!1:e.key.length===1&&!e.ctrlKey&&!e.metaKey}function tt(e){return e.key==="Shift"||e.key==="Control"||e.key==="Alt"||e.key==="Meta"}function oe(e,s,n){return H(t=>{var i;if(s==null||s(t),t.defaultPrevented||t.isPropagationStopped()||!W(t)||tt(t)||et(t))return;const c=e.getState(),l=(i=M(e,c.activeId))==null?void 0:i.element;if(!l)return;const u=t,r=se(u,["view"]),P=n==null?void 0:n.current;l!==P&&l.focus(),ke(l,t.type,r)||t.preventDefault(),t.currentTarget.contains(l)&&t.stopPropagation()})}function nt(e){return Le(ue(Y(Te(e))))}function rt(e){const[s,n]=K.useState(!1),t=K.useCallback(()=>n(!0),[]),i=e.useState(c=>M(e,c.activeId));return K.useEffect(()=>{const c=i==null?void 0:i.element;s&&c&&(n(!1),c.focus({preventScroll:!0}))},[i,s]),t}var ot=xe(function(s){var n=s,{store:t,composite:i=!0,focusOnMove:c=i,moveOnKeyPress:l=!0}=n,u=se(n,["store","composite","focusOnMove","moveOnKeyPress"]);const r=Be();t=t||r,ye(t,!1);const P=K.useRef(null),I=K.useRef(null),T=rt(t),a=t.useState("moves"),[,f]=be(i?t.setBaseElement:null);K.useEffect(()=>{var o;if(!t||!a||!i||!c)return;const{activeId:d}=t.getState(),E=(o=M(t,d))==null?void 0:o.element;E&&ze(E)},[t,a,i,c]),te(()=>{if(!t||!a||!i)return;const{baseElement:o,activeId:d}=t.getState();if(!(d===null)||!o)return;const x=I.current;I.current=null,x&&z(x,{relatedTarget:o}),We(o)||o.focus()},[t,a,i]);const m=t.useState("activeId"),y=t.useState("virtualFocus");te(()=>{var o;if(!t||!i||!y)return;const d=I.current;if(I.current=null,!d)return;const x=((o=M(t,m))==null?void 0:o.element)||we(d);x!==d&&z(d,{relatedTarget:x})},[t,m,y,i]);const L=oe(t,u.onKeyDownCapture,I),S=oe(t,u.onKeyUpCapture,I),g=u.onFocusCapture,_=H(o=>{if(g==null||g(o),o.defaultPrevented||!t)return;const{virtualFocus:d}=t.getState();if(!d)return;const E=o.relatedTarget,x=Ke(o.currentTarget);W(o)&&x&&(o.stopPropagation(),I.current=E)}),b=u.onFocus,F=H(o=>{if(b==null||b(o),o.defaultPrevented||!i||!t)return;const{relatedTarget:d}=o,{virtualFocus:E}=t.getState();E?W(o)&&!Q(t,d)&&queueMicrotask(T):W(o)&&t.setActiveId(null)}),U=u.onBlurCapture,G=H(o=>{var d;if(U==null||U(o),o.defaultPrevented||!t)return;const{virtualFocus:E,activeId:x}=t.getState();if(!E)return;const C=(d=M(t,x))==null?void 0:d.element,A=o.relatedTarget,v=Q(t,A),w=I.current;I.current=null,W(o)&&v?(A===C?w&&w!==A&&z(w,o):C?z(C,o):w&&z(w,o),o.stopPropagation()):!Q(t,o.target)&&C&&z(C,o)}),$=u.onKeyDown,p=Pe(l),O=H(o=>{var d;if($==null||$(o),o.defaultPrevented||!t||!W(o))return;const{orientation:E,renderedItems:x,activeId:C}=t.getState(),A=M(t,C);if((d=A==null?void 0:A.element)!=null&&d.isConnected)return;const v=E!=="horizontal",w=E!=="vertical",k=Ze(x);if((o.key==="ArrowLeft"||o.key==="ArrowRight"||o.key==="Home"||o.key==="End")&&ie(o.currentTarget))return;const Z={ArrowUp:(k||v)&&(()=>{if(k){const V=nt(x);return V==null?void 0:V.id}return t==null?void 0:t.last()}),ArrowRight:(k||w)&&t.first,ArrowDown:(k||v)&&t.first,ArrowLeft:(k||w)&&t.last,Home:t.first,End:t.last,PageUp:t.first,PageDown:t.last}[o.key];if(Z){const V=Z();if(V!==void 0){if(!p(o))return;o.preventDefault(),t.move(V)}}});u=Ce(u,o=>Oe.jsx(ae,{value:t,children:o}),[t]);const j=t.useState(o=>{var d;if(t&&i&&o.virtualFocus)return(d=M(t,o.activeId))==null?void 0:d.id});u=he(ne({"aria-activedescendant":j},u),{ref:_e(P,f,u.ref),onKeyDownCapture:L,onKeyUpCapture:S,onFocusCapture:_,onFocus:F,onBlurCapture:G,onKeyDown:O});const J=t.useState(o=>i&&(o.virtualFocus||o.activeId===null));return u=Ue(ne({focusable:J},u)),u});Fe(function(s){const n=ot(s);return Ae(Ye,n)});export{$e as a,It as b,vt as c,ot as d,gt as e,St as u};
