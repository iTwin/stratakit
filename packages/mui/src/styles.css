/*---------------------------------------------------------------------------------------------
 * Copyright (c) Bentley Systems, Incorporated. All rights reserved.
 * See LICENSE.md in the project root for license terms and full copyright notice.
 *--------------------------------------------------------------------------------------------*/

@layer stratakit {
	[data-color-scheme],
	.ü•ùMuiRoot {
		--stratakit-mui-palette-background-default: var(--stratakit-color-bg-page-depth);
		--stratakit-mui-palette-background-paper: var(--stratakit-color-bg-page-depth);

		--stratakit-mui-palette-divider: var(--stratakit-color-border-page-base);

		--stratakit-mui-palette-text-primary: var(--stratakit-color-text-neutral-primary);
		--stratakit-mui-palette-text-secondary: var(--stratakit-color-text-neutral-secondary);
		--stratakit-mui-palette-text-disabled: var(--stratakit-color-text-neutral-disabled);

		--stratakit-mui-palette-primary-main: var(--stratakit-color-bg-accent-base);
		--stratakit-mui-palette-primary-dark: var(--stratakit-color-bg-accent-faded);
		--stratakit-mui-palette-primary-light: var(--stratakit-color-bg-accent-muted);
		--stratakit-mui-palette-primary-contrastText: var(--stratakit-color-text-neutral-emphasis);

		--stratakit-mui-palette-secondary-main: var(--stratakit-color-bg-mono-base);
		--stratakit-mui-palette-secondary-dark: var(--stratakit-color-bg-mono-faded);
		--stratakit-mui-palette-secondary-light: var(--stratakit-color-bg-mono-muted);
		--stratakit-mui-palette-secondary-contrastText: var(--stratakit-color-text-neutral-emphasis);

		--stratakit-mui-palette-action-active: var(--stratakit-color-icon-neutral-primary);
		--stratakit-mui-palette-action-disabled: var(--stratakit-color-icon-neutral-disabled);
		--stratakit-mui-palette-action-disabledBackground: var(
			--stratakit-color-bg-glow-on-surface-disabled
		);

		--stratakit-mui-palette-error-main: var(--stratakit-color-bg-critical-base);
		--stratakit-mui-palette-error-dark: var(--stratakit-color-bg-critical-faded);
		--stratakit-mui-palette-error-light: var(--stratakit-color-bg-critical-muted);
		--stratakit-mui-palette-error-contrastText: var(--stratakit-color-text-neutral-emphasis);

		--stratakit-mui-palette-warning-main: var(--stratakit-color-bg-attention-base);
		--stratakit-mui-palette-warning-dark: var(--stratakit-color-bg-attention-faded);
		--stratakit-mui-palette-warning-light: var(--stratakit-color-bg-attention-muted);
		--stratakit-mui-palette-warning-contrastText: var(--stratakit-color-text-neutral-emphasis);

		--stratakit-mui-palette-success-main: var(--stratakit-color-bg-positive-base);
		--stratakit-mui-palette-success-dark: var(--stratakit-color-bg-positive-faded);
		--stratakit-mui-palette-success-light: var(--stratakit-color-bg-positive-muted);
		--stratakit-mui-palette-success-contrastText: var(--stratakit-color-text-neutral-emphasis);

		--stratakit-mui-palette-info-main: var(--stratakit-color-bg-info-base);
		--stratakit-mui-palette-info-dark: var(--stratakit-color-bg-info-faded);
		--stratakit-mui-palette-info-light: var(--stratakit-color-bg-info-muted);
		--stratakit-mui-palette-info-contrastText: var(--stratakit-color-text-neutral-emphasis);

		--stratakit-mui-palette-grey-50: --primitive("color.gray.50");
		--stratakit-mui-palette-grey-100: --primitive("color.gray.100");
		--stratakit-mui-palette-grey-200: --primitive("color.gray.200");
		--stratakit-mui-palette-grey-300: --primitive("color.gray.300");
		--stratakit-mui-palette-grey-400: --primitive("color.gray.400");
		--stratakit-mui-palette-grey-500: --primitive("color.gray.500");
		--stratakit-mui-palette-grey-600: --primitive("color.gray.600");
		--stratakit-mui-palette-grey-700: --primitive("color.gray.700");
		--stratakit-mui-palette-grey-800: --primitive("color.gray.800");
		--stratakit-mui-palette-grey-900: --primitive("color.gray.900");
		--stratakit-mui-palette-grey-A100: --primitive("color.gray.100");
		--stratakit-mui-palette-grey-A200: --primitive("color.gray.200");
		--stratakit-mui-palette-grey-A400: --primitive("color.gray.400");
		--stratakit-mui-palette-grey-A700: --primitive("color.gray.700");
	}

	.MuiAlert-icon {
		align-items: center; /* Fix vertical alignment of differently sized icons */
	}

	.MuiButton-root {
		&:where(.MuiButton-colorSecondary) {
			--variant-containedBg: var(--stratakit-color-bg-neutral-base);
			--variant-containedColor: var(--stratakit-color-text-neutral-primary);
			--variant-outlinedColor: var(--stratakit-color-text-neutral-primary);
			--variant-textColor: var(--stratakit-color-text-neutral-primary);

			&:where(:hover) {
				--variant-containedBg: color-mix(
					in oklch,
					var(--stratakit-color-bg-neutral-base) 100%,
					var(--stratakit-color-glow-hue) var(--stratakit-color-bg-glow-base-hover-\%)
				);
			}
		}

		&:where(.MuiButton-colorPrimary) {
			--variant-outlinedColor: var(--stratakit-color-text-accent-strong);
			--variant-textColor: var(--stratakit-color-text-accent-strong);
		}
	}

	.MuiCheckbox-root {
		--xyz-checkbox-bg--default: var(--stratakit-color-bg-neutral-base);
		--xyz-checkbox-bg--hover: color-mix(
			in oklch,
			var(--xyz-checkbox-bg--default) 100%,
			var(--stratakit-color-glow-hue) var(--stratakit-color-bg-glow-base-hover-\%)
		);
		--xyz-checkbox-bg--checked: var(--stratakit-color-bg-accent-base);
		--xyz-checkbox-bg--checked-hover: color-mix(
			in oklch,
			var(--xyz-checkbox-bg--checked) 100%,
			var(--stratakit-color-glow-hue) var(--stratakit-color-bg-glow-strong-hover-\%)
		);
		--xyz-checkbox-bg--disabled: var(--stratakit-color-bg-glow-on-surface-disabled);
		--xyz-checkbox-color--default: var(--stratakit-color-icon-neutral-emphasis);
		--xyz-checkbox-color--error: var(--stratakit-color-icon-neutral-primary);
		--xyz-checkbox-color--disabled: var(--stratakit-color-icon-neutral-disabled);
		--xyz-checkbox-border-color--default: var(--stratakit-color-border-shadow-base);
		--xyz-checkbox-border-color--hover: color-mix(
			in oklch,
			var(--xyz-checkbox-border-color--default) 100%,
			var(--stratakit-color-glow-hue) var(--stratakit-color-border-glow-base-hover-\%)
		);
		--xyz-checkbox-border-color--checked: var(--stratakit-color-border-shadow-strong);
		--xyz-checkbox-border-color--checked-hover: color-mix(
			in oklch,
			var(--xyz-checkbox-border-color--checked) 100%,
			var(--stratakit-color-glow-hue) var(--stratakit-color-border-glow-strong-hover-\%)
		);
		--xyz-checkbox-border-color--invalid: var(--stratakit-color-border-critical-base);
		--xyz-checkbox-mask-image--unchecked: url('data:image/svg+xml;utf8,<svg viewBox="0 0 16 16"></svg>');
		--xyz-checkbox-mask-image--checked: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="currentColor" d="M11.73 5.47a.75.75 0 0 1 0 1.06l-4.4 4.4a.75.75 0 0 1-1.06 0l-2-2a.75.75 0 0 1 1.06-1.06L6.8 9.34l3.87-3.87a.75.75 0 0 1 1.06 0Z"/></svg>');
		--xyz-checkbox-mask-image--indeterminate: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="currentColor" d="M4.25 8A.75.75 0 0 1 5 7.25h6.5a.75.75 0 0 1 0 1.5H5A.75.75 0 0 1 4.25 8Z"/></svg>');
		--xyz-checkbox-box-shadow--default:
			var(--stratakit-shadow-control-button-base-inset), 0px 0px 0px 1px
			var(--xyz-checkbox-border-color) inset, var(--stratakit-shadow-control-button-base-drop);

		--xyz-checkbox-bg: var(--xyz-checkbox-bg--default);
		--xyz-checkbox-color: var(--xyz-checkbox-color--default);
		--xyz-checkbox-border-color: var(--xyz-checkbox-border-color--default);
		--xyz-checkbox-box-shadow: var(--xyz-checkbox-box-shadow--default);
		--xyz-checkbox-mask-image: var(--xyz-checkbox-mask-image--unchecked);

		@media (any-hover: hover) {
			&:where(:hover) {
				--xyz-checkbox-bg: var(--xyz-checkbox-bg--hover);
				--xyz-checkbox-border-color: var(--xyz-checkbox-border-color--hover);
			}
		}

		&:where(.Mui-checked, .MuiCheckbox-indeterminate):where(:not(.MuiCheckbox-colorError)) {
			--xyz-checkbox-bg: var(--xyz-checkbox-bg--checked);
			--xyz-checkbox-border-color: var(--xyz-checkbox-border-color--checked);

			@media (any-hover: hover) {
				&:where(:hover) {
					--xyz-checkbox-bg: var(--xyz-checkbox-bg--checked-hover);
					--xyz-checkbox-border-color: var(--xyz-checkbox-border-color--checked-hover);
				}
			}
		}

		&:where(.Mui-checked) {
			--xyz-checkbox-mask-image: var(--xyz-checkbox-mask-image--checked);
		}

		&:where(.MuiCheckbox-indeterminate) {
			--xyz-checkbox-mask-image: var(--xyz-checkbox-mask-image--indeterminate);
		}

		&:where(.MuiCheckbox-colorError) {
			--xyz-checkbox-color: var(--xyz-checkbox-color--error);
			--xyz-checkbox-border-color: var(--xyz-checkbox-border-color--invalid);
		}

		&:where(.Mui-disabled) {
			--xyz-checkbox-bg: var(--xyz-checkbox-bg--disabled);
			--xyz-checkbox-color: var(--xyz-checkbox-color--disabled);
			--xyz-checkbox-box-shadow: none;
		}

		&:where(.Mui-focusVisible) {
			outline: 2px solid var(--stratakit-color-border-accent-strong);
		}

		@media (forced-colors: active) {
			--xyz-checkbox-border: 1px solid CanvasText;

			&:where(.Mui-checked, .MuiCheckbox-indeterminate):where(:not(.MuiCheckbox-colorError)) {
				&,
				&:hover {
					--xyz-checkbox-bg: SelectedItem;
					--xyz-checkbox-color: SelectedItemText;
				}
			}

			&:where(.MuiCheckbox-colorError) {
				--xyz-checkbox-bg: Mark;
				--xyz-checkbox-color: MarkText;
			}

			&:where(.Mui-disabled) {
				--xyz-checkbox-bg: Canvas;
				--xyz-checkbox-color: GrayText;
				--xyz-checkbox-border: 1px solid GrayText;
			}
		}
	}

	.MuiCheckbox-symbol {
		inline-size: 1rem;
		block-size: 1rem;

		background-color: var(--xyz-checkbox-bg);
		border-radius: 4px;
		color: var(--xyz-checkbox-color);
		transition: all 150ms ease-out;
		transition-property: background-color, border-color, box-shadow, --ü•ùCheckbox-border-color;
		position: relative;
		box-shadow: var(--xyz-checkbox-box-shadow);
		border: var(--xyz-checkbox-border);

		&::after {
			content: "";
			position: absolute;
			inset: 0px;
			background-color: currentColor;
			mask-image: var(--xyz-checkbox-mask-image, initial);
			mask-repeat: no-repeat;
			mask-position: center;

			@media (forced-colors: active) {
				background-color: var(--xyz-checkbox-color);
			}
		}
	}

	.MuiFormLabel-colorPrimary {
		&.Mui-focused {
			color: var(--stratakit-mui-palette-primary-dark);
		}
	}

	.MuiLink-root {
		font-weight: 500;
		text-decoration-color: currentColor;
		text-underline-offset: var(--stratakit-space-x05);
		transition: text-underline-offset 150ms ease-out;

		&:where(:hover, :focus-visible) {
			text-underline-offset: var(--stratakit-space-x1);
		}
	}

	.MuiMenuItem-root {
		&:where(.Mui-focusVisible) {
			outline-offset: -2px;
		}
	}

	.MuiPaper-root {
		--Paper-overlay: unset !important; /* Remove background-image overlay that MUI adds in dark mode */

		&:where(.MuiPaper-elevation1) {
			--stratakit-mui-palette-background-paper: var(--stratakit-color-bg-page-base);
		}

		&:where(
				.MuiPaper-elevation2,
				.MuiPaper-elevation3,
				.MuiPaper-elevation4,
				.MuiPaper-elevation5,
				.MuiPaper-elevation6,
				.MuiPaper-elevation7
			) {
			--stratakit-mui-palette-background-paper: var(--stratakit-color-bg-elevation-base);
		}

		&:where(
				.MuiPaper-elevation8,
				.MuiPaper-elevation9,
				.MuiPaper-elevation10,
				.MuiPaper-elevation11,
				.MuiPaper-elevation12,
				.MuiPaper-elevation13,
				.MuiPaper-elevation14,
				.MuiPaper-elevation15,
				.MuiPaper-elevation16,
				.MuiPaper-elevation17,
				.MuiPaper-elevation18,
				.MuiPaper-elevation19,
				.MuiPaper-elevation20,
				.MuiPaper-elevation21,
				.MuiPaper-elevation22,
				.MuiPaper-elevation23,
				.MuiPaper-elevation24
			) {
			--stratakit-mui-palette-background-paper: var(--stratakit-color-bg-elevation-level-1);
		}
	}

	.MuiTab-root {
		&:where(.Mui-selected) {
			color: var(--stratakit-color-text-accent-strong);
		}
		&:where(:focus-visible) {
			outline-offset: -4px;
		}
	}
	.MuiTabs-indicator {
		background-color: var(--stratakit-color-border-accent-strong);
	}

	.MuiTooltip-tooltip {
		--stratakit-mui-palette-Tooltip-bg: var(--stratakit-color-bg-elevation-emphasis);
		box-shadow: var(--stratakit-shadow-control-tooltip-base);
	}

	.MuiSwitch-root {
		.MuiSwitch-switchBase:where(.MuiSwitch-colorPrimary) {
			&:where(.Mui-checked):where(:not(.Mui-disabled)) {
				color: var(--stratakit-mui-palette-primary-dark);
			}
		}

		&:where(:has(.MuiSwitch-switchBase.Mui-focusVisible)) {
			outline: 2px solid var(--stratakit-color-border-accent-strong);
		}
	}
}
