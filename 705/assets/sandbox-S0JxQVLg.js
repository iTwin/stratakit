var ke=t=>{throw TypeError(t)};var pe=(t,e,s)=>e.has(t)||ke("Cannot "+s);var o=(t,e,s)=>(pe(t,e,"read from private field"),s?s.call(t):e.get(t)),P=(t,e,s)=>e.has(t)?ke("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,s),R=(t,e,s,n)=>(pe(t,e,"write to private field"),n?n.call(t,s):e.set(t,s),s),k=(t,e,s)=>(pe(t,e,"access private method"),s);import{w as Ke}from"./LMDWO4NN-DKmoeJmN.js";import{a as i,t as qe,o as r}from"./chunk-D4RADZKF-D_1J9aTA.js";import{I as A,V as ee,B as Ge,a as Xe,A as we}from"./~utils-DMhwTx4N.js";import{D as Je,a as Ye,b as Ze,c as et}from"./DropdownMenu-BRuDEzd8.js";import{E as tt,a as st}from"./ErrorRegion-ChURVBrd.js";import{F as rt,a as nt,b as it}from"./Field-Th9dbHUH.js";import{S as ot,H as at}from"./Select-Oxum_IjJ.js";import{S as le}from"./Skeleton-DlZKxs99.js";import{T as lt,a as ct,b as ut,c as dt}from"./Tabs-NVmDfkWy.js";import{T as ue}from"./Text-j8POlt0X.js";import{T as ht,a as ft,b as pt}from"./TextBox-C9yrW8d_.js";import{T as mt,a as oe}from"./Toolbar-Dgg7kR_k.js";import{T as bt,a as vt,b as E,p as xt}from"./immer-BkoNkdow.js";import{I as te,c as gt}from"./sun-5p6b5Bp8.js";import{S as jt,l as Te,q as H,t as me,r as ae,b as be,u as ve,v as Me,w as St,g as yt,x as Ct,y as Fe,n as Ue,z as It,A as Rt}from"./QueryClientProvider-C8ejpha2.js";import{a as Pe}from"./index-WXbDz9md.js";import{c as _t,a as kt,d as wt,m as Tt,p as Mt,r as Ft,l as Pt,s as Ee,h as Et,b as zt,f as Ot}from"./visibility-hide-Bq7zI5eA.js";import{p as se}from"./placeholder-CZQ_TClO.js";import{s as Nt}from"./visibility-show-N0421kR9.js";import"./XX67R432-BQJmZ3p4.js";import"./6VRAQV3D-CoFoHxGI.js";import"./RZ4GPYOB-B7ePVA2J.js";import"./5JTVDSTH-C7AbLO9w.js";import"./S43UC3DV-D27Y8W35.js";import"./NTITENHD-Cvf1MThn.js";import"./F5MUBM3I-BjCrruMK.js";import"./IAEAQUOT-DhjNGSqa.js";import"./Kbd-Ch1E01z3.js";import"./~utils.icons-CZtpZXiZ.js";import"./collection-AuwIIIKb.js";import"./Label-Doe55Ijv.js";import"./IWEFDH56-DBFC1Q7c.js";var O,x,ne,z,K,X,$,V,ie,J,Y,q,G,W,Z,j,re,xe,ge,je,Se,ye,Ce,Ie,He,Be,Dt=(Be=class extends jt{constructor(e,s){super();P(this,j);P(this,O);P(this,x);P(this,ne);P(this,z);P(this,K);P(this,X);P(this,$);P(this,V);P(this,ie);P(this,J);P(this,Y);P(this,q);P(this,G);P(this,W);P(this,Z,new Set);this.options=s,R(this,O,e),R(this,V,null),R(this,$,Te()),this.options.experimental_prefetchInRender||o(this,$).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(s)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(o(this,x).addObserver(this),ze(o(this,x),this.options)?k(this,j,re).call(this):this.updateResult(),k(this,j,Se).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Re(o(this,x),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Re(o(this,x),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,k(this,j,ye).call(this),k(this,j,Ce).call(this),o(this,x).removeObserver(this)}setOptions(e){const s=this.options,n=o(this,x);if(this.options=o(this,O).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof H(this.options.enabled,o(this,x))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");k(this,j,Ie).call(this),o(this,x).setOptions(this.options),s._defaulted&&!me(this.options,s)&&o(this,O).getQueryCache().notify({type:"observerOptionsUpdated",query:o(this,x),observer:this});const d=this.hasListeners();d&&Oe(o(this,x),n,this.options,s)&&k(this,j,re).call(this),this.updateResult(),d&&(o(this,x)!==n||H(this.options.enabled,o(this,x))!==H(s.enabled,o(this,x))||ae(this.options.staleTime,o(this,x))!==ae(s.staleTime,o(this,x)))&&k(this,j,xe).call(this);const a=k(this,j,ge).call(this);d&&(o(this,x)!==n||H(this.options.enabled,o(this,x))!==H(s.enabled,o(this,x))||a!==o(this,W))&&k(this,j,je).call(this,a)}getOptimisticResult(e){const s=o(this,O).getQueryCache().build(o(this,O),e),n=this.createResult(s,e);return Bt(this,n)&&(R(this,z,n),R(this,X,this.options),R(this,K,o(this,x).state)),n}getCurrentResult(){return o(this,z)}trackResult(e,s){return new Proxy(e,{get:(n,d)=>(this.trackProp(d),s==null||s(d),Reflect.get(n,d))})}trackProp(e){o(this,Z).add(e)}getCurrentQuery(){return o(this,x)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const s=o(this,O).defaultQueryOptions(e),n=o(this,O).getQueryCache().build(o(this,O),s);return n.fetch().then(()=>this.createResult(n,s))}fetch(e){return k(this,j,re).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),o(this,z)))}createResult(e,s){var U;const n=o(this,x),d=this.options,a=o(this,z),l=o(this,K),u=o(this,X),c=e!==n?e.state:o(this,ne),{state:m}=e;let f={...m},g=!1,v;if(s._optimisticResults){const _=this.hasListeners(),y=!_&&ze(e,s),C=_&&Oe(e,n,s,d);(y||C)&&(f={...f,...Ct(m.data,e.options)}),s._optimisticResults==="isRestoring"&&(f.fetchStatus="idle")}let{error:w,errorUpdatedAt:T,status:p}=f;v=f.data;let M=!1;if(s.placeholderData!==void 0&&v===void 0&&p==="pending"){let _;a!=null&&a.isPlaceholderData&&s.placeholderData===(u==null?void 0:u.placeholderData)?(_=a.data,M=!0):_=typeof s.placeholderData=="function"?s.placeholderData((U=o(this,Y))==null?void 0:U.state.data,o(this,Y)):s.placeholderData,_!==void 0&&(p="success",v=Fe(a==null?void 0:a.data,_,s),g=!0)}if(s.select&&v!==void 0&&!M)if(a&&v===(l==null?void 0:l.data)&&s.select===o(this,ie))v=o(this,J);else try{R(this,ie,s.select),v=s.select(v),v=Fe(a==null?void 0:a.data,v,s),R(this,J,v),R(this,V,null)}catch(_){R(this,V,_)}o(this,V)&&(w=o(this,V),v=o(this,J),T=Date.now(),p="error");const F=f.fetchStatus==="fetching",B=p==="pending",N=p==="error",Q=B&&F,D=v!==void 0,I={status:p,fetchStatus:f.fetchStatus,isPending:B,isSuccess:p==="success",isError:N,isInitialLoading:Q,isLoading:Q,data:v,dataUpdatedAt:f.dataUpdatedAt,error:w,errorUpdatedAt:T,failureCount:f.fetchFailureCount,failureReason:f.fetchFailureReason,errorUpdateCount:f.errorUpdateCount,isFetched:f.dataUpdateCount>0||f.errorUpdateCount>0,isFetchedAfterMount:f.dataUpdateCount>c.dataUpdateCount||f.errorUpdateCount>c.errorUpdateCount,isFetching:F,isRefetching:F&&!B,isLoadingError:N&&!D,isPaused:f.fetchStatus==="paused",isPlaceholderData:g,isRefetchError:N&&D,isStale:_e(e,s),refetch:this.refetch,promise:o(this,$)};if(this.options.experimental_prefetchInRender){const _=L=>{I.status==="error"?L.reject(I.error):I.data!==void 0&&L.resolve(I.data)},y=()=>{const L=R(this,$,I.promise=Te());_(L)},C=o(this,$);switch(C.status){case"pending":e.queryHash===n.queryHash&&_(C);break;case"fulfilled":(I.status==="error"||I.data!==C.value)&&y();break;case"rejected":(I.status!=="error"||I.error!==C.reason)&&y();break}}return I}updateResult(){const e=o(this,z),s=this.createResult(o(this,x),this.options);if(R(this,K,o(this,x).state),R(this,X,this.options),o(this,K).data!==void 0&&R(this,Y,o(this,x)),me(s,e))return;R(this,z,s);const n=()=>{if(!e)return!0;const{notifyOnChangeProps:d}=this.options,a=typeof d=="function"?d():d;if(a==="all"||!a&&!o(this,Z).size)return!0;const l=new Set(a??o(this,Z));return this.options.throwOnError&&l.add("error"),Object.keys(o(this,z)).some(u=>{const h=u;return o(this,z)[h]!==e[h]&&l.has(h)})};k(this,j,He).call(this,{listeners:n()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&k(this,j,Se).call(this)}},O=new WeakMap,x=new WeakMap,ne=new WeakMap,z=new WeakMap,K=new WeakMap,X=new WeakMap,$=new WeakMap,V=new WeakMap,ie=new WeakMap,J=new WeakMap,Y=new WeakMap,q=new WeakMap,G=new WeakMap,W=new WeakMap,Z=new WeakMap,j=new WeakSet,re=function(e){k(this,j,Ie).call(this);let s=o(this,x).fetch(this.options,e);return e!=null&&e.throwOnError||(s=s.catch(be)),s},xe=function(){k(this,j,ye).call(this);const e=ae(this.options.staleTime,o(this,x));if(ve||o(this,z).isStale||!Me(e))return;const n=St(o(this,z).dataUpdatedAt,e)+1;R(this,q,setTimeout(()=>{o(this,z).isStale||this.updateResult()},n))},ge=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(o(this,x)):this.options.refetchInterval)??!1},je=function(e){k(this,j,Ce).call(this),R(this,W,e),!(ve||H(this.options.enabled,o(this,x))===!1||!Me(o(this,W))||o(this,W)===0)&&R(this,G,setInterval(()=>{(this.options.refetchIntervalInBackground||yt.isFocused())&&k(this,j,re).call(this)},o(this,W)))},Se=function(){k(this,j,xe).call(this),k(this,j,je).call(this,k(this,j,ge).call(this))},ye=function(){o(this,q)&&(clearTimeout(o(this,q)),R(this,q,void 0))},Ce=function(){o(this,G)&&(clearInterval(o(this,G)),R(this,G,void 0))},Ie=function(){const e=o(this,O).getQueryCache().build(o(this,O),this.options);if(e===o(this,x))return;const s=o(this,x);R(this,x,e),R(this,ne,e.state),this.hasListeners()&&(s==null||s.removeObserver(this),e.addObserver(this))},He=function(e){Ue.batch(()=>{e.listeners&&this.listeners.forEach(s=>{s(o(this,z))}),o(this,O).getQueryCache().notify({query:o(this,x),type:"observerResultsUpdated"})})},Be);function Lt(t,e){return H(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function ze(t,e){return Lt(t,e)||t.state.data!==void 0&&Re(t,e,e.refetchOnMount)}function Re(t,e,s){if(H(e.enabled,t)!==!1){const n=typeof s=="function"?s(t):s;return n==="always"||n!==!1&&_e(t,e)}return!1}function Oe(t,e,s,n){return(t!==e||H(n.enabled,t)===!1)&&(!s.suspense||t.state.status!=="error")&&_e(t,s)}function _e(t,e){return H(e.enabled,t)!==!1&&t.isStaleByTime(ae(e.staleTime,t))}function Bt(t,e){return!me(t.getCurrentResult(),e)}var Qe=i.createContext(!1),Ut=()=>i.useContext(Qe);Qe.Provider;function Ht(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var Qt=i.createContext(Ht()),At=()=>i.useContext(Qt),$t=(t,e)=>{(t.suspense||t.throwOnError||t.experimental_prefetchInRender)&&(e.isReset()||(t.retryOnMount=!1))},Vt=t=>{i.useEffect(()=>{t.clearReset()},[t])},Wt=({result:t,errorResetBoundary:e,throwOnError:s,query:n,suspense:d})=>t.isError&&!e.isReset()&&!t.isFetching&&n&&(d&&t.data===void 0||It(s,[t.error,n])),Kt=t=>{const e=t.staleTime;t.suspense&&(t.staleTime=typeof e=="function"?(...s)=>Math.max(e(...s),1e3):Math.max(e??1e3,1e3),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3)))},qt=(t,e)=>t.isLoading&&t.isFetching&&!e,Gt=(t,e)=>(t==null?void 0:t.suspense)&&e.isPending,Ne=(t,e,s)=>e.fetchOptimistic(t).catch(()=>{s.clearReset()});function Xt(t,e,s){var f,g,v,w,T;const n=Rt(),d=Ut(),a=At(),l=n.defaultQueryOptions(t);(g=(f=n.getDefaultOptions().queries)==null?void 0:f._experimental_beforeQuery)==null||g.call(f,l),l._optimisticResults=d?"isRestoring":"optimistic",Kt(l),$t(l,a),Vt(a);const u=!n.getQueryCache().get(l.queryHash),[h]=i.useState(()=>new e(n,l)),c=h.getOptimisticResult(l),m=!d&&t.subscribed!==!1;if(i.useSyncExternalStore(i.useCallback(p=>{const M=m?h.subscribe(Ue.batchCalls(p)):be;return h.updateResult(),M},[h,m]),()=>h.getCurrentResult(),()=>h.getCurrentResult()),i.useEffect(()=>{h.setOptions(l)},[l,h]),Gt(l,c))throw Ne(l,h,a);if(Wt({result:c,errorResetBoundary:a,throwOnError:l.throwOnError,query:n.getQueryCache().get(l.queryHash),suspense:l.suspense}))throw c.error;if((w=(v=n.getDefaultOptions().queries)==null?void 0:v._experimental_afterQuery)==null||w.call(v,l,c),l.experimental_prefetchInRender&&!ve&&qt(c,d)){const p=u?Ne(l,h,a):(T=n.getQueryCache().get(l.queryHash))==null?void 0:T.promise;p==null||p.catch(be).finally(()=>{h.updateResult()})}return l.notifyOnChangeProps?c:h.trackResult(c)}function Jt(t,e){return Xt(t,Dt)}const Yt="/705/assets/sandbox.model1-B8uu5h-t.json",Zt="/705/assets/sandbox.model2-Bi69Ub92.json",es="data:application/json;base64,ewoJIm5hbWUiOiAiRXBvY2ggU3lzdGVtIGlNb2RlbCAzIiwKCSJ2ZXJzaW9uIjogIjIwMjQgUmVmcmVzaCIsCgkiZGF0YSI6IHsKCQkiZGVmYXVsdCI6IFtdCgl9Cn0K",ts="_appLayout_kip5f_5",ss="_header_kip5f_22",rs="_platformBar_kip5f_32",ns="_logo_kip5f_38",is="_tools_kip5f_48",os="_leftPanel_kip5f_58",as="_panelHeader_kip5f_70",ls="_panelTitleWrapper_kip5f_78",cs="_panelCaption_kip5f_82",us="_shiftIconRight_kip5f_86",ds="_subheader_kip5f_90",hs="_searchInput_kip5f_108",fs="_subheaderActions_kip5f_116",ps="_subheaderContent_kip5f_131",ms="_tabList_kip5f_146",bs="_emptyState_kip5f_156",vs="_skeletonTree_kip5f_165",xs="_skeletonTreeItem_kip5f_172",gs="_canvasWrapper_kip5f_181",js="_canvas_kip5f_181",Ss="_splitter_kip5f_219",ys="_tabPanel_kip5f_265",Cs="_tree_kip5f_274",Is="_slider_kip5f_279",Rs="_colorSwatch_kip5f_288",S={appLayout:ts,header:ss,platformBar:rs,logo:ns,tools:is,leftPanel:os,panelHeader:as,panelTitleWrapper:ls,panelCaption:cs,shiftIconRight:us,subheader:ds,searchInput:hs,subheaderActions:fs,subheaderContent:ps,tabList:ms,emptyState:bs,skeletonTree:vs,skeletonTreeItem:xs,canvasWrapper:gs,canvas:js,splitter:Ss,tabPanel:ys,tree:Cs,slider:Is,colorSwatch:Rs},ce={model1:{name:"Epoch System iModel 1",url:Yt},model2:{name:"Epoch System iModel 2",url:Zt},model3:{name:"Epoch System iModel 3",url:es}};async function _s(t){if(t in ce){const e=await fetch(ce[t].url).then(s=>s.json());return e.slow&&await new Promise(s=>setTimeout(s,Math.random()*2e3)),e}return{name:"Unknown",version:"Unknown",data:{default:[]}}}const Ae="StrataKit sandbox",Cr=()=>[{title:Ae}],Ir=Ke(function(){var a;const[e,s]=qe(),n=e.get("model")||"model1",d=Jt({queryKey:["sandbox-data",n],queryFn:()=>_s(n)});return r.jsxs(ks,{panelContent:r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:S.panelHeader,children:[r.jsxs("div",{children:[r.jsxs(rt,{children:[r.jsx(ee,{render:r.jsx(nt,{}),children:"Choose Model"}),r.jsx(it,{render:l=>r.jsx(ot,{className:S.panelTitleWrapper,children:r.jsx(at,{...l,variant:"ghost",defaultValue:n,onChange:u=>s({model:u.currentTarget.value}),children:Object.entries(ce).map(([u,{name:h}])=>r.jsx("option",{value:u,children:h},u))})})})]}),r.jsxs("hgroup",{role:"group",children:[r.jsx(ee,{render:r.jsx("h2",{}),children:(a=ce[n])==null?void 0:a.name}),r.jsx(i.Suspense,{fallback:r.jsx(le,{variant:"text"}),children:r.jsx(Ms,{query:d})},n)]})]}),r.jsx("div",{children:r.jsx(A,{className:S.shiftIconRight,icon:Mt,label:"Dock panel",variant:"ghost",disabled:!0})})]}),r.jsx(i.Suspense,{fallback:r.jsx(ws,{}),children:r.jsx(Fs,{query:d})},n)]}),children:[r.jsxs("header",{className:S.header,children:[r.jsx("div",{className:S.logo,children:r.jsx(te,{href:se,size:"large"})}),r.jsx(ue,{render:l=>r.jsx("h1",{...l}),variant:"body-md",children:Ae})]}),r.jsx("div",{className:S.platformBar,children:r.jsxs("div",{className:S.tools,children:[r.jsx(te,{href:se,size:"large"}),r.jsx(te,{href:se,size:"large"}),r.jsx(te,{href:se,size:"large"})]})}),r.jsx("div",{className:S.canvasWrapper,children:r.jsx("div",{className:S.canvas,children:r.jsxs(mt,{variant:"solid",children:[r.jsx(oe,{render:r.jsx(A,{label:"Select",icon:_t,variant:"ghost"})}),r.jsx(oe,{render:r.jsx(A,{label:"Move",icon:kt,variant:"ghost"})}),r.jsx(oe,{render:r.jsx(A,{label:"Draw",icon:wt,variant:"ghost"})}),r.jsx(oe,{render:r.jsx(A,{label:"Measure",icon:Tt,variant:"ghost"})})]})})})]})});function ks(t){const{sliderProps:e,panelProps:s,panelMinSize:n,panelMaxSize:d,resizing:a}=Os({minSize:{px:256,pct:20},maxSize:{pct:30}}),l=i.useId();return r.jsxs("div",{className:S.appLayout,style:{"--_panel-min-size":n,"--_panel-max-size":d},children:[r.jsx("div",{...s,className:S.leftPanel,style:{position:"relative",...s.style},children:t.panelContent}),r.jsxs("div",{className:S.splitter,"data-resizing":a?"true":void 0,children:[r.jsx(ee,{render:u=>r.jsx("label",{...u,htmlFor:l,children:"Resize layers panel"}),children:"Resize layers panel"}),r.jsx("input",{id:l,type:"range",className:S.slider,...e})]}),t.children]})}function ws(){const t=[1,1,2,2,3,2,3,2,1,1,2,3,4,5,2,3,4,5];return r.jsxs(r.Fragment,{children:[r.jsx("div",{className:S.subheader,children:r.jsx(le,{variant:"text"})}),r.jsxs("div",{className:S.skeletonTree,children:[t.map((e,s)=>r.jsx(Ts,{style:{"--level":e}},`${s}-${e}`)),r.jsx(ee,{children:"Loadingâ€¦"})]})]})}function Ts(t){return r.jsxs("div",{...t,className:gt(S.skeletonTreeItem,t.className),children:[r.jsx(le,{variant:"object",size:"small"}),r.jsx(le,{variant:"text"})]})}function Ms(t){const{version:e=""}=i.use(t.query.promise);return r.jsx(ue,{className:S.panelCaption,variant:"body-sm",render:r.jsx("p",{}),children:e})}function Fs(t){var l;const{data:e}=i.use(t.query.promise),s=i.useMemo(()=>Object.entries(e).map(([u,h])=>{const c=h.length<=1?[]:h.map(({label:m})=>m);return{name:u,filters:c,content:h.length>0?r.jsx(Us,{data:h}):r.jsxs(Ps,{children:[r.jsx(ue,{variant:"body-sm",children:"No layers"}),r.jsx(Ge,{children:"Create a layer"})]})}}),[e]),[n,d]=i.useState((l=s[0])==null?void 0:l.name),a=i.useMemo(()=>{var u;return n?((u=s.find(h=>h.name===n))==null?void 0:u.filters)||[]:s[0].filters},[s,n]);return s.length===1?r.jsxs(Le,{allFilters:a,children:[r.jsx(De,{}),s[0].content]}):r.jsx(Le,{allFilters:a,children:r.jsxs(lt,{selectOnMove:!1,setSelectedId:d,children:[r.jsx(De,{tabs:s.map(u=>r.jsx(ct,{id:u.name,children:Xe(u.name)},u.name))}),s.map(u=>r.jsx(ut,{tabId:u.name,className:S.tabPanel,focusable:!1,unmountOnHide:!0,children:u.content},u.name))]})})}function Ps({children:t}){return r.jsx("div",{className:S.emptyState,children:t})}function Es(){return r.jsx("div",{style:{textAlign:"center"},children:r.jsx(ue,{variant:"body-sm",children:"No results found"})})}function zs(t,e,s){return Math.min(Math.max(t,e),s)}function Os(t){const{minSize:e,maxSize:s,onCollapse:n}=t??{},d=i.useId(),a=i.useRef(null),[l,u]=i.useState(void 0),[h,c]=i.useState(void 0),[m,f]=i.useState(void 0),[g,v]=i.useState(!1),[w,T]=i.useState(void 0),p=i.useMemo(()=>{if(e&&h)return Math.min(e.px,e.pct/100*h)},[e,h]),M=i.useMemo(()=>{if(p&&s&&h)return Math.max(p,s.pct/100*h)},[s,h,p]),F=i.useMemo(()=>{if(m==="smallest")return p??0;if(m==="largest")return M??0;if(l&&p&&M)return zs(l,p,M)},[l,p,M,m]);i.useEffect(()=>{const y=a.current;if(!y)return;const C=y.parentElement;if(!C)return;const L=new ResizeObserver(()=>{const he=C.getBoundingClientRect(),fe=y.getBoundingClientRect();c(he.width),u(fe.width)});return L.observe(C),L.observe(y),()=>{L.disconnect()}},[]);const B=i.useCallback(y=>{const C=a.current;if(!C)return;const L=C.getBoundingClientRect();T(L.width+y),f(void 0),v(!0)},[]),N=i.useCallback(y=>{const C=a.current;if(!C)return;const L=C.parentElement;if(!L)return;const he=L.getBoundingClientRect(),fe=y*(he.width*.005),We=C.getBoundingClientRect();T(We.width+fe),f(void 0)},[]),Q=i.useCallback(()=>{a.current&&(T(void 0),v(!1))},[]),{moveableProps:D}=Ns({onMove:B,onMoveEnd:Q,onKeyMove:N}),b=i.useMemo(()=>({...D,onKeyDown:y=>{var C;if((C=D.onKeyDown)==null||C.call(D,y),!y.defaultPrevented)switch(y.key){case"Enter":y.preventDefault(),n==null||n();break;case"Home":y.preventDefault(),f("smallest");break;case"End":y.preventDefault(),f("largest");break}},onChange:y=>{if(g)return;const C=Number(y.target.value);T(C)},value:F===void 0?0:Math.floor(F),min:p===void 0?void 0:Math.floor(p),max:M===void 0?void 0:Math.floor(M)}),[D,F,p,M,n,g]),I=i.useMemo(()=>({style:{WebkitUserSelect:w===void 0?void 0:"none"},id:d,ref:a}),[d,w]),U=p===void 0?void 0:`${Math.floor(p)}px`,_=i.useMemo(()=>{if(w!==void 0&&s!==void 0&&m===void 0)return`min(${Math.floor(w)}px, ${s.pct}%)`;if(F!==void 0)return`${Math.floor(F)}px`},[s,w,F,m]);return{sliderProps:b,panelProps:I,panelMinSize:U,panelMaxSize:_,resizing:g}}function Ns(t){const{onMove:e,onMoveEnd:s,onKeyMove:n}=t??{},d=i.useRef(null),a=i.useRef(void 0),l=i.useRef(void 0),u=i.useCallback(()=>{l.current!==void 0&&(l.current=void 0,s==null||s())},[s]);return{moveableProps:i.useMemo(()=>({onPointerDown:c=>{if(c.button!==0||c.ctrlKey)return;const m=d.current;if(!m)return;const f=m.getBoundingClientRect(),g=c.clientX-f.left;l.current=g,c.preventDefault(),m.setPointerCapture(c.pointerId)},onPointerMove:c=>{const m=l.current;if(m===void 0)return;const f=d.current;if(!f)return;const g=f.getBoundingClientRect(),v=c.clientX-m-g.left;c.preventDefault(),e==null||e(v)},onPointerUp:u,onPointerCancel:u,onKeyDown:c=>{if(!c.defaultPrevented)switch(c.key){case"ArrowLeft":c.preventDefault(),n==null||n(-1);break;case"ArrowRight":c.preventDefault(),n==null||n(1);break}},ref:c=>{var f;if(d.current=c,(f=a.current)==null||f.call(a),a.current=void 0,!c)return;const m=g=>{g.preventDefault()};c.addEventListener("touchstart",m),a.current=()=>{c.removeEventListener("touchstart",m)}}}),[n,e,u])}}const $e=(()=>{let t=0;return e=>({id:`${t++}`,label:`Tree Item ${t}`,expanded:!0,...e,items:((e==null?void 0:e.items)??[]).map($e)})})();function Ds({items:t,filters:e,search:s,errorIds:n}){const d=i.useMemo(()=>e.length===0?t:t.reduce((u,h)=>(e.includes(h.label)&&u.push(h),u),[]),[t,e]),a=i.useMemo(()=>{function u(h){return h.reduce((c,m)=>{const g=n.includes(m.id)?[]:u(m.items??[]);return(m.label.toLowerCase().includes(s.toLowerCase())||g.length>0)&&c.push({...m,items:g}),c},[])}return s===""&&n.length===0?d:u(d)},[d,s,n]),l=i.useMemo(()=>{if(e.length===0&&s==="")return;function u(h){return h.reduce((c,m)=>{const f=m.items?u(m.items):0;return c+1+f},0)}return u(a)},[a,e,s]);return{filteredTree:a,itemCount:l}}function Ls(t,e){return i.useMemo(()=>{function s(n){return n.reduce((d,a)=>(e.includes(a.id)&&d.push(a),a.items&&d.push(...s(a.items)),d),[])}return s(t)},[t,e])}function Bs(t,e,s){return i.useMemo(()=>{function n(d,a,l,u,h){const c=[];let m=1;for(const f of d){const g=f.id===e||u,v=s.includes(f.id)||h;c.push({...f,level:l,parentItem:a,selected:g,hidden:v,parentHidden:h,position:m++,size:d.length}),f.expanded&&c.push(...n(f.items,f,l+1,g,v))}return c}return n(t,void 0,1,!1,!1)},[t,e,s])}function Ve(t,e){for(const s of t){if(s.id===e)return s;const n=Ve(s.items,e);if(n)return n}}function Us({data:t}){const{appliedFilters:e,search:s,setItemCount:n}=i.useContext(de),d=i.useId(),[a,l]=i.useState(),[u,h]=i.useState([]),c=i.useCallback(b=>{h(I=>I.includes(b)?I.filter(U=>U!==b):[...I,b])},[]),[m,f]=i.useState(()=>t.map(b=>$e(b))),[g,v]=i.useState(["benstr","benroad"]),w=Ls(m,g),T=i.useMemo(()=>w.filter(b=>b.expanded),[w]),p=i.useMemo(()=>T.map(b=>b.id),[T]),{filteredTree:M,itemCount:F}=Ds({items:m,filters:e,search:s,errorIds:p}),B=Bs(M,a,u);i.useEffect(()=>{n(F)},[n,F]);const N=T.length,Q=i.useMemo(()=>{if(N!==0)return N===1?"1 issue found":`${N} issues found`},[N]),D=i.useDeferredValue(B);return D.length===0?r.jsx(Es,{}):r.jsxs(i.Suspense,{fallback:"Loading...",children:[r.jsx(tt,{"aria-label":"Tree errors",label:Q,items:T.map(b=>{const I=`${d}-${b.id}`;return r.jsx(st,{message:r.jsxs(r.Fragment,{children:[r.jsx("span",{children:"Failed to create hierarchy for "}),r.jsx(we,{href:`#${I}`,children:b.label})]}),messageId:`${I}-message`,actions:r.jsx(we,{render:r.jsx("button",{}),onClick:()=>{v(U=>U.filter(_=>_!==b.id))},children:"Retry"},"retry")},b.id)})}),r.jsx(bt,{className:S.tree,children:D.map(b=>{const I=T.find(_=>_.id===b.id),U=I?`${d}-${b.id}`:void 0;return r.jsx(vt,{id:U,label:b.label,description:b.description,"aria-level":b.level,"aria-posinset":b.position,"aria-setsize":b.size,selected:b.selected,onSelectedChange:()=>{if(a===b.id){l(void 0);return}l(b.id)},expanded:b.items.length===0&&!I?void 0:b.expanded,onExpandedChange:_=>{f(xt(y=>{const C=Ve(y,b.id);C&&(C.expanded=_)}))},unstable_decorations:r.jsxs(r.Fragment,{children:[b.color?r.jsx(As,{color:b.color,alt:b.color}):null,r.jsx(te,{href:se})]}),actions:[I?r.jsx(E,{icon:Ft,label:"Retry",onClick:()=>{v(_=>_.filter(y=>y!==b.id))}},"retry"):null,r.jsx(E,{icon:Pt,label:"Lock"},"lock"),r.jsx(Hs,{item:b,onClick:c},"visibility"),r.jsx(E,{label:"Copy"},"copy"),r.jsx(E,{label:"Paste"},"paste"),r.jsx(E,{label:"Copy/Paste as"},"copy-paste"),r.jsx(E,{label:"Move to"},"move"),r.jsx(E,{label:"Bring to front"},"bring-to-front"),r.jsx(E,{label:"Send to back"},"send-to-back"),r.jsx(E,{label:"Group selection"},"group"),r.jsx(E,{label:"Ungroup"},"ungroup"),r.jsx(E,{label:"Rename"},"rename"),r.jsx(E,{label:"Show/hide"},"show-hide"),r.jsx(E,{label:"Lock/unlock"},"lock-unlock"),r.jsx(E,{label:"Isolate object"},"isolate")],error:I?`${U}-message`:void 0},b.id)})})]})}function Hs({item:t,onClick:e}){return r.jsx(E,{icon:t.hidden?Et:Nt,label:t.hidden?"Show":"Hide",visible:t.hidden?!0:void 0,onClick:i.useCallback(()=>{e(t.id)},[e,t.id]),dot:t.hidden?"Hidden":void 0},"visibility")}function De({tabs:t}){const{itemCount:e,isFiltered:s,search:n,setSearch:d}=i.useContext(de),a=i.useRef(null),l=i.useRef(null),u=i.useRef(null),h=i.useRef(null),[c,m]=i.useState(!t),f=s||!!n,g=c?r.jsxs(r.Fragment,{children:[r.jsx(Qs,{}),t?r.jsx(A,{className:S.shiftIconRight,icon:zt,label:"Close",variant:"ghost",onClick:()=>{var p;Pe.flushSync(()=>m(!1)),(p=l.current)==null||p.focus()}}):null]}):r.jsx(A,{className:S.shiftIconRight,icon:Ee,label:"Search",dot:f?"Some filters or search applied":void 0,variant:"ghost",onClick:()=>{var p;Pe.flushSync(()=>m(!0)),(p=a.current)==null||p.focus()}}),v=i.useMemo(()=>{if(s)return e===void 0?"Showing all tree items":`Showing ${e} tree items`},[s,e]),[w,T]=i.useState(!1);return i.useEffect(()=>{const p=u.current;if(!p)return;const M=h.current;if(!M)return;const F=l.current;if(!F)return;const B=new ResizeObserver(()=>{const N=!c&&F.clientWidth>p.clientWidth,Q=p.getBoundingClientRect().height,D=N?`${Math.floor(Q)-M.clientHeight}px`:"auto";p.style.setProperty("--ids-scrollbar-height",D),T(N)});return B.observe(p),B.observe(M),B.observe(F),()=>{B.disconnect()}},[c]),i.useEffect(()=>{const p=u.current;p&&c&&p.style.setProperty("--ids-scrollbar-height","auto")},[c]),r.jsxs("div",{className:S.subheader,ref:u,children:[r.jsx(ee,{"aria-live":"polite","aria-atomic":!0,children:v}),t&&!c?r.jsx("div",{className:S.subheaderContent,"data-overflow":w&&!c,ref:h,children:r.jsx(dt,{className:S.tabList,tone:"accent",ref:l,children:t})}):null,c?r.jsxs(ht,{className:S.searchInput,children:[r.jsx(ft,{href:Ee}),r.jsx(pt,{placeholder:"Search",ref:a,onChange:p=>d(p.currentTarget.value)})]}):null,r.jsx("div",{className:S.subheaderActions,children:g})]})}function Qs(){const t=i.useContext(de),e=t.appliedFilters.length>0;return r.jsxs(Je,{children:[r.jsx(Ye,{render:r.jsx(A,{icon:Ot,label:"Filter",dot:e?"Some filters applied":void 0,variant:"ghost",disabled:t.allFilters.length===0})}),r.jsx(Ze,{children:t.allFilters.map(s=>{const n=t.appliedFilters.includes(s);return r.jsx(et,{name:s,label:s,checked:n,onChange:()=>{t.toggleFilter(s)}},s)})})]})}function Le(t){const[e,s]=i.useState(!1),[n,d]=i.useState([]),[a,l]=i.useState(""),[u,h]=i.useState(void 0),c=i.useCallback(g=>{const v=n.includes(g)?n.filter(w=>w!==g):[...n,g];d(v),s(v.length>0)},[n]),m=i.useCallback(()=>{d([]),s(!1)},[]),f=i.useCallback(g=>{l(g),s(!!g)},[]);return r.jsx(de.Provider,{value:i.useMemo(()=>({allFilters:t.allFilters,appliedFilters:n,isFiltered:e,toggleFilter:c,clearFilters:m,search:a,setSearch:f,itemCount:u,setItemCount:h}),[t.allFilters,n,e,c,m,a,f,u]),children:t.children})}const de=i.createContext({allFilters:[],appliedFilters:[],isFiltered:!1,toggleFilter:()=>{},clearFilters:()=>{},search:"",setSearch:()=>{},itemCount:void 0,setItemCount:()=>{}});function As(t){return r.jsx("div",{className:S.colorSwatch,style:{"--_color":`var(--_color--${t.color})`},children:t.alt?r.jsx(ee,{children:t.alt}):null})}export{Ir as default,Cr as meta};
