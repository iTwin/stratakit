import{R as ue,D as W,p as le,a as fe,_ as ce,i as de,v as me,d as w,e as h,u as R,A as pe,ac as A,y as F,x as ve,Z as V,ad as Ie,ae as be,q as ge,h as Ce,w as xe,B as Se,af as Pe,a2 as we,f as he,b as Ee}from"./VOQWLFSQ-HVsFw6NL.js";import{u as ye}from"./Y62RTBST-DtTIwZhU.js";import{C as Te,d as De}from"./AMMIPFT4-Bvy6SnJQ.js";import{a as p,p as Re}from"./chunk-4WY6JWTD-DfzC-dkV.js";import{aa as Ae,ab as Fe}from"./~utils-DEfrZzhD.js";var C=ue([De],[Te]),Oe=C.useContext;C.useScopedContext;var Xe=C.useProviderContext,$e=C.ContextProvider,et=C.ScopedContextProvider,_e=p.createContext(void 0),ke=p.createContext(void 0),ze={id:null};function tt(r,n,o=!1){const t=r.findIndex(f=>f.id===n);return[...r.slice(t+1),...o?[ze]:[],...r.slice(0,t)]}function rt(r,n){return r.find(o=>!o.disabled)}function Ke(r,n){return n&&r.item(n)||null}function nt(r){const n=[];for(const o of r){const t=n.find(f=>{var d;return((d=f[0])==null?void 0:d.rowId)===o.rowId});t?t.push(o):n.push([o])}return n}function Le(r,n=!1){if(W(r))r.setSelectionRange(n?r.value.length:0,r.value.length);else if(r.isContentEditable){const o=le(r).getSelection();o?.selectAllChildren(r),n&&o?.collapseToEnd()}}var O=Symbol("FOCUS_SILENTLY");function Be(r){r[O]=!0,r.focus({preventScroll:!0})}function ot(r){const n=r[O];return delete r[O],n}function Y(r,n,o){return!(!n||n===o||!r.item(n.id))}var Ne="button";function Me(r){return A(r)?!0:r.tagName==="INPUT"&&!Se(r)}function He(r,n=!1){const o=r.clientHeight,{top:t}=r.getBoundingClientRect(),f=Math.max(o*.875,o-40)*1.5,d=n?o-f+t:f+t;return r.tagName==="HTML"?d+r.scrollTop:d}function Ue(r,n=!1){const{top:o}=r.getBoundingClientRect();return n?o+r.clientHeight:o}function j(r,n,o,t=!1){var f;if(!n||!o)return;const{renderedItems:d}=n.getState(),x=Pe(r);if(!x)return;const E=He(x,t);let c,v;for(let I=0;I<d.length;I+=1){const i=c;if(c=o(I),!c)break;if(c===i)continue;const S=(f=Ke(n,c))==null?void 0:f.element;if(!S)continue;const b=Ue(S,t)-E,u=Math.abs(b);if(t&&b<=0||!t&&b>=0){v!==void 0&&v<u&&(c=i);break}v=u}return c}function Ve(r,n){return F(r)?!1:Y(n,r.target)}var je=fe(function(n){var o=n,{store:t,rowId:f,preventScrollOnKeyDown:d=!1,moveOnKeyPress:x=!0,tabbable:E=!1,getItem:c,"aria-setsize":v,"aria-posinset":I}=o,i=ce(o,["store","rowId","preventScrollOnKeyDown","moveOnKeyPress","tabbable","getItem","aria-setsize","aria-posinset"]);const S=Oe();t=t||S;const l=de(i.id),b=p.useRef(null),u=p.useContext(ke),_=me(i)&&!i.accessibleWhenDisabled,{rowId:y,baseElement:k,isActiveItem:q,ariaSetSize:G,ariaPosInSet:Z,isTabbable:J}=Ae(t,{rowId(e){if(f)return f;if(e&&u?.baseElement&&u.baseElement===e.baseElement)return u.id},baseElement(e){return e?.baseElement||void 0},isActiveItem(e){return!!e&&e.activeId===l},ariaSetSize(e){if(v!=null)return v;if(e&&u?.ariaSetSize&&u.baseElement===e.baseElement)return u.ariaSetSize},ariaPosInSet(e){if(I!=null)return I;if(!e||!u?.ariaPosInSet||u.baseElement!==e.baseElement)return;const s=e.renderedItems.filter(a=>a.rowId===y);return u.ariaPosInSet+s.findIndex(a=>a.id===l)},isTabbable(e){if(!e?.renderedItems.length)return!0;if(e.virtualFocus)return!1;if(E)return!0;if(e.activeId===null)return!1;const s=t?.item(e.activeId);return s?.disabled||!s?.element?!0:e.activeId===l}}),Q=p.useCallback(e=>{var s;const a=w(h({},e),{id:l||e.id,rowId:y,disabled:!!_,children:(s=e.element)==null?void 0:s.textContent});return c?c(a):a},[l,y,_,c]),z=i.onFocus,T=p.useRef(!1),X=R(e=>{if(z?.(e),e.defaultPrevented||pe(e)||!l||!t||Ve(e,t))return;const{virtualFocus:s,baseElement:a}=t.getState();if(t.setActiveId(l),A(e.currentTarget)&&Le(e.currentTarget),!s||!F(e)||Me(e.currentTarget)||!a?.isConnected)return;ve()&&e.currentTarget.hasAttribute("data-autofocus")&&e.currentTarget.scrollIntoView({block:"nearest",inline:"nearest"}),T.current=!0,e.relatedTarget===a||Y(t,e.relatedTarget)?Be(a):a.focus()}),K=i.onBlurCapture,$=R(e=>{if(K?.(e),e.defaultPrevented)return;const s=t?.getState();s?.virtualFocus&&T.current&&(T.current=!1,e.preventDefault(),e.stopPropagation())}),L=i.onKeyDown,ee=V(d),te=V(x),re=R(e=>{if(L?.(e),e.defaultPrevented||!F(e)||!t)return;const{currentTarget:s}=e,a=t.getState(),D=t.item(l),m=!!D?.rowId,P=a.orientation!=="horizontal",g=a.orientation!=="vertical",N=()=>!!(m||g||!a.baseElement||!W(a.baseElement)),M={ArrowUp:(m||P)&&t.up,ArrowRight:(m||g)&&t.next,ArrowDown:(m||P)&&t.down,ArrowLeft:(m||g)&&t.previous,Home:()=>{if(N())return!m||e.ctrlKey?t?.first():t?.previous(-1)},End:()=>{if(N())return!m||e.ctrlKey?t?.last():t?.next(-1)},PageUp:()=>j(s,t,t?.up,!0),PageDown:()=>j(s,t,t?.down)}[e.key];if(M){if(A(s)){const U=Ie(s),ne=g&&e.key==="ArrowLeft",oe=g&&e.key==="ArrowRight",ie=P&&e.key==="ArrowUp",se=P&&e.key==="ArrowDown";if(oe||se){const{length:ae}=be(s);if(U.end!==ae)return}else if((ne||ie)&&U.start!==0)return}const H=M();if(ee(e)||H!==void 0){if(!te(e))return;e.preventDefault(),t.move(H)}}}),B=p.useMemo(()=>({id:l,baseElement:k}),[l,k]);return i=ge(i,e=>Re.jsx(_e.Provider,{value:B,children:e}),[B]),i=w(h({id:l,"data-active-item":q||void 0},i),{ref:Ce(b,i.ref),tabIndex:J?i.tabIndex:-1,onFocus:X,onBlurCapture:$,onKeyDown:re}),i=Fe(i),i=ye(w(h({store:t},i),{getItem:Q,shouldRegisterItem:l?i.shouldRegisterItem:!1})),xe(w(h({},i),{"aria-setsize":G,"aria-posinset":Z}))}),it=we(he(function(n){const o=je(n);return Ee(Ne,o)}));export{it as C,et as a,$e as b,Oe as c,Xe as d,rt as e,tt as f,Ke as g,nt as h,Y as i,ot as s,je as u};
