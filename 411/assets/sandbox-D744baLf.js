import{w as ie}from"./LMDWO4NN-C51_mRdy.js";import{t as le,a as n,n as e}from"./chunk-K6AXKMTT-B_QCnNdX.js";import{a as G}from"./index-Dr3kRIaJ.js";import{B as oe}from"./Button-BDThzTLR.js";import{D as Z,a as J,b as q,c as v,d as ce}from"./DropdownMenu-DNt11rlg.js";import{I as T}from"./Icon-DHyQLpiG.js";import{I as z}from"./IconButton-BYdnlU1F.js";import{S as de,H as ue}from"./Select-Dq8nQn7C.js";import{T as H,a as fe,b as X,c as pe}from"./Tabs-lsZ7ZotU.js";import{T as F}from"./Text-CeOMu6x9.js";import{T as me,a as he,b as xe}from"./TextBox-Bp_puRpt.js";import{V as N}from"./VisuallyHidden-CldqyofG.js";import{T as be,a as je,b as K,c as D,d as Ce}from"./Tree-Cguhgyfy.js";import{p as M}from"./placeholder-CN79J7rt.js";import{p as ge,l as Se,h as _e,m as Ie,s as W,d as ve,f as Ae}from"./visibility-hide-BbroGeXp.js";import{s as ye}from"./visibility-show-B6yHmr23.js";import"./index-jyeBNHV5.js";import"./X5NMLKT6-CF4rYh6u.js";import"./KUU7WJ55-D3HZtQ3a.js";import"./LVA2YJMS-BfjlbvRt.js";import"./~utils-Cznddkjz.js";import"./XL7CSKGW-DyJHwI7D.js";import"./Kbd-gCy3cf8q.js";import"./~hooks-jA6mLbHf.js";import"./YV4JVR4I-BIG7SmE9.js";import"./P2CTZE2T-B-sWCdSQ.js";import"./RZ4GPYOB-Bz8g_oo0.js";import"./BYC7LY2E-BxKc6YiQ.js";import"./VGCJ63VH-rGTei5h5.js";import"./XX67R432-Bv9x3_cY.js";import"./MTZPJQMC-BU0naf6q.js";import"./ITI7HKP4-JdhCx63u.js";import"./C3IKGW5T-DEtV1wWG.js";import"./VEVQD5MH-BTci7YJt.js";import"./P4IRICAX-CacsgStX.js";import"./ASMQKSDT-D3gVBJb5.js";import"./BOLVLGVE-C-Pift6v.js";import"./Tooltip-CoaxzYfH.js";import"./tooltip-anchor-oD8_qmTK.js";import"./Field-CMPyXgSP.js";import"./ListItem-C1Ywf02b.js";import"./~utils-KZaJJO_T.js";import"./~hooks-oFT9fZS9.js";const Pe="_appLayout_cf09u_5",Me="_header_cf09u_22",Re="_platformBar_cf09u_32",Te="_logo_cf09u_38",Ne="_tools_cf09u_48",Be="_leftPanel_cf09u_58",Ee="_panelHeader_cf09u_70",ze="_panelTitleWrapper_cf09u_78",ke="_panelCaption_cf09u_82",Le="_shiftIconRight_cf09u_86",we="_subheader_cf09u_90",De="_subheaderTitle_cf09u_101",Ke="_searchInput_cf09u_106",Fe="_subheaderActions_cf09u_110",Oe="_tabList_cf09u_114",Ge="_emptyState_cf09u_119",He="_canvasWrapper_cf09u_128",Xe="_canvas_cf09u_128",We="_splitter_cf09u_165",$e="_tabPanel_cf09u_211",Ve="_tree_cf09u_219",Ue="_action_cf09u_223",Ze="_actionIcon_cf09u_229",Je="_slider_cf09u_240",h={appLayout:Pe,header:Me,platformBar:Re,logo:Te,tools:Ne,leftPanel:Be,panelHeader:Ee,panelTitleWrapper:ze,panelCaption:ke,shiftIconRight:Le,subheader:we,subheaderTitle:De,searchInput:Ke,subheaderActions:Fe,tabList:Oe,emptyState:Ge,canvasWrapper:He,canvas:Xe,splitter:We,tabPanel:$e,tree:Ve,action:Ue,actionIcon:Ze,slider:Je},Q="Kiwi sandbox",en=()=>[{title:Q}],tn=ie(function(){const[r,s]=le(),l=r.get("tree")==="empty"?"epoch-2":"epoch-1",f=n.useCallback(c=>{s(m=>(c==="epoch-2"?m.set("tree","empty"):m.delete("tree"),m))},[s]),u=n.useMemo(()=>({"epoch-1":"Epoch System iModel 1","epoch-2":"Epoch System iModel 2"}),[]),o=n.useId();return e.jsxs(qe,{panelContent:e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:h.panelHeader,children:[e.jsxs("div",{children:[e.jsx(N,{render:c=>e.jsx("label",{...c,htmlFor:o}),children:"Choose Model"}),e.jsx(de,{className:h.panelTitleWrapper,children:e.jsx(ue,{id:o,variant:"ghost",defaultValue:l,onChange:c=>f(c.target.value),children:Object.entries(u).map(([c,m])=>e.jsx("option",{value:c,children:m},c))})}),e.jsxs("hgroup",{role:"group",children:[e.jsx(N,{render:c=>e.jsx("h2",{...c}),children:u[l]}),e.jsx("p",{className:h.panelCaption,children:"2024 Refresh"})]})]}),e.jsx("div",{className:h.actions,children:e.jsx(z,{className:h.shiftIconRight,icon:ge,label:"Dock panel",variant:"ghost",disabled:!0})})]}),e.jsx(dt,{children:e.jsxs(ct,{children:[e.jsx(lt,{}),e.jsx(H,{tabId:"simple",className:h.tabPanel,focusable:!1,children:l==="epoch-2"?e.jsx($,{}):e.jsx(V,{tree:"simple"})}),e.jsx(H,{tabId:"complex",className:h.tabPanel,focusable:!1,children:l==="epoch-2"?e.jsx($,{}):e.jsx(V,{tree:"complex"})})]})})]}),children:[e.jsxs("header",{className:h.header,children:[e.jsx("div",{className:h.logo,children:e.jsx(T,{href:M,size:"large"})}),e.jsx(F,{render:c=>e.jsx("h1",{...c}),variant:"body-md",children:Q})]}),e.jsx("div",{className:h.platformBar,children:e.jsxs("div",{className:h.tools,children:[e.jsx(T,{href:M,size:"large"}),e.jsx(T,{href:M,size:"large"}),e.jsx(T,{href:M,size:"large"})]})}),e.jsx("div",{className:h.canvasWrapper,children:e.jsx("div",{className:h.canvas})})]})});function qe(i){const{sliderProps:r,panelProps:s,panelMinSize:l,panelMaxSize:f,resizing:u}=et({minSize:{px:256,pct:20},maxSize:{pct:30}}),o=n.useId();return e.jsxs("div",{className:h.appLayout,style:{"--_panel-min-size":l,"--_panel-max-size":f},children:[e.jsx("div",{...s,className:h.leftPanel,style:{position:"relative",...s.style},children:i.panelContent}),e.jsxs("div",{className:h.splitter,"data-resizing":u?"true":void 0,children:[e.jsx(N,{render:c=>e.jsx("label",{...c,htmlFor:o,children:"Resize layers panel"}),children:"Resize layers panel"}),e.jsx("input",{id:o,type:"range",className:h.slider,...r})]}),i.children]})}function $(){return e.jsxs("div",{className:h.emptyState,children:[e.jsx(F,{variant:"body-sm",children:"No layers"}),e.jsx(oe,{children:"Create a layer"})]})}function Qe(){return e.jsx("div",{style:{textAlign:"center"},children:e.jsx(F,{variant:"body-sm",children:"No results found"})})}function Ye(i,r,s){return Math.min(Math.max(i,r),s)}function et(i){const{minSize:r,maxSize:s,onCollapse:l}=i,f=n.useId(),u=n.useRef(null),[o,c]=n.useState(void 0),[m,d]=n.useState(void 0),[p,x]=n.useState(void 0),[b,I]=n.useState(!1),[A,g]=n.useState(void 0),j=n.useMemo(()=>{if(r&&m)return Math.min(r.px,r.pct/100*m)},[r,m]),a=n.useMemo(()=>{if(j&&s&&m)return Math.max(j,s.pct/100*m)},[s,m,j]),S=n.useMemo(()=>{if(p==="smallest")return j??0;if(p==="largest")return a??0;if(o&&j&&a)return Ye(o,j,a)},[o,j,a,p]);n.useEffect(()=>{const C=u.current;if(!C)return;const _=C.parentElement;if(!_)return;const P=new ResizeObserver(()=>{const L=_.getBoundingClientRect(),w=C.getBoundingClientRect();d(L.width),c(w.width)});return P.observe(_),P.observe(C),()=>{P.disconnect()}},[]);const y=n.useCallback(C=>{const _=u.current;if(!_)return;const P=_.getBoundingClientRect();g(P.width+C),x(void 0),I(!0)},[]),E=n.useCallback(C=>{const _=u.current;if(!_)return;const P=_.parentElement;if(!P)return;const L=P.getBoundingClientRect(),w=C*(L.width*.005),ae=_.getBoundingClientRect();g(ae.width+w),x(void 0)},[]),k=n.useCallback(()=>{u.current&&(g(void 0),I(!1))},[]),{moveableProps:R}=tt({onMove:y,onMoveEnd:k,onKeyMove:E}),te=n.useMemo(()=>({...R,onKeyDown:C=>{var _;if((_=R.onKeyDown)==null||_.call(R,C),!C.defaultPrevented)switch(C.key){case"Enter":C.preventDefault(),l==null||l();break;case"Home":C.preventDefault(),x("smallest");break;case"End":C.preventDefault(),x("largest");break}},onChange:C=>{if(b)return;const _=Number(C.target.value);g(_)},value:S===void 0?0:Math.floor(S),min:j===void 0?void 0:Math.floor(j),max:a===void 0?void 0:Math.floor(a)}),[R,S,j,a,l,b]),ne=n.useMemo(()=>({style:{WebkitUserSelect:A===void 0?void 0:"none"},id:f,ref:u}),[f,A]),se=j===void 0?void 0:`${Math.floor(j)}px`,re=n.useMemo(()=>{if(A!==void 0&&s!==void 0&&p===void 0)return`min(${Math.floor(A)}px, ${s.pct}%)`;if(S!==void 0)return`${Math.floor(S)}px`},[s,A,S,p]);return{sliderProps:te,panelProps:ne,panelMinSize:se,panelMaxSize:re,resizing:b}}function tt(i){const{onMove:r,onMoveEnd:s,onKeyMove:l}=i,f=n.useRef(null),u=n.useRef(void 0),o=n.useRef(void 0),c=n.useCallback(()=>{o.current!==void 0&&(o.current=void 0,s==null||s())},[s]);return{moveableProps:n.useMemo(()=>({onPointerDown:d=>{if(d.button!==0||d.ctrlKey)return;const p=f.current;if(!p)return;const x=p.getBoundingClientRect(),b=d.clientX-x.left;o.current=b,d.preventDefault(),p.setPointerCapture(d.pointerId)},onPointerMove:d=>{const p=o.current;if(p===void 0)return;const x=f.current;if(!x)return;const b=x.getBoundingClientRect(),I=d.clientX-p-b.left;d.preventDefault(),r==null||r(I)},onPointerUp:c,onPointerCancel:c,onKeyDown:d=>{if(!d.defaultPrevented)switch(d.key){case"ArrowLeft":d.preventDefault(),l==null||l(-1);break;case"ArrowRight":d.preventDefault(),l==null||l(1);break}},ref:d=>{var x;if(f.current=d,(x=u.current)==null||x.call(u),u.current=void 0,!d)return;const p=b=>{b.preventDefault()};d.addEventListener("touchstart",p),u.current=()=>{d.removeEventListener("touchstart",p)}}}),[l,r,c])}}const t=(()=>{let i=0;return r=>({id:`${i++}`,label:`Tree Item ${i}`,items:[],expanded:!0,...r})})(),Y={filters:["Guides","Other","Road","Parking lot","Building","Sewer","Project boundary","Map"],items:[t({label:"Guides",type:"Guides",items:[t({label:"Tree",items:[t({label:"Guide 4"}),t({label:"Guide 3"}),t({label:"Guide 2"}),t({label:"Guide 1"})]})]}),t({label:"Other",type:"Other",items:[t({label:"Object 2",items:[t({label:"Path 3"})]}),t({label:"Object 1"})]}),t({label:"Road",type:"Road",items:[t({label:"Parking lot access"}),t({label:"Site access"})]}),t({label:"Parking lot",type:"Parking lot",items:[t({label:"Parking area",items:[t({label:"Bay point 2"}),t({label:"Bay point 1"}),t({label:"Space point 1"}),t({label:"Path 6"})]})]}),t({label:"Building",type:"Building",items:[t({label:"Building area",items:[t({label:"Path 5"})]})]}),t({label:"Sewer",type:"Building",items:[t({label:"Run off pipe",items:[t({label:"Path 4"})]})]}),t({label:"Project boundary",type:"Project boundary",items:[t({label:"Property area",items:[t({label:"Path 1"})]})]}),t({label:"Map",type:"Map",items:[t({label:"Location",items:[t({label:"Terrain"})]})]})]},nt={filters:[],items:[t({label:"ITC_Master",items:[t({label:"002_Substation",expanded:!1,items:[t({label:"002_Substation_A"})]}),t({label:"003-BENARCH-ZO-RF-M3-A-00001 - S-COLS",description:"Columns",expanded:!1,items:[t({label:"003-BENARCH-ZO-RF-M3-A-00001 - S-JOIS-ENVL",description:"Bar Joist: Envelopes"})]}),t({label:"003-BENARCH-ZO-RF-M3-A-00001 - S-SLAB-CONC",description:"Slabs: Concrete"}),t({label:"003-BENSTR-ZO-LG2-M3-S-00001 - S-BEAM-PURL",expanded:!1,error:"simple",description:"Columns: concrete"}),t({label:"005-BENROAD-00-XX-M3-G-00002.dgn",expanded:!1,error:"complex",items:[t({label:"005-BENROAD-00-XX-M3-G-00002-A"})]}),t({label:"005-BENROAD-00-XX-M3-G-00003.dgn",expanded:!1,items:[t({label:"005-BENROAD-00-XX-M3-G-00003-A"})]}),t({label:"007-aa_master.dgn",items:[t({label:"A-CLNG-LITE",expanded:!1,items:[t({label:"A-CLNG-LITE-A"})]}),t({label:"A-CLNG-TILE",items:[t({label:"A-DOOR-2D-PLAN",items:[t({label:"P00003 [2-KA62]",items:[t({label:"Cell [2-KA63]",items:[t({label:"Cell [2-KA64]",items:[t({label:"Complex Chain [2-KA6A]"}),t({label:"Complex Chain [2-KA6B]"}),t({label:"Complex Chain [2-KA6C]"}),t({label:"Complex Chain [2-KA6D]"}),t({label:"Complex Chain [2-KA6E]"}),t({label:"Complex Chain [2-KA6F]"}),t({label:"Complex Chain [2-KA6G]"}),t({label:"Complex Chain [2-KA6H]"}),t({label:"Complex Chain [2-KA61]"}),t({label:"Complex Chain [2-KA65]"}),t({label:"Complex Chain [2-KA66]"}),t({label:"Complex Chain [2-KA67]"}),t({label:"Complex Chain [2-KA68]"}),t({label:"Complex Chain [2-KA69]"})]})]})]}),t({label:"P00003 [2-KA74]",expanded:!1,items:[t({label:"P00003 [2-KA74-A]"})]}),t({label:"P00003 [2-KA86]",expanded:!1,items:[t({label:"P00003 [2-KA74-A]"})]}),t({label:"P00003 [2-KA98]",expanded:!1,items:[t({label:"P00003 [2-KA98-A]"})]}),t({label:"P00003 [2-KAAA]",expanded:!1,items:[t({label:"P00003 [2-KAAA-A]"})]})]})]})]})]})]};function st({items:i,filters:r,search:s}){const l=n.useMemo(()=>r.length===0?i:i.reduce((o,c)=>(!c.type||!r.includes(c.type)||o.push(c),o),[]),[i,r]),f=n.useMemo(()=>{function o(c){return c.reduce((m,d)=>{const p=o(d.items??[]);return(d.label.toLowerCase().includes(s.toLowerCase())||p.length>0)&&m.push({...d,items:p}),m},[])}return s===""?l:o(l)},[l,s]),u=n.useMemo(()=>{if(r.length===0&&s==="")return;function o(c){return c.reduce((m,d)=>{const p=d.items?o(d.items):0;return m+1+p},0)}return o(f)},[f,r,s]);return{filteredTree:f,itemCount:u}}function rt(i,r,s){return n.useMemo(()=>{function l(f,u,o,c,m){const d=[];let p=1;for(const x of f){const b=x.id===r||c,I=s.includes(x.id)||m;d.push({...x,level:o,parentItem:u,selected:b,hidden:I,parentHidden:m,position:p++,size:f.length}),x.expanded&&d.push(...l(x.items,x,o+1,b,I))}return d}return l(i,void 0,1,!1,!1)},[i,r,s])}function ee(i,r){for(const s of i){if(s.id===r)return s;const l=ee(s.items,r);if(l)return l}}function V({tree:i}){const{selectedId:r}=n.useContext(O),{filters:s,search:l,setItemCount:f,errors:u}=n.useContext(B),[o,c]=n.useState(),[m,d]=n.useState([]),p=n.useCallback(a=>{d(S=>S.includes(a)?S.filter(y=>y!==a):[...S,a])},[]),[x,b]=n.useState(()=>i==="complex"?nt.items:Y.items),{filteredTree:I,itemCount:A}=st({items:x,filters:s,search:l}),g=rt(I,o,m);n.useEffect(()=>{i===r&&f(A)},[i,r,f,A]);const j=n.useDeferredValue(g);return j.length===0?e.jsx(Qe,{}):e.jsxs(n.Suspense,{fallback:"Loading...",children:[e.jsx(be,{className:h.tree,children:j.map(a=>e.jsx(je,{label:a.label,description:a.description,"aria-level":a.level,"aria-posinset":a.position,"aria-setsize":a.size,selected:a.selected,onSelectedChange:()=>{if(o===a.id){c(void 0);return}c(a.id)},expanded:a.items.length===0&&!a.error?void 0:a.expanded,onExpandedChange:S=>{b(y=>{const E=ee(y,a.id);if(!E)return y;const k=[...y];return E.expanded=S,k})},icon:e.jsx(T,{href:M,style:{display:"inline"}}),actions:[e.jsx(K,{className:h.action,icon:Se,label:"Lock","aria-hidden":a.hidden},"lock"),e.jsx(K,{className:h.action,icon:a.hidden?_e:ye,label:a.hidden?"Show":"Hide",visible:a.hidden?!0:void 0,onClick:()=>{p(a.id)}},"visibility"),e.jsx(it,{hidden:a.hidden},"more")],error:a.error&&a.expanded?e.jsx(at,{error:a.error}):void 0},a.id))}),e.jsx(N,{"aria-live":"polite",children:Object.entries(u).map(([a,S])=>e.jsx("span",{children:S},a))})]})}function U(i){const{message:r,actions:s,...l}=i,{setError:f}=n.useContext(B),u=(s==null?void 0:s.length)??0,o=n.useId();return n.useEffect(()=>(f(o,e.jsxs(e.Fragment,{children:[r,u===1?"1 action available":void 0,u>1?`${u} actions available`:void 0]})),()=>{f(o,void 0)}),[o,r,u,f]),e.jsx(Ce,{...l,message:r,actions:s})}function at({error:i}){if(i==="simple")return e.jsx(U,{message:"Failed to create hierarchy",icon:M,actions:[e.jsx(D,{children:"Retry"},"retry")]});if(i==="complex")return e.jsx(U,{message:"The hierarchy exceeds 1000 items. Provide additional filtering or increase the limit.",icon:M,actions:[e.jsx(D,{children:"Add filter"},"add"),e.jsx(D,{children:"Increase limit"},"increase")]})}function it({hidden:i}){return e.jsxs(Z,{children:[e.jsx(J,{className:h.action,"aria-hidden":i,render:e.jsx(K,{icon:Ie,label:"More"})}),e.jsxs(q,{style:{minInlineSize:164},children:[e.jsx(v,{shortcuts:"⌘+C",children:"Copy"}),e.jsx(v,{shortcuts:"⌘+P",children:"Paste"}),e.jsx(v,{shortcuts:"⌘+V",children:"Copy/Paste as"}),e.jsx(v,{shortcuts:"⌘+M",children:"Move to"}),e.jsx(v,{shortcuts:"]",children:"Bring to front"}),e.jsx(v,{shortcuts:"[",children:"Send to back"}),e.jsx(v,{shortcuts:"⌘+G",children:"Group selection"}),e.jsx(v,{shortcuts:"⌘+U",children:"Ungroup"}),e.jsx(v,{shortcuts:"⌘+R",children:"Rename"}),e.jsx(v,{shortcuts:"⇧+⌘+V",children:"Show/hide"}),e.jsx(v,{shortcuts:"⇧+⌘+L",children:"Lock/unlock"}),e.jsx(v,{shortcuts:"I",children:"Isolate object"})]})]})}function lt(){const{selectedId:i}=n.useContext(O),{itemCount:r,filtered:s,clearFilters:l,search:f,setSearch:u}=n.useContext(B),[o,c]=n.useState(!1),m=n.useRef(null),d=n.useRef(null),p=o?e.jsxs(e.Fragment,{children:[e.jsx(ot,{filters:i==="simple"?Y.filters:[]}),e.jsx(z,{className:h.shiftIconRight,icon:ve,label:"Close",variant:"ghost",onClick:()=>{var b;u(""),l(),G.flushSync(()=>c(!1)),(b=d.current)==null||b.focus()}})]}):e.jsx(z,{className:h.shiftIconRight,icon:W,label:"Search",variant:"ghost",onClick:()=>{var b;G.flushSync(()=>c(!0)),(b=m.current)==null||b.focus()}}),x=n.useMemo(()=>{if(s)return r===void 0?"Showing all tree items":`Showing ${r} tree items`},[s,r]);return e.jsxs("div",{className:h.subheader,children:[e.jsx(N,{"aria-live":"polite","aria-atomic":!0,children:x}),o?void 0:e.jsxs(fe,{className:h.tabList,tone:"accent",ref:d,children:[e.jsx(X,{id:"simple",children:"Simple"}),e.jsx(X,{id:"complex",children:"Complex"})]}),o?e.jsxs(me,{className:h.searchInput,children:[e.jsx(he,{href:W}),e.jsx(xe,{placeholder:"Search",ref:m,onChange:b=>{u(b.target.value)},value:f})]}):null,e.jsx("div",{className:h.subheaderActions,children:p})]})}function ot({filters:i}){const r=n.useContext(B);return e.jsxs(Z,{children:[e.jsx(J,{render:e.jsx(z,{icon:Ae,label:"Filter",variant:"ghost",disabled:i.length===0,isActive:r.filters.length>0})}),e.jsx(q,{children:i.map(s=>{const l=r.filters.includes(s);return e.jsx(ce,{name:s,checked:l,onChange:()=>{r.toggleFilter(s)},children:s},s)})})]})}function ct(i){const[r,s]=n.useState(!1),[l,f]=n.useState([]),[u,o]=n.useState(""),[c,m]=n.useState(void 0),d=n.useCallback(g=>{f(j=>j.includes(g)?j.filter(a=>a!==g):[...j,g]),s(!0)},[]),p=n.useCallback(()=>{f([]),s(!0)},[]),x=n.useCallback(g=>{o(g),s(!0)},[]),[b,I]=n.useState({}),A=n.useCallback((g,j)=>{if(!j){I(a=>{const{[g]:S,...y}=a;return y});return}I(a=>({...a,[g]:j}))},[]);return e.jsx(B.Provider,{value:n.useMemo(()=>({filters:l,filtered:r,toggleFilter:d,clearFilters:p,search:u,setSearch:x,itemCount:c,setItemCount:m,setError:A,errors:b}),[l,r,d,p,u,x,c,A,b]),children:i.children})}function dt(i){const[r,s]=n.useState(void 0);return e.jsx(O.Provider,{value:n.useMemo(()=>({selectedId:r??""}),[r]),children:e.jsx(pe,{setSelectedId:s,selectedId:r,children:i.children})})}const B=n.createContext({filters:[],filtered:!1,toggleFilter:()=>{},clearFilters:()=>{},search:"",setSearch:()=>{},itemCount:void 0,setItemCount:()=>{},errors:{},setError:()=>{}}),O=n.createContext({selectedId:""});export{tn as default,en as meta};
