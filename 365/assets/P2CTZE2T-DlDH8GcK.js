import{C as ae,d as le,u as fe}from"./RZ4GPYOB-Dnwj5MkY.js";import{u as de}from"./KUU7WJ55-CriyIzjH.js";import{B as ce,x as W,t as me,c as pe,m as Ie,f as be,_ as ge,E as Ce,H as xe,e as w,b as v,k as R,j as V,A as Se,u as Pe,r as we,d as ve,W as Ee,X as A,y as F,Y as he,Z as ye,$ as Te,a0 as De,a1 as Re}from"./LMDWO4NN-Byj-nXYS.js";import{a as p,n as Ae}from"./chunk-K6AXKMTT-B_QCnNdX.js";import{f as Fe}from"./YV4JVR4I-BlNXHGle.js";var E=ce([le],[ae]),Oe=E.useContext,Je=E.useProviderContext,Qe=E.ContextProvider,et=E.ScopedContextProvider,_e=p.createContext(void 0),ke=p.createContext(void 0),ze={id:null};function tt(n,r,i=!1){const t=n.findIndex(f=>f.id===r);return[...n.slice(t+1),...i?[ze]:[],...n.slice(0,t)]}function nt(n,r){return n.find(i=>!i.disabled)}function Ke(n,r){return r&&n.item(r)||null}function rt(n){const r=[];for(const i of n){const t=r.find(f=>{var c;return((c=f[0])==null?void 0:c.rowId)===i.rowId});t?t.push(i):r.push([i])}return r}function Le(n,r=!1){if(W(n))n.setSelectionRange(r?n.value.length:0,n.value.length);else if(n.isContentEditable){const i=me(n).getSelection();i==null||i.selectAllChildren(n),r&&(i==null||i.collapseToEnd())}}var O=Symbol("FOCUS_SILENTLY");function Be(n){n[O]=!0,n.focus({preventScroll:!0})}function it(n){const r=n[O];return delete n[O],r}function Y(n,r,i){return!(!r||r===i||!n.item(r.id))}var Ne="button";function He(n){return A(n)?!0:n.tagName==="INPUT"&&!De(n)}function Me(n,r=!1){const i=n.clientHeight,{top:t}=n.getBoundingClientRect(),f=Math.max(i*.875,i-40)*1.5,c=r?i-f+t:f+t;return n.tagName==="HTML"?c+n.scrollTop:c}function Ue(n,r=!1){const{top:i}=n.getBoundingClientRect();return r?i+n.clientHeight:i}function j(n,r,i,t=!1){var f;if(!r||!i)return;const{renderedItems:c}=r.getState(),x=Re(n);if(!x)return;const h=Me(x,t);let d,I;for(let b=0;b<c.length;b+=1){const o=d;if(d=i(b),!d)break;if(d===o)continue;const S=(f=Ke(r,d))==null?void 0:f.element;if(!S)continue;const g=Ue(S,t)-h,a=Math.abs(g);if(t&&g<=0||!t&&g>=0){I!==void 0&&I<a&&(d=o);break}I=a}return d}function Ve(n,r){return F(n)?!1:Y(r,n.target)}var je=pe(function(r){var i=r,{store:t,rowId:f,preventScrollOnKeyDown:c=!1,moveOnKeyPress:x=!0,tabbable:h=!1,getItem:d,"aria-setsize":I,"aria-posinset":b}=i,o=ge(i,["store","rowId","preventScrollOnKeyDown","moveOnKeyPress","tabbable","getItem","aria-setsize","aria-posinset"]);const S=Oe();t=t||S;const l=Ce(o.id),g=p.useRef(null),a=p.useContext(ke),_=xe(o)&&!o.accessibleWhenDisabled,{rowId:y,baseElement:k,isActiveItem:G,ariaSetSize:X,ariaPosInSet:Z,isTabbable:$}=Fe(t,{rowId(e){if(f)return f;if(e&&a!=null&&a.baseElement&&a.baseElement===e.baseElement)return a.id},baseElement(e){return(e==null?void 0:e.baseElement)||void 0},isActiveItem(e){return!!e&&e.activeId===l},ariaSetSize(e){if(I!=null)return I;if(e&&a!=null&&a.ariaSetSize&&a.baseElement===e.baseElement)return a.ariaSetSize},ariaPosInSet(e){if(b!=null)return b;if(!e||!(a!=null&&a.ariaPosInSet)||a.baseElement!==e.baseElement)return;const s=e.renderedItems.filter(u=>u.rowId===y);return a.ariaPosInSet+s.findIndex(u=>u.id===l)},isTabbable(e){if(!(e!=null&&e.renderedItems.length))return!0;if(e.virtualFocus)return!1;if(h)return!0;if(e.activeId===null)return!1;const s=t==null?void 0:t.item(e.activeId);return s!=null&&s.disabled||!(s!=null&&s.element)?!0:e.activeId===l}}),q=p.useCallback(e=>{var s;const u=w(v({},e),{id:l||e.id,rowId:y,disabled:!!_,children:(s=e.element)==null?void 0:s.textContent});return d?d(u):u},[l,y,_,d]),z=o.onFocus,T=p.useRef(!1),J=R(e=>{if(z==null||z(e),e.defaultPrevented||Ee(e)||!l||!t||Ve(e,t))return;const{virtualFocus:s,baseElement:u}=t.getState();if(t.setActiveId(l),A(e.currentTarget)&&Le(e.currentTarget),!s||!F(e)||He(e.currentTarget)||!(u!=null&&u.isConnected))return;he()&&e.currentTarget.hasAttribute("data-autofocus")&&e.currentTarget.scrollIntoView({block:"nearest",inline:"nearest"}),T.current=!0,e.relatedTarget===u||Y(t,e.relatedTarget)?Be(u):u.focus()}),K=o.onBlurCapture,Q=R(e=>{if(K==null||K(e),e.defaultPrevented)return;const s=t==null?void 0:t.getState();s!=null&&s.virtualFocus&&T.current&&(T.current=!1,e.preventDefault(),e.stopPropagation())}),L=o.onKeyDown,ee=V(c),te=V(x),ne=R(e=>{if(L==null||L(e),e.defaultPrevented||!F(e)||!t)return;const{currentTarget:s}=e,u=t.getState(),D=t.item(l),m=!!(D!=null&&D.rowId),P=u.orientation!=="horizontal",C=u.orientation!=="vertical",N=()=>!!(m||C||!u.baseElement||!W(u.baseElement)),H={ArrowUp:(m||P)&&t.up,ArrowRight:(m||C)&&t.next,ArrowDown:(m||P)&&t.down,ArrowLeft:(m||C)&&t.previous,Home:()=>{if(N())return!m||e.ctrlKey?t==null?void 0:t.first():t==null?void 0:t.previous(-1)},End:()=>{if(N())return!m||e.ctrlKey?t==null?void 0:t.last():t==null?void 0:t.next(-1)},PageUp:()=>j(s,t,t==null?void 0:t.up,!0),PageDown:()=>j(s,t,t==null?void 0:t.down)}[e.key];if(H){if(A(s)){const U=ye(s),re=C&&e.key==="ArrowLeft",ie=C&&e.key==="ArrowRight",oe=P&&e.key==="ArrowUp",se=P&&e.key==="ArrowDown";if(ie||se){const{length:ue}=Te(s);if(U.end!==ue)return}else if((re||oe)&&U.start!==0)return}const M=H();if(ee(e)||M!==void 0){if(!te(e))return;e.preventDefault(),t.move(M)}}}),B=p.useMemo(()=>({id:l,baseElement:k}),[l,k]);return o=Se(o,e=>Ae.jsx(_e.Provider,{value:B,children:e}),[B]),o=w(v({id:l,"data-active-item":G||void 0},o),{ref:Pe(g,o.ref),tabIndex:$?o.tabIndex:-1,onFocus:J,onBlurCapture:Q,onKeyDown:ne}),o=de(o),o=fe(w(v({store:t},o),{getItem:q,shouldRegisterItem:l?o.shouldRegisterItem:!1})),we(w(v({},o),{"aria-setsize":X,"aria-posinset":Z}))}),ot=Ie(be(function(r){const i=je(r);return ve(Ne,i)}));export{et as C,Qe as a,je as b,ot as c,Je as d,nt as e,tt as f,Ke as g,rt as h,Y as i,it as s,Oe as u};
