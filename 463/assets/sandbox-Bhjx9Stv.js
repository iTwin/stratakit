var Te=t=>{throw TypeError(t)};var be=(t,e,s)=>e.has(t)||Te("Cannot "+s);var o=(t,e,s)=>(be(t,e,"read from private field"),s?s.call(t):e.get(t)),k=(t,e,s)=>e.has(t)?Te("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,s),C=(t,e,s,r)=>(be(t,e,"write to private field"),r?r.call(t,s):e.set(t,s),s),w=(t,e,s)=>(be(t,e,"access private method"),s);import{w as Xe,I as ie,b as V,V as ne,B as Je,c as Ye,d as Ze,A as Me}from"./~utils-DJd3N5V5.js";import{b as a,w as et,p as n,n as Fe}from"./index-DDCMeoDP.js";import{D as tt,a as st,b as nt,c as rt}from"./DropdownMenu-iGWu8e7p.js";import{E as it,a as at}from"./ErrorRegion-IXNyltyk.js";import{F as ot,a as lt,b as ct}from"./Field-B_kp_P2g.js";import{S as ut,H as ht}from"./Select-rNYgp6qP.js";import{S as de}from"./Skeleton-BYr8GoXM.js";import{T as dt,a as ft,b as pt,c as mt}from"./Tabs-DRR-3e33.js";import{T as pe}from"./Text-C6L0Fgs9.js";import{T as bt,a as xt,b as vt}from"./TextBox-BTldlzjl.js";import{T as gt,a as ue}from"./Toolbar-BOEApc8o.js";import{T as jt,a as St,b as z}from"./Tree-CcNzQ3UC.js";import{S as Ct,l as Pe,q as B,t as xe,r as he,b as yt,u as ve,v as Ee,w as It,g as Rt,x as wt,y as ze,n as Ve,z as _t}from"./QueryClientProvider-BZJipc45.js";import{p as ae}from"./placeholder-UZ_lwBqM.js";import{c as kt,a as Tt,d as Mt,m as Ft,p as Pt,s as Oe,l as Et,h as zt,b as Ot,f as Dt}from"./measure-Td-nHiCe.js";import{s as Lt}from"./visibility-show-CsRoR_5s.js";import"./Kbd-ix-KHau0.js";import"./P2CTZE2T-ChLjUHuI.js";import"./RZ4GPYOB-rvspWOwA.js";import"./ITI7HKP4-Dik326_U.js";import"./VEVQD5MH-CLPAYVM2.js";import"./AXB53BZF-DzY8uPAs.js";import"./P4IRICAX-ChgUHaLU.js";import"./ASMQKSDT-DH7XvaHf.js";import"./BOLVLGVE-Dv-H6bCP.js";var O,b,le,P,q,Z,H,N,ce,ee,te,G,X,$,se,v,oe,ge,je,Se,Ce,ye,Ie,Re,He,Ae,Nt=(Ae=class extends Ct{constructor(e,s){super();k(this,v);k(this,O);k(this,b);k(this,le);k(this,P);k(this,q);k(this,Z);k(this,H);k(this,N);k(this,ce);k(this,ee);k(this,te);k(this,G);k(this,X);k(this,$);k(this,se,new Set);this.options=s,C(this,O,e),C(this,N,null),C(this,H,Pe()),this.options.experimental_prefetchInRender||o(this,H).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(s)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(o(this,b).addObserver(this),De(o(this,b),this.options)?w(this,v,oe).call(this):this.updateResult(),w(this,v,Ce).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return we(o(this,b),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return we(o(this,b),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,w(this,v,ye).call(this),w(this,v,Ie).call(this),o(this,b).removeObserver(this)}setOptions(e,s){const r=this.options,d=o(this,b);if(this.options=o(this,O).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof B(this.options.enabled,o(this,b))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");w(this,v,Re).call(this),o(this,b).setOptions(this.options),r._defaulted&&!xe(this.options,r)&&o(this,O).getQueryCache().notify({type:"observerOptionsUpdated",query:o(this,b),observer:this});const l=this.hasListeners();l&&Le(o(this,b),d,this.options,r)&&w(this,v,oe).call(this),this.updateResult(s),l&&(o(this,b)!==d||B(this.options.enabled,o(this,b))!==B(r.enabled,o(this,b))||he(this.options.staleTime,o(this,b))!==he(r.staleTime,o(this,b)))&&w(this,v,ge).call(this);const c=w(this,v,je).call(this);l&&(o(this,b)!==d||B(this.options.enabled,o(this,b))!==B(r.enabled,o(this,b))||c!==o(this,$))&&w(this,v,Se).call(this,c)}getOptimisticResult(e){const s=o(this,O).getQueryCache().build(o(this,O),e),r=this.createResult(s,e);return Ut(this,r)&&(C(this,P,r),C(this,Z,this.options),C(this,q,o(this,b).state)),r}getCurrentResult(){return o(this,P)}trackResult(e,s){const r={};return Object.keys(e).forEach(d=>{Object.defineProperty(r,d,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(d),s==null||s(d),e[d])})}),r}trackProp(e){o(this,se).add(e)}getCurrentQuery(){return o(this,b)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const s=o(this,O).defaultQueryOptions(e),r=o(this,O).getQueryCache().build(o(this,O),s);return r.fetch().then(()=>this.createResult(r,s))}fetch(e){return w(this,v,oe).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),o(this,P)))}createResult(e,s){var Q;const r=o(this,b),d=this.options,l=o(this,P),c=o(this,q),u=o(this,Z),i=e!==r?e.state:o(this,le),{state:p}=e;let h={...p},m=!1,g;if(s._optimisticResults){const _=this.hasListeners(),D=!_&&De(e,s),j=_&&Le(e,r,s,d);(D||j)&&(h={...h,...wt(p.data,e.options)}),s._optimisticResults==="isRestoring"&&(h.fetchStatus="idle")}let{error:I,errorUpdatedAt:M,status:x}=h;if(s.select&&h.data!==void 0)if(l&&h.data===(c==null?void 0:c.data)&&s.select===o(this,ce))g=o(this,ee);else try{C(this,ce,s.select),g=s.select(h.data),g=ze(l==null?void 0:l.data,g,s),C(this,ee,g),C(this,N,null)}catch(_){C(this,N,_)}else g=h.data;if(s.placeholderData!==void 0&&g===void 0&&x==="pending"){let _;if(l!=null&&l.isPlaceholderData&&s.placeholderData===(u==null?void 0:u.placeholderData))_=l.data;else if(_=typeof s.placeholderData=="function"?s.placeholderData((Q=o(this,te))==null?void 0:Q.state.data,o(this,te)):s.placeholderData,s.select&&_!==void 0)try{_=s.select(_),C(this,N,null)}catch(D){C(this,N,D)}_!==void 0&&(x="success",g=ze(l==null?void 0:l.data,_,s),m=!0)}o(this,N)&&(I=o(this,N),g=o(this,ee),M=Date.now(),x="error");const T=h.fetchStatus==="fetching",F=x==="pending",W=x==="error",J=F&&T,Y=g!==void 0,E={status:x,fetchStatus:h.fetchStatus,isPending:F,isSuccess:x==="success",isError:W,isInitialLoading:J,isLoading:J,data:g,dataUpdatedAt:h.dataUpdatedAt,error:I,errorUpdatedAt:M,failureCount:h.fetchFailureCount,failureReason:h.fetchFailureReason,errorUpdateCount:h.errorUpdateCount,isFetched:h.dataUpdateCount>0||h.errorUpdateCount>0,isFetchedAfterMount:h.dataUpdateCount>i.dataUpdateCount||h.errorUpdateCount>i.errorUpdateCount,isFetching:T,isRefetching:T&&!F,isLoadingError:W&&!Y,isPaused:h.fetchStatus==="paused",isPlaceholderData:m,isRefetchError:W&&Y,isStale:_e(e,s),refetch:this.refetch,promise:o(this,H)};if(this.options.experimental_prefetchInRender){const _=y=>{E.status==="error"?y.reject(E.error):E.data!==void 0&&y.resolve(E.data)},D=()=>{const y=C(this,H,E.promise=Pe());_(y)},j=o(this,H);switch(j.status){case"pending":e.queryHash===r.queryHash&&_(j);break;case"fulfilled":(E.status==="error"||E.data!==j.value)&&D();break;case"rejected":(E.status!=="error"||E.error!==j.reason)&&D();break}}return E}updateResult(e){const s=o(this,P),r=this.createResult(o(this,b),this.options);if(C(this,q,o(this,b).state),C(this,Z,this.options),o(this,q).data!==void 0&&C(this,te,o(this,b)),xe(r,s))return;C(this,P,r);const d={},l=()=>{if(!s)return!0;const{notifyOnChangeProps:c}=this.options,u=typeof c=="function"?c():c;if(u==="all"||!u&&!o(this,se).size)return!0;const f=new Set(u??o(this,se));return this.options.throwOnError&&f.add("error"),Object.keys(o(this,P)).some(i=>{const p=i;return o(this,P)[p]!==s[p]&&f.has(p)})};(e==null?void 0:e.listeners)!==!1&&l()&&(d.listeners=!0),w(this,v,He).call(this,{...d,...e})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&w(this,v,Ce).call(this)}},O=new WeakMap,b=new WeakMap,le=new WeakMap,P=new WeakMap,q=new WeakMap,Z=new WeakMap,H=new WeakMap,N=new WeakMap,ce=new WeakMap,ee=new WeakMap,te=new WeakMap,G=new WeakMap,X=new WeakMap,$=new WeakMap,se=new WeakMap,v=new WeakSet,oe=function(e){w(this,v,Re).call(this);let s=o(this,b).fetch(this.options,e);return e!=null&&e.throwOnError||(s=s.catch(yt)),s},ge=function(){w(this,v,ye).call(this);const e=he(this.options.staleTime,o(this,b));if(ve||o(this,P).isStale||!Ee(e))return;const r=It(o(this,P).dataUpdatedAt,e)+1;C(this,G,setTimeout(()=>{o(this,P).isStale||this.updateResult()},r))},je=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(o(this,b)):this.options.refetchInterval)??!1},Se=function(e){w(this,v,Ie).call(this),C(this,$,e),!(ve||B(this.options.enabled,o(this,b))===!1||!Ee(o(this,$))||o(this,$)===0)&&C(this,X,setInterval(()=>{(this.options.refetchIntervalInBackground||Rt.isFocused())&&w(this,v,oe).call(this)},o(this,$)))},Ce=function(){w(this,v,ge).call(this),w(this,v,Se).call(this,w(this,v,je).call(this))},ye=function(){o(this,G)&&(clearTimeout(o(this,G)),C(this,G,void 0))},Ie=function(){o(this,X)&&(clearInterval(o(this,X)),C(this,X,void 0))},Re=function(){const e=o(this,O).getQueryCache().build(o(this,O),this.options);if(e===o(this,b))return;const s=o(this,b);C(this,b,e),C(this,le,e.state),this.hasListeners()&&(s==null||s.removeObserver(this),e.addObserver(this))},He=function(e){Ve.batch(()=>{e.listeners&&this.listeners.forEach(s=>{s(o(this,P))}),o(this,O).getQueryCache().notify({query:o(this,b),type:"observerResultsUpdated"})})},Ae);function Bt(t,e){return B(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function De(t,e){return Bt(t,e)||t.state.data!==void 0&&we(t,e,e.refetchOnMount)}function we(t,e,s){if(B(e.enabled,t)!==!1){const r=typeof s=="function"?s(t):s;return r==="always"||r!==!1&&_e(t,e)}return!1}function Le(t,e,s,r){return(t!==e||B(r.enabled,t)===!1)&&(!s.suspense||t.state.status!=="error")&&_e(t,s)}function _e(t,e){return B(e.enabled,t)!==!1&&t.isStaleByTime(he(e.staleTime,t))}function Ut(t,e){return!xe(t.getCurrentResult(),e)}var $e=a.createContext(!1),Qt=()=>a.useContext($e);$e.Provider;function At(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var Vt=a.createContext(At()),Ht=()=>a.useContext(Vt);function $t(t,e){return typeof t=="function"?t(...e):!!t}function Ne(){}var Wt=(t,e)=>{(t.suspense||t.throwOnError||t.experimental_prefetchInRender)&&(e.isReset()||(t.retryOnMount=!1))},Kt=t=>{a.useEffect(()=>{t.clearReset()},[t])},qt=({result:t,errorResetBoundary:e,throwOnError:s,query:r,suspense:d})=>t.isError&&!e.isReset()&&!t.isFetching&&r&&(d&&t.data===void 0||$t(s,[t.error,r])),Gt=t=>{const e=t.staleTime;t.suspense&&(t.staleTime=typeof e=="function"?(...s)=>Math.max(e(...s),1e3):Math.max(e??1e3,1e3),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3)))},Xt=(t,e)=>t.isLoading&&t.isFetching&&!e,Jt=(t,e)=>(t==null?void 0:t.suspense)&&e.isPending,Be=(t,e,s)=>e.fetchOptimistic(t).catch(()=>{s.clearReset()});function Yt(t,e,s){var h,m,g,I,M;const r=_t(),d=Qt(),l=Ht(),c=r.defaultQueryOptions(t);(m=(h=r.getDefaultOptions().queries)==null?void 0:h._experimental_beforeQuery)==null||m.call(h,c),c._optimisticResults=d?"isRestoring":"optimistic",Gt(c),Wt(c,l),Kt(l);const u=!r.getQueryCache().get(c.queryHash),[f]=a.useState(()=>new e(r,c)),i=f.getOptimisticResult(c),p=!d&&t.subscribed!==!1;if(a.useSyncExternalStore(a.useCallback(x=>{const T=p?f.subscribe(Ve.batchCalls(x)):Ne;return f.updateResult(),T},[f,p]),()=>f.getCurrentResult(),()=>f.getCurrentResult()),a.useEffect(()=>{f.setOptions(c,{listeners:!1})},[c,f]),Jt(c,i))throw Be(c,f,l);if(qt({result:i,errorResetBoundary:l,throwOnError:c.throwOnError,query:r.getQueryCache().get(c.queryHash),suspense:c.suspense}))throw i.error;if((I=(g=r.getDefaultOptions().queries)==null?void 0:g._experimental_afterQuery)==null||I.call(g,c,i),c.experimental_prefetchInRender&&!ve&&Xt(i,d)){const x=u?Be(c,f,l):(M=r.getQueryCache().get(c.queryHash))==null?void 0:M.promise;x==null||x.catch(Ne).finally(()=>{f.updateResult()})}return c.notifyOnChangeProps?i:f.trackResult(i)}function Zt(t,e){return Yt(t,Nt)}const es="_appLayout_i6khw_5",ts="_header_i6khw_22",ss="_platformBar_i6khw_32",ns="_logo_i6khw_38",rs="_tools_i6khw_48",is="_leftPanel_i6khw_58",as="_panelHeader_i6khw_70",os="_panelTitleWrapper_i6khw_78",ls="_panelCaption_i6khw_82",cs="_shiftIconRight_i6khw_86",us="_subheader_i6khw_90",hs="_searchInput_i6khw_106",ds="_subheaderActions_i6khw_110",fs="_tabList_i6khw_114",ps="_emptyState_i6khw_119",ms="_skeletonTree_i6khw_128",bs="_skeletonTreeItem_i6khw_135",xs="_canvasWrapper_i6khw_144",vs="_canvas_i6khw_144",gs="_splitter_i6khw_182",js="_tabPanel_i6khw_228",Ss="_tree_i6khw_241",Cs="_slider_i6khw_246",ys="_colorSwatch_i6khw_255",S={appLayout:es,header:ts,platformBar:ss,logo:ns,tools:rs,leftPanel:is,panelHeader:as,panelTitleWrapper:os,panelCaption:ls,shiftIconRight:cs,subheader:us,searchInput:hs,subheaderActions:ds,tabList:fs,emptyState:ps,skeletonTree:ms,skeletonTreeItem:bs,canvasWrapper:xs,canvas:vs,splitter:gs,tabPanel:js,tree:Ss,slider:Cs,colorSwatch:ys},Is="/463/assets/sandbox.model1-B8uu5h-t.json",Rs="/463/assets/sandbox.model2-Bi69Ub92.json",ws="data:application/json;base64,ewoJIm5hbWUiOiAiRXBvY2ggU3lzdGVtIGlNb2RlbCAzIiwKCSJ2ZXJzaW9uIjogIjIwMjQgUmVmcmVzaCIsCgkiZGF0YSI6IHsKCQkiZGVmYXVsdCI6IFtdCgl9Cn0K",fe={model1:{name:"Epoch System iModel 1",url:Is},model2:{name:"Epoch System iModel 2",url:Rs},model3:{name:"Epoch System iModel 3",url:ws}};async function _s(t){if(t in fe){const e=await fetch(fe[t].url).then(s=>s.json());return e.slow&&await new Promise(s=>setTimeout(s,Math.random()*2e3)),e}return{name:"Unknown",version:"Unknown",data:{default:[]}}}const We="Kiwi sandbox",vn=()=>[{title:We}],gn=Xe(function(){var l;const[e,s]=et(),r=e.get("model")||"model1",d=Zt({queryKey:["sandbox-data",r],queryFn:()=>_s(r)});return n.jsxs(ks,{panelContent:n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:S.panelHeader,children:[n.jsxs("div",{children:[n.jsxs(ot,{children:[n.jsx(ne,{render:n.jsx(lt,{}),children:"Choose Model"}),n.jsx(ct,{render:c=>n.jsx(ut,{className:S.panelTitleWrapper,children:n.jsx(ht,{...c,variant:"ghost",defaultValue:r,onChange:u=>s({model:u.currentTarget.value}),children:Object.entries(fe).map(([u,{name:f}])=>n.jsx("option",{value:u,children:f},u))})})})]}),n.jsxs("hgroup",{role:"group",children:[n.jsx(ne,{render:n.jsx("h2",{}),children:(l=fe[r])==null?void 0:l.name}),n.jsx(a.Suspense,{fallback:n.jsx(de,{variant:"text"}),children:n.jsx(Fs,{query:d})},r)]})]}),n.jsx("div",{children:n.jsx(V,{className:S.shiftIconRight,icon:Pt,label:"Dock panel",variant:"ghost",disabled:!0})})]}),n.jsx(a.Suspense,{fallback:n.jsx(Ts,{}),children:n.jsx(Ps,{query:d})},r)]}),children:[n.jsxs("header",{className:S.header,children:[n.jsx("div",{className:S.logo,children:n.jsx(ie,{href:ae,size:"large"})}),n.jsx(pe,{render:c=>n.jsx("h1",{...c}),variant:"body-md",children:We})]}),n.jsx("div",{className:S.platformBar,children:n.jsxs("div",{className:S.tools,children:[n.jsx(ie,{href:ae,size:"large"}),n.jsx(ie,{href:ae,size:"large"}),n.jsx(ie,{href:ae,size:"large"})]})}),n.jsx("div",{className:S.canvasWrapper,children:n.jsx("div",{className:S.canvas,children:n.jsxs(gt,{variant:"solid",children:[n.jsx(ue,{render:n.jsx(V,{label:"Select",icon:kt,variant:"ghost"})}),n.jsx(ue,{render:n.jsx(V,{label:"Move",icon:Tt,variant:"ghost"})}),n.jsx(ue,{render:n.jsx(V,{label:"Draw",icon:Mt,variant:"ghost"})}),n.jsx(ue,{render:n.jsx(V,{label:"Measure",icon:Ft,variant:"ghost"})})]})})})]})});function ks(t){const{sliderProps:e,panelProps:s,panelMinSize:r,panelMaxSize:d,resizing:l}=Ds({minSize:{px:256,pct:20},maxSize:{pct:30}}),c=a.useId();return n.jsxs("div",{className:S.appLayout,style:{"--_panel-min-size":r,"--_panel-max-size":d},children:[n.jsx("div",{...s,className:S.leftPanel,style:{position:"relative",...s.style},children:t.panelContent}),n.jsxs("div",{className:S.splitter,"data-resizing":l?"true":void 0,children:[n.jsx(ne,{render:u=>n.jsx("label",{...u,htmlFor:c,children:"Resize layers panel"}),children:"Resize layers panel"}),n.jsx("input",{id:c,type:"range",className:S.slider,...e})]}),t.children]})}function Ts(){const t=[1,1,2,2,3,2,3,2,1,1,2,3,4,5,2,3,4,5];return n.jsxs(n.Fragment,{children:[n.jsx("div",{className:S.subheader,children:n.jsx(de,{variant:"text"})}),n.jsxs("div",{className:S.skeletonTree,children:[t.map((e,s)=>n.jsx(Ms,{style:{"--level":e}},`${s}-${e}`)),n.jsx(ne,{children:"Loadingâ€¦"})]})]})}function Ms(t){return n.jsxs("div",{...t,className:Ze(S.skeletonTreeItem,t.className),children:[n.jsx(de,{variant:"object",size:"small"}),n.jsx(de,{variant:"text"})]})}function Fs(t){const{version:e=""}=a.use(t.query.promise);return n.jsx(pe,{className:S.panelCaption,variant:"body-sm",render:n.jsx("p",{}),children:e})}function Ps(t){var c;const{data:e}=a.use(t.query.promise),s=a.useMemo(()=>Object.entries(e).map(([u,f])=>{const i=f.length<=1?[]:f.map(({label:p})=>p);return{name:u,filters:i,content:f.length>0?n.jsx(As,{name:u,data:f,length:Object.entries(e).length}):n.jsxs(Es,{children:[n.jsx(pe,{variant:"body-sm",children:"No layers"}),n.jsx(Je,{children:"Create a layer"})]})}}),[e]),[r,d]=a.useState((c=s[0])==null?void 0:c.name),l=a.useMemo(()=>{var u;return r?((u=s.find(f=>f.name===r))==null?void 0:u.filters)||[]:s[0].filters},[s,r]);return s.length===1?n.jsxs(Qe,{allFilters:l,children:[n.jsx(Ue,{}),s[0].content]}):n.jsx(Qe,{allFilters:l,children:n.jsxs(dt,{selectOnMove:!1,setSelectedId:d,children:[n.jsx(Ue,{tabs:s.map(u=>n.jsx(ft,{id:u.name,children:Ye(u.name)},u.name))}),s.map(u=>n.jsx(a.Fragment,{children:u.content},u.name))]})})}function Es({children:t}){return n.jsx("div",{className:S.emptyState,children:t})}function zs(){return n.jsx("div",{style:{textAlign:"center"},children:n.jsx(pe,{variant:"body-sm",children:"No results found"})})}function Os(t,e,s){return Math.min(Math.max(t,e),s)}function Ds(t){const{minSize:e,maxSize:s,onCollapse:r}=t??{},d=a.useId(),l=a.useRef(null),[c,u]=a.useState(void 0),[f,i]=a.useState(void 0),[p,h]=a.useState(void 0),[m,g]=a.useState(!1),[I,M]=a.useState(void 0),x=a.useMemo(()=>{if(e&&f)return Math.min(e.px,e.pct/100*f)},[e,f]),T=a.useMemo(()=>{if(x&&s&&f)return Math.max(x,s.pct/100*f)},[s,f,x]),F=a.useMemo(()=>{if(p==="smallest")return x??0;if(p==="largest")return T??0;if(c&&x&&T)return Os(c,x,T)},[c,x,T,p]);a.useEffect(()=>{const j=l.current;if(!j)return;const y=j.parentElement;if(!y)return;const L=new ResizeObserver(()=>{const re=y.getBoundingClientRect(),R=j.getBoundingClientRect();i(re.width),u(R.width)});return L.observe(y),L.observe(j),()=>{L.disconnect()}},[]);const W=a.useCallback(j=>{const y=l.current;if(!y)return;const L=y.getBoundingClientRect();M(L.width+j),h(void 0),g(!0)},[]),J=a.useCallback(j=>{const y=l.current;if(!y)return;const L=y.parentElement;if(!L)return;const re=L.getBoundingClientRect(),R=j*(re.width*.005),A=y.getBoundingClientRect();M(A.width+R),h(void 0)},[]),Y=a.useCallback(()=>{l.current&&(M(void 0),g(!1))},[]),{moveableProps:U}=Ls({onMove:W,onMoveEnd:Y,onKeyMove:J}),E=a.useMemo(()=>({...U,onKeyDown:j=>{var y;if((y=U.onKeyDown)==null||y.call(U,j),!j.defaultPrevented)switch(j.key){case"Enter":j.preventDefault(),r==null||r();break;case"Home":j.preventDefault(),h("smallest");break;case"End":j.preventDefault(),h("largest");break}},onChange:j=>{if(m)return;const y=Number(j.target.value);M(y)},value:F===void 0?0:Math.floor(F),min:x===void 0?void 0:Math.floor(x),max:T===void 0?void 0:Math.floor(T)}),[U,F,x,T,r,m]),Q=a.useMemo(()=>({style:{WebkitUserSelect:I===void 0?void 0:"none"},id:d,ref:l}),[d,I]),_=x===void 0?void 0:`${Math.floor(x)}px`,D=a.useMemo(()=>{if(I!==void 0&&s!==void 0&&p===void 0)return`min(${Math.floor(I)}px, ${s.pct}%)`;if(F!==void 0)return`${Math.floor(F)}px`},[s,I,F,p]);return{sliderProps:E,panelProps:Q,panelMinSize:_,panelMaxSize:D,resizing:m}}function Ls(t){const{onMove:e,onMoveEnd:s,onKeyMove:r}=t??{},d=a.useRef(null),l=a.useRef(void 0),c=a.useRef(void 0),u=a.useCallback(()=>{c.current!==void 0&&(c.current=void 0,s==null||s())},[s]);return{moveableProps:a.useMemo(()=>({onPointerDown:i=>{if(i.button!==0||i.ctrlKey)return;const p=d.current;if(!p)return;const h=p.getBoundingClientRect(),m=i.clientX-h.left;c.current=m,i.preventDefault(),p.setPointerCapture(i.pointerId)},onPointerMove:i=>{const p=c.current;if(p===void 0)return;const h=d.current;if(!h)return;const m=h.getBoundingClientRect(),g=i.clientX-p-m.left;i.preventDefault(),e==null||e(g)},onPointerUp:u,onPointerCancel:u,onKeyDown:i=>{if(!i.defaultPrevented)switch(i.key){case"ArrowLeft":i.preventDefault(),r==null||r(-1);break;case"ArrowRight":i.preventDefault(),r==null||r(1);break}},ref:i=>{var h;if(d.current=i,(h=l.current)==null||h.call(l),l.current=void 0,!i)return;const p=m=>{m.preventDefault()};i.addEventListener("touchstart",p),l.current=()=>{i.removeEventListener("touchstart",p)}}}),[r,e,u])}}const Ke=(()=>{let t=0;return e=>({id:`${t++}`,label:`Tree Item ${t}`,expanded:!0,...e,items:((e==null?void 0:e.items)??[]).map(Ke)})})();function Ns({items:t,filters:e,search:s,errorIds:r}){const d=a.useMemo(()=>e.length===0?t:t.reduce((u,f)=>(e.includes(f.label)&&u.push(f),u),[]),[t,e]),l=a.useMemo(()=>{function u(f){return f.reduce((i,p)=>{const m=r.includes(p.id)?[]:u(p.items??[]);return(p.label.toLowerCase().includes(s.toLowerCase())||m.length>0)&&i.push({...p,items:m}),i},[])}return s===""&&r.length===0?d:u(d)},[d,s,r]),c=a.useMemo(()=>{if(e.length===0&&s==="")return;function u(f){return f.reduce((i,p)=>{const h=p.items?u(p.items):0;return i+1+h},0)}return u(l)},[l,e,s]);return{filteredTree:l,itemCount:c}}function Bs(t,e){return a.useMemo(()=>{function s(r){return r.reduce((d,l)=>(e.includes(l.id)&&d.push(l),l.items&&d.push(...s(l.items)),d),[])}return s(t)},[t,e])}function Us(t,e,s){return a.useMemo(()=>{function r(d,l,c,u,f){const i=[];let p=1;for(const h of d){const m=h.id===e||u,g=s.includes(h.id)||f;i.push({...h,level:c,parentItem:l,selected:m,hidden:g,parentHidden:f,position:p++,size:d.length}),h.expanded&&i.push(...r(h.items,h,c+1,m,g))}return i}return r(t,void 0,1,!1,!1)},[t,e,s])}function qe(t,e){for(const s of t){if(s.id===e)return s;const r=qe(s.items,e);if(r)return r}}function Qs({deferredItems:t,selected:e,errorMessage:s,errorItems:r,setSelected:d,toggleFailingIds:l,onExpandedChange:c,toggleHidden:u}){const f=a.useId();return t.length===0?n.jsx(zs,{}):n.jsxs(a.Suspense,{fallback:"Loading...",children:[n.jsx(it,{"aria-label":"Tree errors",label:s,items:r.map(i=>{const p=`${f}-${i.id}`;return n.jsx(at,{message:n.jsxs(n.Fragment,{children:[n.jsx("span",{children:"Failed to create hierarchy for "}),n.jsx(Me,{href:`#${p}`,children:i.label})]}),messageId:`${p}-message`,actions:n.jsx(Me,{render:n.jsx("button",{}),onClick:()=>{l(i)},children:"Retry"},"retry"),onDismiss:()=>{l(i)}},i.id)})}),n.jsx(jt,{className:S.tree,children:t.map(i=>{const p=r.find(m=>m.id===i.id),h=p?`${f}-${i.id}`:void 0;return n.jsx(St,{id:h,label:i.label,description:i.description,"aria-level":i.level,"aria-posinset":i.position,"aria-setsize":i.size,selected:i.selected,onSelectedChange:()=>{if(e===i.id){d(void 0);return}d(i.id)},expanded:i.items.length===0&&!p?void 0:i.expanded,onExpandedChange:m=>{c(m,i)},unstable_decorations:n.jsxs(n.Fragment,{children:[i.color?n.jsx(Hs,{color:i.color,alt:i.color}):null,n.jsx(ie,{href:ae})]}),actions:[n.jsx(z,{icon:Et,label:"Lock"},"lock"),n.jsx(z,{icon:i.hidden?zt:Lt,label:i.hidden?"Show":"Hide",visible:i.hidden?!0:void 0,onClick:()=>{u(i.id)},dot:i.hidden?"Hidden":void 0},"visibility"),n.jsx(z,{label:"Copy"},"copy"),n.jsx(z,{label:"Paste"},"paste"),n.jsx(z,{label:"Copy/Paste as"},"copy-paste"),n.jsx(z,{label:"Move to"},"move"),n.jsx(z,{label:"Bring to front"},"bring-to-front"),n.jsx(z,{label:"Send to back"},"send-to-back"),n.jsx(z,{label:"Group selection"},"group"),n.jsx(z,{label:"Ungroup"},"ungroup"),n.jsx(z,{label:"Rename"},"rename"),n.jsx(z,{label:"Show/hide"},"show-hide"),n.jsx(z,{label:"Lock/unlock"},"lock-unlock"),n.jsx(z,{label:"Isolate object"},"isolate")],error:p?`${h}-message`:void 0},i.id)})})]})}function As({name:t,data:e,length:s}){const{appliedFilters:r,search:d,setItemCount:l,isSearchboxVisible:c}=a.useContext(me),[u,f]=a.useState(),[i,p]=a.useState([]),h=a.useCallback(R=>{p(A=>A.includes(R)?A.filter(K=>K!==R):[...A,R])},[]),[m,g]=a.useState(()=>e.map(R=>Ke(R))),I=a.useCallback((R,A)=>{g(K=>{const ke=qe(K,A.id);if(!ke)return K;const Ge=[...K];return ke.expanded=R,Ge})},[]),[M,x]=a.useState(["benstr","benroad"]),T=Bs(m,M),F=a.useMemo(()=>T.filter(R=>R.expanded),[T]),W=a.useMemo(()=>F.map(R=>R.id),[F]),J=a.useCallback(R=>{x(A=>A.filter(K=>K!==R.id))},[]),{filteredTree:Y,itemCount:U}=Ns({items:m,filters:r,search:d,errorIds:W}),E=Us(Y,u,i);a.useEffect(()=>{l(U)},[l,U]);const Q=F.length,_=a.useMemo(()=>{if(Q!==0)return Q===1?"1 issue found":`${Q} issues found`},[Q]),D=a.useRef(null),j=a.useDeferredValue(E),y=!c&&s>1?pt:"div",L=a.useMemo(()=>({tabId:t,unmountOnHide:!0}),[t]),re=a.useMemo(()=>{var R;return{...(c&&((R=D==null?void 0:D.current)==null?void 0:R.dataset.open)||s===1)&&{"data-open":!0}}},[s,c]);return n.jsx(y,{className:S.tabPanel,focusable:!1,ref:D,...y==="div"?re:L,children:n.jsx(Qs,{deferredItems:j,selected:u,errorMessage:_,errorItems:F,setSelected:f,toggleFailingIds:J,onExpandedChange:I,toggleHidden:h})},t)}function Ue({tabs:t}){const{itemCount:e,isFiltered:s,search:r,setSearch:d,isSearchboxVisible:l,setIsSearchboxVisible:c}=a.useContext(me),u=a.useRef(null),f=a.useRef(null),i=s||!!r,p=l?n.jsxs(n.Fragment,{children:[n.jsx(Vs,{}),t?n.jsx(V,{className:S.shiftIconRight,icon:Ot,label:"Close",variant:"ghost",onClick:()=>{var m;Fe.flushSync(()=>c(!1)),(m=f.current)==null||m.focus()}}):null]}):n.jsx(V,{className:S.shiftIconRight,icon:Oe,label:"Search",dot:i?"Some filters or search applied":void 0,variant:"ghost",onClick:()=>{var m;Fe.flushSync(()=>c(!0)),(m=u.current)==null||m.focus()}}),h=a.useMemo(()=>{if(s)return e===void 0?"Showing all tree items":`Showing ${e} tree items`},[s,e]);return n.jsxs("div",{className:S.subheader,children:[n.jsx(ne,{"aria-live":"polite","aria-atomic":!0,children:h}),t&&!l?n.jsx(mt,{className:S.tabList,tone:"accent",ref:f,children:t}):null,l?n.jsxs(bt,{className:S.searchInput,children:[n.jsx(xt,{href:Oe}),n.jsx(vt,{placeholder:"Search",ref:u,onChange:m=>d(m.currentTarget.value)})]}):null,n.jsx("div",{className:S.subheaderActions,children:p})]})}function Vs(){const t=a.useContext(me),e=t.appliedFilters.length>0;return n.jsxs(tt,{children:[n.jsx(st,{render:n.jsx(V,{icon:Dt,label:"Filter",dot:e?"Some filters applied":void 0,variant:"ghost",disabled:t.allFilters.length===0})}),n.jsx(nt,{children:t.allFilters.map(s=>{const r=t.appliedFilters.includes(s);return n.jsx(rt,{name:s,label:s,checked:r,onChange:()=>{t.toggleFilter(s)}},s)})})]})}function Qe(t){const[e,s]=a.useState(!1),[r,d]=a.useState([]),[l,c]=a.useState(""),[u,f]=a.useState(!1),[i,p]=a.useState(void 0),h=a.useCallback(I=>{const M=r.includes(I)?r.filter(x=>x!==I):[...r,I];d(M),s(M.length>0)},[r]),m=a.useCallback(()=>{d([]),s(!1)},[]),g=a.useCallback(I=>{c(I),s(!!I)},[]);return n.jsx(me.Provider,{value:a.useMemo(()=>({allFilters:t.allFilters,appliedFilters:r,isFiltered:e,toggleFilter:h,clearFilters:m,search:l,setSearch:g,isSearchboxVisible:u,setIsSearchboxVisible:f,itemCount:i,setItemCount:p}),[t.allFilters,r,e,h,m,l,g,u,i]),children:t.children})}const me=a.createContext({allFilters:[],appliedFilters:[],isFiltered:!1,toggleFilter:()=>{},clearFilters:()=>{},search:"",setSearch:()=>{},isSearchboxVisible:!1,setIsSearchboxVisible:()=>{},itemCount:void 0,setItemCount:()=>{}});function Hs(t){return n.jsx("div",{className:S.colorSwatch,style:{"--_color":`var(--_color--${t.color})`},children:t.alt?n.jsx(ne,{children:t.alt}):null})}export{gn as default,vn as meta};
