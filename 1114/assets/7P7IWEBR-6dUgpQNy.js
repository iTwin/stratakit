import{d as ue,g as A,s as ae,i as G,b as Z,e as oe,h as se,a as le}from"./FIT2LC3L-BoBAR9Pt.js";import{ac as ce,a2 as de,y as fe,M as ve,N as me,O as Ie,U as k,S as Se,E as ge,J as Ee}from"./~utils-BTLNz_My.js";import{a as xe,D as ye,aa as Ce,h as Y,ab as T,j as we,u as N,v as D,V as he,A as ee,n as be,e as Pe,ac as Fe,f as ke,b as Ae,S as I,g as _e,N as Le}from"./ILRXHV7V-DJJ8tED0.js";import{a as P,p as Be}from"./chunk-4WY6JWTD-BeTiufY7.js";import{c as Re,e as Te}from"./QHXYX2YB-BCLIgYrI.js";function te(t){const e=[];for(const n of t)e.push(...n);return e}function q(t){return t.slice().reverse()}var De="div";function Ke(t){return t.some(e=>!!e.rowId)}function pe(t){const e=t.target;return e&&!ee(e)?!1:t.key.length===1&&!t.ctrlKey&&!t.metaKey}function Me(t){return t.key==="Shift"||t.key==="Control"||t.key==="Alt"||t.key==="Meta"}function Q(t,e,n){return N(a=>{var s;if(e?.(a),a.defaultPrevented||a.isPropagationStopped()||!D(a)||Me(a)||pe(a))return;const u=t.getState(),o=(s=A(t,u.activeId))==null?void 0:s.element;if(!o)return;const{view:F,...r}=a,S=n?.current;o!==S&&o.focus(),Fe(o,a.type,r)||a.preventDefault(),a.currentTarget.contains(o)&&a.stopPropagation()})}function ze(t){return oe(te(q(se(t))))}function We(t){const[e,n]=P.useState(!1),a=P.useCallback(()=>n(!0),[]),s=t.useState(u=>A(t,u.activeId));return P.useEffect(()=>{const u=s?.element;e&&u&&(n(!1),u.focus({preventScroll:!0}))},[s,e]),a}var Ne=xe(function({store:e,composite:n=!0,focusOnMove:a=n,moveOnKeyPress:s=!0,...u}){const o=ue();e=e||o,ye(e,!1);const F=P.useRef(null),r=P.useRef(null),S=We(e),g=e.useState("moves"),[,H]=Ce(n?e.setBaseElement:null);P.useEffect(()=>{var i;if(!e||!g||!n||!a)return;const{activeId:l}=e.getState(),d=(i=A(e,l))==null?void 0:i.element;d&&ce(d)},[e,g,n,a]),Y(()=>{if(!e||!g||!n)return;const{baseElement:i,activeId:l}=e.getState();if(!(l===null)||!i)return;const f=r.current;r.current=null,f&&T(f,{relatedTarget:i}),de(i)||i.focus()},[e,g,n]);const E=e.useState("activeId"),_=e.useState("virtualFocus");Y(()=>{var i;if(!e||!n||!_)return;const l=r.current;if(r.current=null,!l)return;const f=((i=A(e,E))==null?void 0:i.element)||we(l);f!==l&&T(l,{relatedTarget:f})},[e,E,_,n]);const x=Q(e,u.onKeyDownCapture,r),V=Q(e,u.onKeyUpCapture,r),L=u.onFocusCapture,K=N(i=>{if(L?.(i),i.defaultPrevented||!e)return;const{virtualFocus:l}=e.getState();if(!l)return;const d=i.relatedTarget,f=ae(i.currentTarget);D(i)&&f&&(i.stopPropagation(),r.current=d)}),p=u.onFocus,U=N(i=>{if(p?.(i),i.defaultPrevented||!n||!e)return;const{relatedTarget:l}=i,{virtualFocus:d}=e.getState();d?D(i)&&!G(e,l)&&queueMicrotask(S):D(i)&&e.setActiveId(null)}),M=u.onBlurCapture,y=N(i=>{var l;if(M?.(i),i.defaultPrevented||!e)return;const{virtualFocus:d,activeId:f}=e.getState();if(!d)return;const C=(l=A(e,f))==null?void 0:l.element,h=i.relatedTarget,w=G(e,h),m=r.current;r.current=null,D(i)&&w?(h===C?m&&m!==h&&T(m,i):C?T(C,i):m&&T(m,i),i.stopPropagation()):!G(e,i.target)&&C&&T(C,i)}),z=u.onKeyDown,$=he(s),j=N(i=>{var l;if(z?.(i),i.nativeEvent.isComposing||i.defaultPrevented||!e||!D(i))return;const{orientation:d,renderedItems:f,activeId:C}=e.getState(),h=A(e,C);if((l=h?.element)!=null&&l.isConnected)return;const w=d!=="horizontal",m=d!=="vertical",c=Ke(f);if((i.key==="ArrowLeft"||i.key==="ArrowRight"||i.key==="Home"||i.key==="End")&&ee(i.currentTarget))return;const J={ArrowUp:(c||w)&&(()=>{if(c){const W=ze(f);return W?.id}return e?.last()}),ArrowRight:(c||m)&&e.first,ArrowDown:(c||w)&&e.first,ArrowLeft:(c||m)&&e.last,Home:e.first,End:e.last,PageUp:e.first,PageDown:e.last}[i.key];if(J){const W=J();if(W!==void 0){if(!$(i))return;i.preventDefault(),e.move(W)}}});u=be(u,i=>Be.jsx(Z,{value:e,children:i}),[e]),u={"aria-activedescendant":e.useState(i=>{var l;if(e&&n&&i.virtualFocus)return(l=A(e,i.activeId))==null?void 0:l.id}),...u,ref:Pe(F,H,u.ref),onKeyDownCapture:x,onKeyUpCapture:V,onFocusCapture:K,onFocus:U,onBlurCapture:y,onKeyDown:j};const B=e.useState(i=>n&&(i.virtualFocus||i.activeId===null));return u=fe({focusable:B,...u}),u}),nt=ke(function(e){const n=Ne(e);return Ae(De,n)}),He={id:null};function b(t,e){return t.find(n=>e?!n.disabled&&n.id!==e:!n.disabled)}function Ue(t,e){return t.filter(n=>e?!n.disabled&&n.id!==e:!n.disabled)}function X(t,e){return t.filter(n=>n.rowId===e)}function Ve(t,e,n=!1){const a=t.findIndex(s=>s.id===e);return[...t.slice(a+1),...n?[He]:[],...t.slice(0,a)]}function ne(t){const e=[];for(const n of t){const a=e.find(s=>{var u;return((u=s[0])==null?void 0:u.rowId)===n.rowId});a?a.push(n):e.push([n])}return e}function re(t){let e=0;for(const{length:n}of t)n>e&&(e=n);return e}function $e(t){return{id:"__EMPTY_ITEM__",disabled:!0,rowId:t}}function je(t,e,n){const a=re(t);for(const s of t)for(let u=0;u<a;u+=1){const o=s[u];if(!o||n&&o.disabled){const r=u===0&&n?b(s):s[u-1];s[u]=r&&e!==r.id&&n?r:$e(r?.rowId)}}return t}function Oe(t){const e=ne(t),n=re(e),a=[];for(let s=0;s<n;s+=1)for(const u of e){const o=u[s];o&&a.push({...o,rowId:o.rowId?`${s}`:void 0})}return a}function Ge(t={}){var e;const n=(e=t.store)==null?void 0:e.getState(),a=Re(t),s=I(t.activeId,n?.activeId,t.defaultActiveId),u={...a.getState(),id:I(t.id,n?.id,`id-${Math.random().toString(36).slice(2,8)}`),activeId:s,baseElement:I(n?.baseElement,null),includesBaseElement:I(t.includesBaseElement,n?.includesBaseElement,s===null),moves:I(n?.moves,0),orientation:I(t.orientation,n?.orientation,"both"),rtl:I(t.rtl,n?.rtl,!1),virtualFocus:I(t.virtualFocus,n?.virtualFocus,!1),focusLoop:I(t.focusLoop,n?.focusLoop,!1),focusWrap:I(t.focusWrap,n?.focusWrap,!1),focusShift:I(t.focusShift,n?.focusShift,!1)},o=ve(u,a,t.store);me(o,()=>Ie(o,["renderedItems","activeId"],r=>{o.setState("activeId",S=>{var g;return S!==void 0?S:(g=b(r.renderedItems))==null?void 0:g.id})}));const F=(r="next",S={})=>{var g,H;const E=o.getState(),{skip:_=0,activeId:x=E.activeId,focusShift:V=E.focusShift,focusLoop:L=E.focusLoop,focusWrap:K=E.focusWrap,includesBaseElement:p=E.includesBaseElement,renderedItems:U=E.renderedItems,rtl:M=E.rtl}=S,y=r==="up"||r==="down",z=r==="next"||r==="down",$=z?M&&!y:!M||y,j=V&&!_;let v=y?te(je(ne(U),x,j)):U;if(v=$?q(v):v,v=y?Oe(v):v,x==null)return(g=b(v))==null?void 0:g.id;const B=v.find(c=>c.id===x);if(!B)return(H=b(v))==null?void 0:H.id;const i=v.some(c=>c.rowId),l=v.indexOf(B),d=v.slice(l+1),f=X(d,B.rowId);if(_){const c=Ue(f,x),R=c.slice(_)[0]||c[c.length-1];return R?.id}const C=L&&(y?L!=="horizontal":L!=="vertical"),h=i&&K&&(y?K!=="horizontal":K!=="vertical"),w=z?(!i||y)&&C&&p:y?p:!1;if(C){const c=h&&!w?v:X(v,B.rowId),R=Ve(c,x,w),O=b(R,x);return O?.id}if(h){const c=b(w?f:d,x);return w?c?.id||null:c?.id}const m=b(f,x);return!m&&w?null:m?.id};return{...a,...o,setBaseElement:r=>o.setState("baseElement",r),setActiveId:r=>o.setState("activeId",r),move:r=>{r!==void 0&&(o.setState("activeId",r),o.setState("moves",S=>S+1))},first:()=>{var r;return(r=b(o.getState().renderedItems))==null?void 0:r.id},last:()=>{var r;return(r=b(q(o.getState().renderedItems)))==null?void 0:r.id},next:r=>(r!==void 0&&typeof r=="number"&&(r={skip:r}),F("next",r)),previous:r=>(r!==void 0&&typeof r=="number"&&(r={skip:r}),F("previous",r)),down:r=>(r!==void 0&&typeof r=="number"&&(r={skip:r}),F("down",r)),up:r=>(r!==void 0&&typeof r=="number"&&(r={skip:r}),F("up",r))}}function qe(t){return{id:_e(t.id),...t}}function Je(t,e,n){return t=Te(t,e,n),k(t,n,"activeId","setActiveId"),k(t,n,"includesBaseElement"),k(t,n,"virtualFocus"),k(t,n,"orientation"),k(t,n,"rtl"),k(t,n,"focusLoop"),k(t,n,"focusWrap"),k(t,n,"focusShift"),t}function rt(t={}){t=qe(t);const[e,n]=Se(Ge,t);return Je(e,n,t)}P.createContext(void 0);var ie=Le([Ee,Z],[ge,le]),it=ie.useContext,ut=ie.useProviderContext;P.createContext(void 0);P.createContext(!1);export{nt as C,Ne as a,it as b,Ge as c,Je as d,ut as e,rt as u};
