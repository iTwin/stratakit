import{w as oe,af as _,P as ue,z as ae,B as se,E as le,G as y,aq as fe,aC as D,ae as F,a5 as ce,a3 as K,aD as de,aE as me,Q as ve,I as ge,J as Ie,a2 as be,aF as Ce,x as xe,y as Se,A as we}from"./~utils-RT7JJYWG.js";import{u as Ee}from"./Z2O3VLAQ-CY2X7nLO.js";import{C as he,d as Pe}from"./GVAFFF2B-BIpllCqy.js";import{a as v,p as pe}from"./chunk-JZWAC4HX-ROAaBwzV.js";import{u as Te}from"./PZ3OL7I2-DFzfDdzf.js";import{g as ye}from"./Q5W46E73-BOrXpG8R.js";var x=oe([Pe],[he]),De=x.useContext;x.useScopedContext;var qe=x.useProviderContext,Je=x.ContextProvider,Qe=x.ScopedContextProvider,Fe=v.createContext(void 0),Re=v.createContext(void 0),Ae={id:null};function Xe(n,e,r=!1){const a=n.findIndex(f=>f.id===e);return[...n.slice(a+1),...r?[Ae]:[],...n.slice(0,a)]}function Ze(n,e){return n.find(r=>!r.disabled)}function ke(n,e){return e&&n.item(e)||null}function $e(n){const e=[];for(const r of n){const a=e.find(f=>{var d;return((d=f[0])==null?void 0:d.rowId)===r.rowId});a?a.push(r):e.push([r])}return e}function Le(n,e=!1){if(_(n))n.setSelectionRange(e?n.value.length:0,n.value.length);else if(n.isContentEditable){const r=ue(n).getSelection();r?.selectAllChildren(n),e&&r?.collapseToEnd()}}var R=Symbol("FOCUS_SILENTLY");function Oe(n){n[R]=!0,n.focus({preventScroll:!0})}function et(n){const e=n[R];return delete n[R],e}function V(n,e,r){return!(!e||e===r||!n.item(e.id))}var ze="button";function Be(n){return D(n)?!0:n.tagName==="INPUT"&&!be(n)}function Ne(n,e=!1){const r=n.clientHeight,{top:a}=n.getBoundingClientRect(),f=Math.max(r*.875,r-40)*1.5,d=e?r-f+a:f+a;return n.tagName==="HTML"?d+n.scrollTop:d}function Me(n,e=!1){const{top:r}=n.getBoundingClientRect();return e?r+n.clientHeight:r}function U(n,e,r,a=!1){var f;if(!e||!r)return;const{renderedItems:d}=e.getState(),g=Ce(n);if(!g)return;const S=Ne(g,a);let c,i;for(let I=0;I<d.length;I+=1){const s=c;if(c=r(I),!c)break;if(c===s)continue;const w=(f=ke(e,c))==null?void 0:f.element;if(!w)continue;const E=Me(w,a)-S,b=Math.abs(E);if(a&&E<=0||!a&&E>=0){i!==void 0&&i<b&&(c=s);break}i=b}return c}function He(n,e){return F(n)?!1:V(e,n.target)}var Ke=ae(function({store:e,rowId:r,preventScrollOnKeyDown:a=!1,moveOnKeyPress:f=!0,tabbable:d=!1,getItem:g,"aria-setsize":S,"aria-posinset":c,...i}){const I=De();e=e||I;const s=se(i.id),w=v.useRef(null),l=v.useContext(Re),b=le(i)&&!i.accessibleWhenDisabled,{rowId:P,baseElement:A,isActiveItem:j,ariaSetSize:G,ariaPosInSet:W,isTabbable:Y}=ye(e,{rowId(t){if(r)return r;if(t&&l?.baseElement&&l.baseElement===t.baseElement)return l.id},baseElement(t){return t?.baseElement||void 0},isActiveItem(t){return!!t&&t.activeId===s},ariaSetSize(t){if(S!=null)return S;if(t&&l?.ariaSetSize&&l.baseElement===t.baseElement)return l.ariaSetSize},ariaPosInSet(t){if(c!=null)return c;if(!t||!l?.ariaPosInSet||l.baseElement!==t.baseElement)return;const o=t.renderedItems.filter(u=>u.rowId===P);return l.ariaPosInSet+o.findIndex(u=>u.id===s)},isTabbable(t){if(!t?.renderedItems.length)return!0;if(t.virtualFocus)return!1;if(d)return!0;if(t.activeId===null)return!1;const o=e?.item(t.activeId);return o?.disabled||!o?.element?!0:t.activeId===s}}),q=v.useCallback(t=>{var o;const u={...t,id:s||t.id,rowId:P,disabled:!!b,children:(o=t.element)==null?void 0:o.textContent};return g?g(u):u},[s,P,b,g]),k=i.onFocus,p=v.useRef(!1),J=y(t=>{if(k?.(t),t.defaultPrevented||fe(t)||!s||!e||He(t,e))return;const{virtualFocus:o,baseElement:u}=e.getState();if(e.setActiveId(s),D(t.currentTarget)&&Le(t.currentTarget),!o||!F(t)||Be(t.currentTarget)||!u?.isConnected)return;ce()&&t.currentTarget.hasAttribute("data-autofocus")&&t.currentTarget.scrollIntoView({block:"nearest",inline:"nearest"}),p.current=!0,t.relatedTarget===u||V(e,t.relatedTarget)?Oe(u):u.focus()}),L=i.onBlurCapture,Q=y(t=>{if(L?.(t),t.defaultPrevented)return;const o=e?.getState();o?.virtualFocus&&p.current&&(p.current=!1,t.preventDefault(),t.stopPropagation())}),O=i.onKeyDown,X=K(a),Z=K(f),$=y(t=>{if(O?.(t),t.defaultPrevented||!F(t)||!e)return;const{currentTarget:o}=t,u=e.getState(),T=e.item(s),m=!!T?.rowId,h=u.orientation!=="horizontal",C=u.orientation!=="vertical",B=()=>!!(m||C||!u.baseElement||!_(u.baseElement)),N={ArrowUp:(m||h)&&e.up,ArrowRight:(m||C)&&e.next,ArrowDown:(m||h)&&e.down,ArrowLeft:(m||C)&&e.previous,Home:()=>{if(B())return!m||t.ctrlKey?e?.first():e?.previous(-1)},End:()=>{if(B())return!m||t.ctrlKey?e?.last():e?.next(-1)},PageUp:()=>U(o,e,e?.up,!0),PageDown:()=>U(o,e,e?.down)}[t.key];if(N){if(D(o)){const H=de(o),ee=C&&t.key==="ArrowLeft",te=C&&t.key==="ArrowRight",ne=h&&t.key==="ArrowUp",re=h&&t.key==="ArrowDown";if(te||re){const{length:ie}=me(o);if(H.end!==ie)return}else if((ee||ne)&&H.start!==0)return}const M=N();if(X(t)||M!==void 0){if(!Z(t))return;t.preventDefault(),e.move(M)}}}),z=v.useMemo(()=>({id:s,baseElement:A}),[s,A]);return i=ve(i,t=>pe.jsx(Fe.Provider,{value:z,children:t}),[z]),i={id:s,"data-active-item":j||void 0,...i,ref:ge(w,i.ref),tabIndex:Y?i.tabIndex:-1,onFocus:J,onBlurCapture:Q,onKeyDown:$},i=Te(i),i=Ee({store:e,...i,getItem:q,shouldRegisterItem:s?i.shouldRegisterItem:!1}),Ie({...i,"aria-setsize":G,"aria-posinset":W})}),tt=xe(Se(function(e){const r=Ke(e);return we(ze,r)}));export{Qe as C,Je as a,tt as b,De as c,qe as d,Ze as e,Xe as f,ke as g,$e as h,V as i,et as s,Ke as u};
