import{C as ae,c as le,d as fe}from"./RZ4GPYOB-BmMDqW1J.js";import{u as de}from"./KUU7WJ55-BAorif0v.js";import{l as ce,q as G,D as me,b as pe,y as Ie,f as be,_ as ge,G as Ce,o as xe,g as w,j as v,e as R,u as U,v as Se,h as Pe,x as we,k as ve,J as he,K as O,p as F,L as Ee,M as ye,N as Te,n as De,O as Re}from"./index-DksOGUVp.js";import{r as p,j as Oe}from"./chunk-K6AXKMTT-DG8v5gpF.js";import{e as Fe}from"./YV4JVR4I-CGpFYsWa.js";var h=ce([le],[ae]),Ae=h.useContext,Ze=h.useProviderContext,$e=h.ContextProvider,et=h.ScopedContextProvider,_e=p.createContext(void 0),ke=p.createContext(void 0),Ke={id:null};function tt(n,r,i=!1){const t=n.findIndex(f=>f.id===r);return[...n.slice(t+1),...i?[Ke]:[],...n.slice(0,t)]}function nt(n,r){return n.find(i=>!i.disabled)}function Le(n,r){return r&&n.item(r)||null}function rt(n){const r=[];for(const i of n){const t=r.find(f=>{var c;return((c=f[0])==null?void 0:c.rowId)===i.rowId});t?t.push(i):r.push([i])}return r}function ze(n,r=!1){if(G(n))n.setSelectionRange(r?n.value.length:0,n.value.length);else if(n.isContentEditable){const i=me(n).getSelection();i==null||i.selectAllChildren(n),r&&(i==null||i.collapseToEnd())}}var A=Symbol("FOCUS_SILENTLY");function Ne(n){n[A]=!0,n.focus({preventScroll:!0})}function it(n){const r=n[A];return delete n[A],r}function W(n,r,i){return!(!r||r===i||!n.item(r.id))}var Me="button";function Be(n){return O(n)?!0:n.tagName==="INPUT"&&!De(n)}function He(n,r=!1){const i=n.clientHeight,{top:t}=n.getBoundingClientRect(),f=Math.max(i*.875,i-40)*1.5,c=r?i-f+t:f+t;return n.tagName==="HTML"?c+n.scrollTop:c}function je(n,r=!1){const{top:i}=n.getBoundingClientRect();return r?i+n.clientHeight:i}function V(n,r,i,t=!1){var f;if(!r||!i)return;const{renderedItems:c}=r.getState(),x=Re(n);if(!x)return;const E=He(x,t);let d,I;for(let b=0;b<c.length;b+=1){const o=d;if(d=i(b),!d)break;if(d===o)continue;const S=(f=Le(r,d))==null?void 0:f.element;if(!S)continue;const g=je(S,t)-E,a=Math.abs(g);if(t&&g<=0||!t&&g>=0){I!==void 0&&I<a&&(d=o);break}I=a}return d}function Ue(n,r){return F(n)?!1:W(r,n.target)}var Ve=pe(function(r){var i=r,{store:t,rowId:f,preventScrollOnKeyDown:c=!1,moveOnKeyPress:x=!0,tabbable:E=!1,getItem:d,"aria-setsize":I,"aria-posinset":b}=i,o=ge(i,["store","rowId","preventScrollOnKeyDown","moveOnKeyPress","tabbable","getItem","aria-setsize","aria-posinset"]);const S=Ae();t=t||S;const l=Ce(o.id),g=p.useRef(null),a=p.useContext(ke),_=xe(o)&&!o.accessibleWhenDisabled,{rowId:y,baseElement:k,isActiveItem:Y,ariaSetSize:q,ariaPosInSet:J,isTabbable:Q}=Fe(t,{rowId(e){if(f)return f;if(e&&a!=null&&a.baseElement&&a.baseElement===e.baseElement)return a.id},baseElement(e){return(e==null?void 0:e.baseElement)||void 0},isActiveItem(e){return!!e&&e.activeId===l},ariaSetSize(e){if(I!=null)return I;if(e&&a!=null&&a.ariaSetSize&&a.baseElement===e.baseElement)return a.ariaSetSize},ariaPosInSet(e){if(b!=null)return b;if(!e||!(a!=null&&a.ariaPosInSet)||a.baseElement!==e.baseElement)return;const s=e.renderedItems.filter(u=>u.rowId===y);return a.ariaPosInSet+s.findIndex(u=>u.id===l)},isTabbable(e){if(!(e!=null&&e.renderedItems.length))return!0;if(e.virtualFocus)return!1;if(E)return!0;if(e.activeId===null)return!1;const s=t==null?void 0:t.item(e.activeId);return s!=null&&s.disabled||!(s!=null&&s.element)?!0:e.activeId===l}}),X=p.useCallback(e=>{var s;const u=w(v({},e),{id:l||e.id,rowId:y,disabled:!!_,children:(s=e.element)==null?void 0:s.textContent});return d?d(u):u},[l,y,_,d]),K=o.onFocus,T=p.useRef(!1),Z=R(e=>{if(K==null||K(e),e.defaultPrevented||he(e)||!l||!t||Ue(e,t))return;const{virtualFocus:s,baseElement:u}=t.getState();if(t.setActiveId(l),O(e.currentTarget)&&ze(e.currentTarget),!s||!F(e)||Be(e.currentTarget)||!(u!=null&&u.isConnected))return;Ee()&&e.currentTarget.hasAttribute("data-autofocus")&&e.currentTarget.scrollIntoView({block:"nearest",inline:"nearest"}),T.current=!0,e.relatedTarget===u||W(t,e.relatedTarget)?Ne(u):u.focus()}),L=o.onBlurCapture,$=R(e=>{if(L==null||L(e),e.defaultPrevented)return;const s=t==null?void 0:t.getState();s!=null&&s.virtualFocus&&T.current&&(T.current=!1,e.preventDefault(),e.stopPropagation())}),z=o.onKeyDown,ee=U(c),te=U(x),ne=R(e=>{if(z==null||z(e),e.defaultPrevented||!F(e)||!t)return;const{currentTarget:s}=e,u=t.getState(),D=t.item(l),m=!!(D!=null&&D.rowId),P=u.orientation!=="horizontal",C=u.orientation!=="vertical",M=()=>!!(m||C||!u.baseElement||!G(u.baseElement)),B={ArrowUp:(m||P)&&t.up,ArrowRight:(m||C)&&t.next,ArrowDown:(m||P)&&t.down,ArrowLeft:(m||C)&&t.previous,Home:()=>{if(M())return!m||e.ctrlKey?t==null?void 0:t.first():t==null?void 0:t.previous(-1)},End:()=>{if(M())return!m||e.ctrlKey?t==null?void 0:t.last():t==null?void 0:t.next(-1)},PageUp:()=>V(s,t,t==null?void 0:t.up,!0),PageDown:()=>V(s,t,t==null?void 0:t.down)}[e.key];if(B){if(O(s)){const j=ye(s),re=C&&e.key==="ArrowLeft",ie=C&&e.key==="ArrowRight",oe=P&&e.key==="ArrowUp",se=P&&e.key==="ArrowDown";if(ie||se){const{length:ue}=Te(s);if(j.end!==ue)return}else if((re||oe)&&j.start!==0)return}const H=B();if(ee(e)||H!==void 0){if(!te(e))return;e.preventDefault(),t.move(H)}}}),N=p.useMemo(()=>({id:l,baseElement:k}),[l,k]);return o=Se(o,e=>Oe.jsx(_e.Provider,{value:N,children:e}),[N]),o=w(v({id:l,"data-active-item":Y||void 0},o),{ref:Pe(g,o.ref),tabIndex:Q?o.tabIndex:-1,onFocus:Z,onBlurCapture:$,onKeyDown:ne}),o=de(o),o=fe(w(v({store:t},o),{getItem:X,shouldRegisterItem:l?o.shouldRegisterItem:!1})),we(w(v({},o),{"aria-setsize":q,"aria-posinset":J}))}),ot=Ie(be(function(r){const i=Ve(r);return ve(Me,i)}));export{et as C,$e as a,Ze as b,rt as c,ot as d,Ae as e,nt as f,Le as g,tt as h,W as i,it as s,Ve as u};
