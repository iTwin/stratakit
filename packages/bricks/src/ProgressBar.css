/*---------------------------------------------------------------------------------------------
 * Copyright (c) Bentley Systems, Incorporated. All rights reserved.
 * See LICENSE.md in the project root for license terms and full copyright notice.
 *--------------------------------------------------------------------------------------------*/

.ğŸ¥-progress-bar {
	--âœ¨count: 4;
	--âœ¨duration: 1.5s;
	--âœ¨easing: cubic-bezier(0.5, 0, 0.5, 1);
	--âœ¨steps: 4;

	--âœ¨animation--indeterminate-steps: calc(var(--âœ¨steps) * var(--âœ¨duration))
		--ğŸ¥progress-bar-animation-indeterminate steps(var(--âœ¨steps), end) infinite;
	--âœ¨animation--indeterminate: var(--âœ¨duration) --ğŸ¥progress-bar-animation-indeterminate
		var(--âœ¨easing) var(--âœ¨count);
	--âœ¨animation--indeterminate-slow: calc(var(--âœ¨duration) * 2)
		--ğŸ¥progress-bar-animation-indeterminate-slow var(--âœ¨easing)
		calc(var(--âœ¨count) * var(--âœ¨duration)) infinite;

	@layer base {
		block-size: var(--ğŸ¥progress-bar-size);
		inline-size: 100%;
		border-radius: 9999px;
		contain: strict;
		display: grid;
		background-color: var(--ğŸ¥progress-bar-track-color);

		&::before {
			content: "";
			block-size: inherit;
			inline-size: var(--ğŸ¥progress-bar-fill-size);
			border-radius: inherit;
			background-color: var(--ğŸ¥progress-bar-fill-color);
			animation: var(--ğŸ¥progress-bar-animation);
		}
	}

	@layer modifiers {
		&:where([data-kiwi-tone="neutral"]) {
			--ğŸ¥progress-bar-fill-color: var(--ids-color-icon-neutral-base);
			--ğŸ¥progress-bar-track-color: var(--ids-color-border-page-base);
		}

		&:where([data-kiwi-tone="accent"]) {
			--ğŸ¥progress-bar-fill-color: var(--ids-color-icon-accent-strong);
			--ğŸ¥progress-bar-track-color: var(--ids-color-bg-accent-muted);
		}

		&:where([data-kiwi-size="small"]) {
			--ğŸ¥progress-bar-size: 0.063rem;
		}

		&:where([data-kiwi-size="medium"]) {
			--ğŸ¥progress-bar-size: 0.125rem;
		}

		&:where([data-kiwi-size="large"]) {
			--ğŸ¥progress-bar-size: 0.25rem;
		}

		&:where([data-kiwi-variant="indeterminate"]) {
			--ğŸ¥progress-bar-animation: var(--âœ¨animation--indeterminate-steps);
			--ğŸ¥progress-bar-fill-size: 25%;

			@media (prefers-reduced-motion: no-preference) {
				--ğŸ¥progress-bar-animation: var(--âœ¨animation--indeterminate),
					var(--âœ¨animation--indeterminate-slow);
			}
		}

		@media (forced-colors: active) {
			--ğŸ¥progress-bar-fill-color: CanvasText;
			--ğŸ¥progress-bar-track-color: Canvas;
		}
	}
}

@keyframes --ğŸ¥progress-bar-animation-indeterminate {
	from {
		transform: translateX(-100%); /* -100% moves the fill out of view on the left side. */
	}

	to {
		transform: translateX(400%); /* The fill is 25% width of the container, multiplied by 4 moves the fill out of view on the right side. */
	}
}

@keyframes --ğŸ¥progress-bar-animation-indeterminate-slow {
	0% {
		transform: translateX(-100%); /* -100% moves the fill out of view on the left side. */
	}
	50% {
		transform: translateX(-95%); /* Simulate a short slowdown between each cycle to help with WCAG SC 2.2.2. */
	}
	100% {
		transform: translateX(400%); /* The fill is 25% width of the container, multiplied by 4 moves the fill out of view on the right side. */
	}
}
