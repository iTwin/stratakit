import{x as F,a3 as p,a4 as O,a5 as w,a6 as y,a7 as E}from"./ExamplePreview.BB3q8apm.js";import{t as M,c as _,s as C,i as q,b as h,a as D,d as k}from"./Q5W46E73.DxJvvNJR.js";var S=F(),G=S.useContext,H=S.useProviderContext,J=S.ContextProvider,K=S.ScopedContextProvider;function B(t){var l;const o=t.find(f=>!!f.element),u=[...t].reverse().find(f=>!!f.element);let r=(l=o?.element)==null?void 0:l.parentElement;for(;r&&u?.element;){if(u&&r.contains(u.element))return r;r=r.parentElement}return y(r).body}function R(t){return t?.__unstablePrivateStore}function U(t={}){var l;M(t,t.store);const o=(l=t.store)==null?void 0:l.getState(),u=p(t.items,o?.items,t.defaultItems,[]),r=new Map(u.map(e=>[e.id,e])),f={items:u,renderedItems:p(o?.renderedItems,[])},A=R(t.store),i=_({items:u,renderedItems:f.renderedItems},A),v=_(f,t.store),x=e=>{const n=w(e,c=>c.element);i.setState("renderedItems",n),v.setState("renderedItems",n)};C(v,()=>q(i)),C(i,()=>h(i,["items"],e=>{v.setState("items",e.items)})),C(i,()=>h(i,["renderedItems"],e=>{let n=!0,c=requestAnimationFrame(()=>{const{renderedItems:a}=v.getState();e.renderedItems!==a&&x(e.renderedItems)});if(typeof IntersectionObserver!="function")return()=>cancelAnimationFrame(c);const d=()=>{if(n){n=!1;return}cancelAnimationFrame(c),c=requestAnimationFrame(()=>x(e.renderedItems))},b=B(e.renderedItems),s=new IntersectionObserver(d,{root:b});for(const a of e.renderedItems)a.element&&s.observe(a.element);return()=>{cancelAnimationFrame(c),s.disconnect()}}));const P=(e,n,c=!1)=>{let d;return n(s=>{const a=s.findIndex(({id:m})=>m===e.id),I=s.slice();if(a!==-1){d=s[a];const m={...d,...e};I[a]=m,r.set(e.id,m)}else I.push(e),r.set(e.id,e);return I}),()=>{n(s=>{if(!d)return c&&r.delete(e.id),s.filter(({id:m})=>m!==e.id);const a=s.findIndex(({id:m})=>m===e.id);if(a===-1)return s;const I=s.slice();return I[a]=d,r.set(e.id,d),I})}},g=e=>P(e,n=>i.setState("items",n),!0);return{...v,registerItem:g,renderItem:e=>O(g(e),P(e,n=>i.setState("renderedItems",n))),item:e=>{if(!e)return null;let n=r.get(e);if(!n){const{items:c}=i.getState();n=c.find(d=>d.id===e),n&&r.set(e,n)}return n||null},__unstablePrivateStore:i}}function V(t,l,o){return E(l,[o.store]),k(t,o,"items","setItems"),t}function L(t={}){const[l,o]=D(U,t);return V(l,o,t)}export{K as C,H as a,L as b,J as c,U as d,V as e,G as u};
