import{C as ae,d as le,u as fe}from"./RZ4GPYOB-DhuqW0q0.js";import{u as de}from"./KUU7WJ55-BhebjG0x.js";import{l as ce,v as G,r as me,b as pe,_ as Ie,z as be,G as ge,o as v,d as E,q as R,J as V,A as Ce,B as xe,t as Se,L as Pe,e as we,g as ve,aa as Ee,ab as A,x as F,ac as he,ad as ye,ae as Te,af as De,ag as Re}from"./~utils.ListItem-D8TlN_14.js";import{b as p,p as Ae}from"./index-DSPnbld9.js";import{f as Fe}from"./YV4JVR4I-DrVsdYpu.js";var x=ce([le],[ae]),Oe=x.useContext;x.useScopedContext;var Ze=x.useProviderContext,$e=x.ContextProvider,et=x.ScopedContextProvider,_e=p.createContext(void 0),ke=p.createContext(void 0),ze={id:null};function tt(n,r,i=!1){const t=n.findIndex(f=>f.id===r);return[...n.slice(t+1),...i?[ze]:[],...n.slice(0,t)]}function nt(n,r){return n.find(i=>!i.disabled)}function Le(n,r){return r&&n.item(r)||null}function rt(n){const r=[];for(const i of n){const t=r.find(f=>{var c;return((c=f[0])==null?void 0:c.rowId)===i.rowId});t?t.push(i):r.push([i])}return r}function Ke(n,r=!1){if(G(n))n.setSelectionRange(r?n.value.length:0,n.value.length);else if(n.isContentEditable){const i=me(n).getSelection();i==null||i.selectAllChildren(n),r&&(i==null||i.collapseToEnd())}}var O=Symbol("FOCUS_SILENTLY");function Be(n){n[O]=!0,n.focus({preventScroll:!0})}function it(n){const r=n[O];return delete n[O],r}function W(n,r,i){return!(!r||r===i||!n.item(r.id))}var Ne="button";function Me(n){return A(n)?!0:n.tagName==="INPUT"&&!De(n)}function He(n,r=!1){const i=n.clientHeight,{top:t}=n.getBoundingClientRect(),f=Math.max(i*.875,i-40)*1.5,c=r?i-f+t:f+t;return n.tagName==="HTML"?c+n.scrollTop:c}function Ue(n,r=!1){const{top:i}=n.getBoundingClientRect();return r?i+n.clientHeight:i}function j(n,r,i,t=!1){var f;if(!r||!i)return;const{renderedItems:c}=r.getState(),S=Re(n);if(!S)return;const h=He(S,t);let d,I;for(let b=0;b<c.length;b+=1){const o=d;if(d=i(b),!d)break;if(d===o)continue;const P=(f=Le(r,d))==null?void 0:f.element;if(!P)continue;const g=Ue(P,t)-h,a=Math.abs(g);if(t&&g<=0||!t&&g>=0){I!==void 0&&I<a&&(d=o);break}I=a}return d}function Ve(n,r){return F(n)?!1:W(r,n.target)}var je=pe(function(r){var i=r,{store:t,rowId:f,preventScrollOnKeyDown:c=!1,moveOnKeyPress:S=!0,tabbable:h=!1,getItem:d,"aria-setsize":I,"aria-posinset":b}=i,o=Ie(i,["store","rowId","preventScrollOnKeyDown","moveOnKeyPress","tabbable","getItem","aria-setsize","aria-posinset"]);const P=Oe();t=t||P;const l=be(o.id),g=p.useRef(null),a=p.useContext(ke),_=ge(o)&&!o.accessibleWhenDisabled,{rowId:y,baseElement:k,isActiveItem:Y,ariaSetSize:q,ariaPosInSet:J,isTabbable:Q}=Fe(t,{rowId(e){if(f)return f;if(e&&a!=null&&a.baseElement&&a.baseElement===e.baseElement)return a.id},baseElement(e){return(e==null?void 0:e.baseElement)||void 0},isActiveItem(e){return!!e&&e.activeId===l},ariaSetSize(e){if(I!=null)return I;if(e&&a!=null&&a.ariaSetSize&&a.baseElement===e.baseElement)return a.ariaSetSize},ariaPosInSet(e){if(b!=null)return b;if(!e||!(a!=null&&a.ariaPosInSet)||a.baseElement!==e.baseElement)return;const s=e.renderedItems.filter(u=>u.rowId===y);return a.ariaPosInSet+s.findIndex(u=>u.id===l)},isTabbable(e){if(!(e!=null&&e.renderedItems.length))return!0;if(e.virtualFocus)return!1;if(h)return!0;if(e.activeId===null)return!1;const s=t==null?void 0:t.item(e.activeId);return s!=null&&s.disabled||!(s!=null&&s.element)?!0:e.activeId===l}}),X=p.useCallback(e=>{var s;const u=v(E({},e),{id:l||e.id,rowId:y,disabled:!!_,children:(s=e.element)==null?void 0:s.textContent});return d?d(u):u},[l,y,_,d]),z=o.onFocus,T=p.useRef(!1),Z=R(e=>{if(z==null||z(e),e.defaultPrevented||Ee(e)||!l||!t||Ve(e,t))return;const{virtualFocus:s,baseElement:u}=t.getState();if(t.setActiveId(l),A(e.currentTarget)&&Ke(e.currentTarget),!s||!F(e)||Me(e.currentTarget)||!(u!=null&&u.isConnected))return;he()&&e.currentTarget.hasAttribute("data-autofocus")&&e.currentTarget.scrollIntoView({block:"nearest",inline:"nearest"}),T.current=!0,e.relatedTarget===u||W(t,e.relatedTarget)?Be(u):u.focus()}),L=o.onBlurCapture,$=R(e=>{if(L==null||L(e),e.defaultPrevented)return;const s=t==null?void 0:t.getState();s!=null&&s.virtualFocus&&T.current&&(T.current=!1,e.preventDefault(),e.stopPropagation())}),K=o.onKeyDown,ee=V(c),te=V(S),ne=R(e=>{if(K==null||K(e),e.defaultPrevented||!F(e)||!t)return;const{currentTarget:s}=e,u=t.getState(),D=t.item(l),m=!!(D!=null&&D.rowId),w=u.orientation!=="horizontal",C=u.orientation!=="vertical",N=()=>!!(m||C||!u.baseElement||!G(u.baseElement)),M={ArrowUp:(m||w)&&t.up,ArrowRight:(m||C)&&t.next,ArrowDown:(m||w)&&t.down,ArrowLeft:(m||C)&&t.previous,Home:()=>{if(N())return!m||e.ctrlKey?t==null?void 0:t.first():t==null?void 0:t.previous(-1)},End:()=>{if(N())return!m||e.ctrlKey?t==null?void 0:t.last():t==null?void 0:t.next(-1)},PageUp:()=>j(s,t,t==null?void 0:t.up,!0),PageDown:()=>j(s,t,t==null?void 0:t.down)}[e.key];if(M){if(A(s)){const U=ye(s),re=C&&e.key==="ArrowLeft",ie=C&&e.key==="ArrowRight",oe=w&&e.key==="ArrowUp",se=w&&e.key==="ArrowDown";if(ie||se){const{length:ue}=Te(s);if(U.end!==ue)return}else if((re||oe)&&U.start!==0)return}const H=M();if(ee(e)||H!==void 0){if(!te(e))return;e.preventDefault(),t.move(H)}}}),B=p.useMemo(()=>({id:l,baseElement:k}),[l,k]);return o=Ce(o,e=>Ae.jsx(_e.Provider,{value:B,children:e}),[B]),o=v(E({id:l,"data-active-item":Y||void 0},o),{ref:xe(g,o.ref),tabIndex:Q?o.tabIndex:-1,onFocus:Z,onBlurCapture:$,onKeyDown:ne}),o=de(o),o=fe(v(E({store:t},o),{getItem:X,shouldRegisterItem:l?o.shouldRegisterItem:!1})),Se(v(E({},o),{"aria-setsize":q,"aria-posinset":J}))}),ot=Pe(we(function(r){const i=je(r);return ve(Ne,i)}));export{et as C,$e as a,je as b,ot as c,Ze as d,nt as e,tt as f,Le as g,rt as h,W as i,it as s,Oe as u};
