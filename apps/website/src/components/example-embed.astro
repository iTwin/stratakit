---
// This simply registers the `<example-embed>` element, which renders a React component.
---

<script>
	import { createElement } from "react";
	import { createRoot } from "react-dom/client";
	import { ExampleEmbed } from "./ExamplePreview.tsx";

	customElements.define(
		"example-embed",
		class extends HTMLElement {
			#root: ReturnType<typeof createRoot> | null = null;

			connectedCallback() {
				const src = this.dataset.src;
				if (!src) return;

				const root = createRoot(this);
				root.render(createElement(ExampleEmbed, { src }));
				this.#root = root;
			}

			disconnectedCallback() {
				this.#root?.unmount();
			}
		},
	);
</script>

<style is:global>
	@layer page {
		example-embed {
			display: block;

			&,
			> * {
				min-block-size: 125px; /* Reduce layout shift */
			}

			border-radius: 8px;
			outline: 1px solid var(--stratakit-color-border-neutral-muted);
			background-color: var(--stratakit-color-bg-page-base);
		}
	}
</style>
