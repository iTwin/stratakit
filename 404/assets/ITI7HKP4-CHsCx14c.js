import{c as ce,a as le}from"./C3IKGW5T-CJtGBc2Y.js";import{c as de,s as fe,a as me,d as ve,e as F}from"./YV4JVR4I-jdyf4nx_.js";import{p as x,o as Y,q as N,u as Ie,b as J,e as pe,f as Se,c as ge,_ as ne,v as Ee,R as xe,S as Z,T as A,U as ye,j as W,A as Ce,x as we,k as Pe,l as be,d as he,G as R,V as Fe,F as re}from"./LMDWO4NN-G2tlRUli.js";import{C as _e,a as se,d as ke,g as _,s as Ae,i as q,e as Re,h as Ke}from"./P2CTZE2T-C_Eisgu2.js";import{P as Le,a as Te}from"./MTZPJQMC-DX0XKTxx.js";import{a as h,n as Be}from"./chunk-K6AXKMTT-B_QCnNdX.js";import{f as De,a as Me,u as ze}from"./LVA2YJMS-DW71ZDOL.js";function ue(e){const u=[];for(const n of e)u.push(...n);return u}function Q(e){return e.slice().reverse()}var We={id:null};function b(e,u){return e.find(n=>u?!n.disabled&&n.id!==u:!n.disabled)}function Oe(e,u){return e.filter(n=>u?!n.disabled&&n.id!==u:!n.disabled)}function ee(e,u){return e.filter(n=>n.rowId===u)}function Ve(e,u,n=!1){const t=e.findIndex(o=>o.id===u);return[...e.slice(t+1),...n?[We]:[],...e.slice(0,t)]}function oe(e){const u=[];for(const n of e){const t=u.find(o=>{var c;return((c=o[0])==null?void 0:c.rowId)===n.rowId});t?t.push(n):u.push([n])}return u}function ie(e){let u=0;for(const{length:n}of e)n>u&&(u=n);return u}function He(e){return{id:"__EMPTY_ITEM__",disabled:!0,rowId:e}}function Ue(e,u,n){const t=ie(e);for(const o of e)for(let c=0;c<t;c+=1){const i=o[c];if(!i||n&&i.disabled){const s=c===0&&n?b(o):o[c-1];o[c]=s&&u!==s.id&&n?s:He(s==null?void 0:s.rowId)}}return e}function $e(e){const u=oe(e),n=ie(u),t=[];for(let o=0;o<n;o+=1)for(const c of u){const i=c[o];i&&t.push(Y(N({},i),{rowId:i.rowId?`${o}`:void 0}))}return t}function Ne(e={}){var u;const n=(u=e.store)==null?void 0:u.getState(),t=ce(e),o=x(e.activeId,n==null?void 0:n.activeId,e.defaultActiveId),c=Y(N({},t.getState()),{id:x(e.id,n==null?void 0:n.id,`id-${Math.random().toString(36).slice(2,8)}`),activeId:o,baseElement:x(n==null?void 0:n.baseElement,null),includesBaseElement:x(e.includesBaseElement,n==null?void 0:n.includesBaseElement,o===null),moves:x(n==null?void 0:n.moves,0),orientation:x(e.orientation,n==null?void 0:n.orientation,"both"),rtl:x(e.rtl,n==null?void 0:n.rtl,!1),virtualFocus:x(e.virtualFocus,n==null?void 0:n.virtualFocus,!1),focusLoop:x(e.focusLoop,n==null?void 0:n.focusLoop,!1),focusWrap:x(e.focusWrap,n==null?void 0:n.focusWrap,!1),focusShift:x(e.focusShift,n==null?void 0:n.focusShift,!1)}),i=de(c,t,e.store);fe(i,()=>me(i,["renderedItems","activeId"],s=>{i.setState("activeId",y=>{var v;return y!==void 0?y:(v=b(s.renderedItems))==null?void 0:v.id})}));const l=(s="next",y={})=>{var v,O;const g=i.getState(),{skip:K=0,activeId:E=g.activeId,focusShift:V=g.focusShift,focusLoop:L=g.focusLoop,focusWrap:T=g.focusWrap,includesBaseElement:B=g.includesBaseElement,renderedItems:H=g.renderedItems,rtl:D=g.rtl}=y,C=s==="up"||s==="down",M=s==="next"||s==="down",j=M?D&&!C:!D||C,U=V&&!K;let f=C?ue(Ue(oe(H),E,U)):H;if(f=j?Q(f):f,f=C?$e(f):f,E==null)return(v=b(f))==null?void 0:v.id;const k=f.find(d=>d.id===E);if(!k)return(O=b(f))==null?void 0:O.id;const $=f.some(d=>d.rowId),G=f.indexOf(k),r=f.slice(G+1),a=ee(r,k.rowId);if(K){const d=Oe(a,E),p=d.slice(K)[0]||d[d.length-1];return p==null?void 0:p.id}const m=L&&(C?L!=="horizontal":L!=="vertical"),I=$&&T&&(C?T!=="horizontal":T!=="vertical"),S=M?(!$||C)&&m&&B:C?B:!1;if(m){const d=I&&!S?f:ee(f,k.rowId),p=Ve(d,E,S),P=b(p,E);return P==null?void 0:P.id}if(I){const d=b(S?a:r,E);return S?(d==null?void 0:d.id)||null:d==null?void 0:d.id}const w=b(a,E);return!w&&S?null:w==null?void 0:w.id};return Y(N(N({},t),i),{setBaseElement:s=>i.setState("baseElement",s),setActiveId:s=>i.setState("activeId",s),move:s=>{s!==void 0&&(i.setState("activeId",s),i.setState("moves",y=>y+1))},first:()=>{var s;return(s=b(i.getState().renderedItems))==null?void 0:s.id},last:()=>{var s;return(s=b(Q(i.getState().renderedItems)))==null?void 0:s.id},next:s=>(s!==void 0&&typeof s=="number"&&(s={skip:s}),l("next",s)),previous:s=>(s!==void 0&&typeof s=="number"&&(s={skip:s}),l("previous",s)),down:s=>(s!==void 0&&typeof s=="number"&&(s={skip:s}),l("down",s)),up:s=>(s!==void 0&&typeof s=="number"&&(s={skip:s}),l("up",s))})}function je(e){const u=Ie(e.id);return J({id:u},e)}function Ge(e,u,n){return e=le(e,u,n),F(e,n,"activeId","setActiveId"),F(e,n,"includesBaseElement"),F(e,n,"virtualFocus"),F(e,n,"orientation"),F(e,n,"rtl"),F(e,n,"focusLoop"),F(e,n,"focusWrap"),F(e,n,"focusShift"),e}function dt(e={}){e=je(e);const[u,n]=ve(Ne,e);return Ge(u,n,e)}h.createContext(void 0);var ae=pe([Te,se],[Le,_e]),ft=ae.useContext,mt=ae.useProviderContext;h.createContext(void 0);h.createContext(!1);var qe="div";function Ye(e){return e.some(u=>!!u.rowId)}function Je(e){const u=e.target;return u&&!re(u)?!1:e.key.length===1&&!e.ctrlKey&&!e.metaKey}function Qe(e){return e.key==="Shift"||e.key==="Control"||e.key==="Alt"||e.key==="Meta"}function te(e,u,n){return W(t=>{var o;if(u==null||u(t),t.defaultPrevented||t.isPropagationStopped()||!R(t)||Qe(t)||Je(t))return;const c=e.getState(),i=(o=_(e,c.activeId))==null?void 0:o.element;if(!i)return;const l=t,s=ne(l,["view"]),y=n==null?void 0:n.current;i!==y&&i.focus(),Fe(i,t.type,s)||t.preventDefault(),t.currentTarget.contains(i)&&t.stopPropagation()})}function Xe(e){return Re(ue(Q(Ke(e))))}function Ze(e){const[u,n]=h.useState(!1),t=h.useCallback(()=>n(!0),[]),o=e.useState(c=>_(e,c.activeId));return h.useEffect(()=>{const c=o==null?void 0:o.element;u&&c&&(n(!1),c.focus({preventScroll:!0}))},[o,u]),t}var et=ge(function(u){var n=u,{store:t,composite:o=!0,focusOnMove:c=o,moveOnKeyPress:i=!0}=n,l=ne(n,["store","composite","focusOnMove","moveOnKeyPress"]);const s=ke();t=t||s,Ee(t,!1);const y=h.useRef(null),v=h.useRef(null),O=Ze(t),g=t.useState("moves"),[,K]=xe(o?t.setBaseElement:null);h.useEffect(()=>{var r;if(!t||!g||!o||!c)return;const{activeId:a}=t.getState(),m=(r=_(t,a))==null?void 0:r.element;m&&De(m)},[t,g,o,c]),Z(()=>{if(!t||!g||!o)return;const{baseElement:r,activeId:a}=t.getState();if(!(a===null)||!r)return;const I=v.current;v.current=null,I&&A(I,{relatedTarget:r}),Me(r)||r.focus()},[t,g,o]);const E=t.useState("activeId"),V=t.useState("virtualFocus");Z(()=>{var r;if(!t||!o||!V)return;const a=v.current;if(v.current=null,!a)return;const I=((r=_(t,E))==null?void 0:r.element)||ye(a);I!==a&&A(a,{relatedTarget:I})},[t,E,V,o]);const L=te(t,l.onKeyDownCapture,v),T=te(t,l.onKeyUpCapture,v),B=l.onFocusCapture,H=W(r=>{if(B==null||B(r),r.defaultPrevented||!t)return;const{virtualFocus:a}=t.getState();if(!a)return;const m=r.relatedTarget,I=Ae(r.currentTarget);R(r)&&I&&(r.stopPropagation(),v.current=m)}),D=l.onFocus,C=W(r=>{if(D==null||D(r),r.defaultPrevented||!o||!t)return;const{relatedTarget:a}=r,{virtualFocus:m}=t.getState();m?R(r)&&!q(t,a)&&queueMicrotask(O):R(r)&&t.setActiveId(null)}),M=l.onBlurCapture,j=W(r=>{var a;if(M==null||M(r),r.defaultPrevented||!t)return;const{virtualFocus:m,activeId:I}=t.getState();if(!m)return;const S=(a=_(t,I))==null?void 0:a.element,w=r.relatedTarget,d=q(t,w),p=v.current;v.current=null,R(r)&&d?(w===S?p&&p!==w&&A(p,r):S?A(S,r):p&&A(p,r),r.stopPropagation()):!q(t,r.target)&&S&&A(S,r)}),U=l.onKeyDown,f=Ce(i),k=W(r=>{var a;if(U==null||U(r),r.defaultPrevented||!t||!R(r))return;const{orientation:m,renderedItems:I,activeId:S}=t.getState(),w=_(t,S);if((a=w==null?void 0:w.element)!=null&&a.isConnected)return;const d=m!=="horizontal",p=m!=="vertical",P=Ye(I);if((r.key==="ArrowLeft"||r.key==="ArrowRight"||r.key==="Home"||r.key==="End")&&re(r.currentTarget))return;const X={ArrowUp:(P||d)&&(()=>{if(P){const z=Xe(I);return z==null?void 0:z.id}return t==null?void 0:t.last()}),ArrowRight:(P||p)&&t.first,ArrowDown:(P||d)&&t.first,ArrowLeft:(P||p)&&t.last,Home:t.first,End:t.last,PageUp:t.first,PageDown:t.last}[r.key];if(X){const z=X();if(z!==void 0){if(!f(r))return;r.preventDefault(),t.move(z)}}});l=we(l,r=>Be.jsx(se,{value:t,children:r}),[t]);const $=t.useState(r=>{var a;if(t&&o&&r.virtualFocus)return(a=_(t,r.activeId))==null?void 0:a.id});l=Pe(J({"aria-activedescendant":$},l),{ref:be(y,K,l.ref),onKeyDownCapture:L,onKeyUpCapture:T,onFocusCapture:H,onFocus:C,onBlurCapture:j,onKeyDown:k});const G=t.useState(r=>o&&(r.virtualFocus||r.activeId===null));return l=ze(J({focusable:G},l)),l}),vt=Se(function(u){const n=et(u);return he(qe,n)});export{vt as C,Ge as a,et as b,Ne as c,dt as d,mt as e,ft as u};
