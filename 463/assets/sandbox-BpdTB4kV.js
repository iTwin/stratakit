var Ie=t=>{throw TypeError(t)};var fe=(t,e,s)=>e.has(t)||Ie("Cannot "+s);var i=(t,e,s)=>(fe(t,e,"read from private field"),s?s.call(t):e.get(t)),F=(t,e,s)=>e.has(t)?Ie("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,s),y=(t,e,s,r)=>(fe(t,e,"write to private field"),r?r.call(t,s):e.set(t,s),s),_=(t,e,s)=>(fe(t,e,"access private method"),s);import{w as He,I as ee,V as Z,b as ae,B as We,c as $e,d as Ke}from"./~utils-BbxD5x1h.js";import{b as o,w as Xe,p as n,n as _e}from"./index-DDCMeoDP.js";import{D as Ge,a as Je,b as Ye,c as Ze}from"./DropdownMenu-CRyBcXN7.js";import{F as et,a as tt,b as st}from"./Field-BY6rKexF.js";import{S as nt,H as rt}from"./Select-DeqLnAkh.js";import{S as oe}from"./Skeleton-DGay7ue7.js";import{T as it,a as at,b as ot,c as lt}from"./Tabs-CTwifFcu.js";import{T as ce}from"./Text-CwIO2_mW.js";import{T as ct,a as ut,b as ht}from"./TextBox-Bj8AnBiw.js";import{T as dt,a as ft,b as E}from"./Tree-33bO9r7M.js";import{S as pt,l as we,q,t as pe,r as ie,b as mt,u as me,v as Te,w as bt,g as vt,x as xt,y as Fe,n as Le,z as gt}from"./QueryClientProvider-BZJipc45.js";import{p as te}from"./placeholder-UZ_lwBqM.js";import{p as St,l as jt,h as Ct,s as Me,d as yt,f as Rt}from"./visibility-hide-CfHiFT8G.js";import{s as It}from"./visibility-show-CsRoR_5s.js";import"./Kbd-BbPhpmgr.js";import"./VEVQD5MH-DlUda5FI.js";import"./C3IKGW5T-B8Npka92.js";import"./P4IRICAX-qnjDtvKV.js";import"./ASMQKSDT-D40F-D_j.js";var O,m,ne,z,W,X,Q,L,re,G,J,$,K,V,Y,g,se,be,ve,xe,ge,Se,je,Ce,qe,Ne,_t=(Ne=class extends pt{constructor(e,s){super();F(this,g);F(this,O);F(this,m);F(this,ne);F(this,z);F(this,W);F(this,X);F(this,Q);F(this,L);F(this,re);F(this,G);F(this,J);F(this,$);F(this,K);F(this,V);F(this,Y,new Set);this.options=s,y(this,O,e),y(this,L,null),y(this,Q,we()),this.options.experimental_prefetchInRender||i(this,Q).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(s)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(i(this,m).addObserver(this),ke(i(this,m),this.options)?_(this,g,se).call(this):this.updateResult(),_(this,g,ge).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return ye(i(this,m),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return ye(i(this,m),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,_(this,g,Se).call(this),_(this,g,je).call(this),i(this,m).removeObserver(this)}setOptions(e,s){const r=this.options,f=i(this,m);if(this.options=i(this,O).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof q(this.options.enabled,i(this,m))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");_(this,g,Ce).call(this),i(this,m).setOptions(this.options),r._defaulted&&!pe(this.options,r)&&i(this,O).getQueryCache().notify({type:"observerOptionsUpdated",query:i(this,m),observer:this});const l=this.hasListeners();l&&Pe(i(this,m),f,this.options,r)&&_(this,g,se).call(this),this.updateResult(s),l&&(i(this,m)!==f||q(this.options.enabled,i(this,m))!==q(r.enabled,i(this,m))||ie(this.options.staleTime,i(this,m))!==ie(r.staleTime,i(this,m)))&&_(this,g,be).call(this);const a=_(this,g,ve).call(this);l&&(i(this,m)!==f||q(this.options.enabled,i(this,m))!==q(r.enabled,i(this,m))||a!==i(this,V))&&_(this,g,xe).call(this,a)}getOptimisticResult(e){const s=i(this,O).getQueryCache().build(i(this,O),e),r=this.createResult(s,e);return Tt(this,r)&&(y(this,z,r),y(this,X,this.options),y(this,W,i(this,m).state)),r}getCurrentResult(){return i(this,z)}trackResult(e,s){const r={};return Object.keys(e).forEach(f=>{Object.defineProperty(r,f,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(f),s==null||s(f),e[f])})}),r}trackProp(e){i(this,Y).add(e)}getCurrentQuery(){return i(this,m)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const s=i(this,O).defaultQueryOptions(e),r=i(this,O).getQueryCache().build(i(this,O),s);return r.fetch().then(()=>this.createResult(r,s))}fetch(e){return _(this,g,se).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),i(this,z)))}createResult(e,s){var H;const r=i(this,m),f=this.options,l=i(this,z),a=i(this,W),c=i(this,X),u=e!==r?e.state:i(this,ne),{state:p}=e;let h={...p},b=!1,S;if(s._optimisticResults){const w=this.hasListeners(),B=!w&&ke(e,s),C=w&&Pe(e,r,s,f);(B||C)&&(h={...h,...xt(p.data,e.options)}),s._optimisticResults==="isRestoring"&&(h.fetchStatus="idle")}let{error:R,errorUpdatedAt:M,status:v}=h;if(s.select&&h.data!==void 0)if(l&&h.data===(a==null?void 0:a.data)&&s.select===i(this,re))S=i(this,G);else try{y(this,re,s.select),S=s.select(h.data),S=Fe(l==null?void 0:l.data,S,s),y(this,G,S),y(this,L,null)}catch(w){y(this,L,w)}else S=h.data;if(s.placeholderData!==void 0&&S===void 0&&v==="pending"){let w;if(l!=null&&l.isPlaceholderData&&s.placeholderData===(c==null?void 0:c.placeholderData))w=l.data;else if(w=typeof s.placeholderData=="function"?s.placeholderData((H=i(this,J))==null?void 0:H.state.data,i(this,J)):s.placeholderData,s.select&&w!==void 0)try{w=s.select(w),y(this,L,null)}catch(B){y(this,L,B)}w!==void 0&&(v="success",S=Fe(l==null?void 0:l.data,w,s),b=!0)}i(this,L)&&(R=i(this,L),S=i(this,G),M=Date.now(),v="error");const k=h.fetchStatus==="fetching",P=v==="pending",N=v==="error",A=P&&k,x=S!==void 0,T={status:v,fetchStatus:h.fetchStatus,isPending:P,isSuccess:v==="success",isError:N,isInitialLoading:A,isLoading:A,data:S,dataUpdatedAt:h.dataUpdatedAt,error:R,errorUpdatedAt:M,failureCount:h.fetchFailureCount,failureReason:h.fetchFailureReason,errorUpdateCount:h.errorUpdateCount,isFetched:h.dataUpdateCount>0||h.errorUpdateCount>0,isFetchedAfterMount:h.dataUpdateCount>u.dataUpdateCount||h.errorUpdateCount>u.errorUpdateCount,isFetching:k,isRefetching:k&&!P,isLoadingError:N&&!x,isPaused:h.fetchStatus==="paused",isPlaceholderData:b,isRefetchError:N&&x,isStale:Re(e,s),refetch:this.refetch,promise:i(this,Q)};if(this.options.experimental_prefetchInRender){const w=I=>{T.status==="error"?I.reject(T.error):T.data!==void 0&&I.resolve(T.data)},B=()=>{const I=y(this,Q,T.promise=we());w(I)},C=i(this,Q);switch(C.status){case"pending":e.queryHash===r.queryHash&&w(C);break;case"fulfilled":(T.status==="error"||T.data!==C.value)&&B();break;case"rejected":(T.status!=="error"||T.error!==C.reason)&&B();break}}return T}updateResult(e){const s=i(this,z),r=this.createResult(i(this,m),this.options);if(y(this,W,i(this,m).state),y(this,X,this.options),i(this,W).data!==void 0&&y(this,J,i(this,m)),pe(r,s))return;y(this,z,r);const f={},l=()=>{if(!s)return!0;const{notifyOnChangeProps:a}=this.options,c=typeof a=="function"?a():a;if(c==="all"||!c&&!i(this,Y).size)return!0;const d=new Set(c??i(this,Y));return this.options.throwOnError&&d.add("error"),Object.keys(i(this,z)).some(u=>{const p=u;return i(this,z)[p]!==s[p]&&d.has(p)})};(e==null?void 0:e.listeners)!==!1&&l()&&(f.listeners=!0),_(this,g,qe).call(this,{...f,...e})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&_(this,g,ge).call(this)}},O=new WeakMap,m=new WeakMap,ne=new WeakMap,z=new WeakMap,W=new WeakMap,X=new WeakMap,Q=new WeakMap,L=new WeakMap,re=new WeakMap,G=new WeakMap,J=new WeakMap,$=new WeakMap,K=new WeakMap,V=new WeakMap,Y=new WeakMap,g=new WeakSet,se=function(e){_(this,g,Ce).call(this);let s=i(this,m).fetch(this.options,e);return e!=null&&e.throwOnError||(s=s.catch(mt)),s},be=function(){_(this,g,Se).call(this);const e=ie(this.options.staleTime,i(this,m));if(me||i(this,z).isStale||!Te(e))return;const r=bt(i(this,z).dataUpdatedAt,e)+1;y(this,$,setTimeout(()=>{i(this,z).isStale||this.updateResult()},r))},ve=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(i(this,m)):this.options.refetchInterval)??!1},xe=function(e){_(this,g,je).call(this),y(this,V,e),!(me||q(this.options.enabled,i(this,m))===!1||!Te(i(this,V))||i(this,V)===0)&&y(this,K,setInterval(()=>{(this.options.refetchIntervalInBackground||vt.isFocused())&&_(this,g,se).call(this)},i(this,V)))},ge=function(){_(this,g,be).call(this),_(this,g,xe).call(this,_(this,g,ve).call(this))},Se=function(){i(this,$)&&(clearTimeout(i(this,$)),y(this,$,void 0))},je=function(){i(this,K)&&(clearInterval(i(this,K)),y(this,K,void 0))},Ce=function(){const e=i(this,O).getQueryCache().build(i(this,O),this.options);if(e===i(this,m))return;const s=i(this,m);y(this,m,e),y(this,ne,e.state),this.hasListeners()&&(s==null||s.removeObserver(this),e.addObserver(this))},qe=function(e){Le.batch(()=>{e.listeners&&this.listeners.forEach(s=>{s(i(this,z))}),i(this,O).getQueryCache().notify({query:i(this,m),type:"observerResultsUpdated"})})},Ne);function wt(t,e){return q(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function ke(t,e){return wt(t,e)||t.state.data!==void 0&&ye(t,e,e.refetchOnMount)}function ye(t,e,s){if(q(e.enabled,t)!==!1){const r=typeof s=="function"?s(t):s;return r==="always"||r!==!1&&Re(t,e)}return!1}function Pe(t,e,s,r){return(t!==e||q(r.enabled,t)===!1)&&(!s.suspense||t.state.status!=="error")&&Re(t,s)}function Re(t,e){return q(e.enabled,t)!==!1&&t.isStaleByTime(ie(e.staleTime,t))}function Tt(t,e){return!pe(t.getCurrentResult(),e)}var Be=o.createContext(!1),Ft=()=>o.useContext(Be);Be.Provider;function Mt(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var kt=o.createContext(Mt()),Pt=()=>o.useContext(kt);function zt(t,e){return typeof t=="function"?t(...e):!!t}function ze(){}var Et=(t,e)=>{(t.suspense||t.throwOnError||t.experimental_prefetchInRender)&&(e.isReset()||(t.retryOnMount=!1))},Ot=t=>{o.useEffect(()=>{t.clearReset()},[t])},Dt=({result:t,errorResetBoundary:e,throwOnError:s,query:r,suspense:f})=>t.isError&&!e.isReset()&&!t.isFetching&&r&&(f&&t.data===void 0||zt(s,[t.error,r])),Nt=t=>{const e=t.staleTime;t.suspense&&(t.staleTime=typeof e=="function"?(...s)=>Math.max(e(...s),1e3):Math.max(e??1e3,1e3),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3)))},Lt=(t,e)=>t.isLoading&&t.isFetching&&!e,qt=(t,e)=>(t==null?void 0:t.suspense)&&e.isPending,Ee=(t,e,s)=>e.fetchOptimistic(t).catch(()=>{s.clearReset()});function Bt(t,e,s){var h,b,S,R,M;const r=gt(),f=Ft(),l=Pt(),a=r.defaultQueryOptions(t);(b=(h=r.getDefaultOptions().queries)==null?void 0:h._experimental_beforeQuery)==null||b.call(h,a),a._optimisticResults=f?"isRestoring":"optimistic",Nt(a),Et(a,l),Ot(l);const c=!r.getQueryCache().get(a.queryHash),[d]=o.useState(()=>new e(r,a)),u=d.getOptimisticResult(a),p=!f&&t.subscribed!==!1;if(o.useSyncExternalStore(o.useCallback(v=>{const k=p?d.subscribe(Le.batchCalls(v)):ze;return d.updateResult(),k},[d,p]),()=>d.getCurrentResult(),()=>d.getCurrentResult()),o.useEffect(()=>{d.setOptions(a,{listeners:!1})},[a,d]),qt(a,u))throw Ee(a,d,l);if(Dt({result:u,errorResetBoundary:l,throwOnError:a.throwOnError,query:r.getQueryCache().get(a.queryHash),suspense:a.suspense}))throw u.error;if((R=(S=r.getDefaultOptions().queries)==null?void 0:S._experimental_afterQuery)==null||R.call(S,a,u),a.experimental_prefetchInRender&&!me&&Lt(u,f)){const v=c?Ee(a,d,l):(M=r.getQueryCache().get(a.queryHash))==null?void 0:M.promise;v==null||v.catch(ze).finally(()=>{d.updateResult()})}return a.notifyOnChangeProps?u:d.trackResult(u)}function Ut(t,e){return Bt(t,_t)}const Qt="_appLayout_7uqbw_5",Vt="_header_7uqbw_22",At="_platformBar_7uqbw_32",Ht="_logo_7uqbw_38",Wt="_tools_7uqbw_48",$t="_leftPanel_7uqbw_58",Kt="_panelHeader_7uqbw_70",Xt="_panelTitleWrapper_7uqbw_78",Gt="_panelCaption_7uqbw_82",Jt="_shiftIconRight_7uqbw_86",Yt="_subheader_7uqbw_90",Zt="_searchInput_7uqbw_106",es="_subheaderActions_7uqbw_110",ts="_tabList_7uqbw_114",ss="_emptyState_7uqbw_119",ns="_skeletonTree_7uqbw_128",rs="_skeletonTreeItem_7uqbw_135",is="_canvasWrapper_7uqbw_144",as="_canvas_7uqbw_144",os="_splitter_7uqbw_181",ls="_tabPanel_7uqbw_227",cs="_tree_7uqbw_239",us="_slider_7uqbw_243",hs="_colorSwatch_7uqbw_252",j={appLayout:Qt,header:Vt,platformBar:At,logo:Ht,tools:Wt,leftPanel:$t,panelHeader:Kt,panelTitleWrapper:Xt,panelCaption:Gt,shiftIconRight:Jt,subheader:Yt,searchInput:Zt,subheaderActions:es,tabList:ts,emptyState:ss,skeletonTree:ns,skeletonTreeItem:rs,canvasWrapper:is,canvas:as,splitter:os,tabPanel:ls,tree:cs,slider:us,colorSwatch:hs},ds="/463/assets/sandbox.model1-CoozF5xy.json",fs="/463/assets/sandbox.model2-Bi69Ub92.json",ps="data:application/json;base64,ewoJIm5hbWUiOiAiRXBvY2ggU3lzdGVtIGlNb2RlbCAzIiwKCSJ2ZXJzaW9uIjogIjIwMjQgUmVmcmVzaCIsCgkiZGF0YSI6IHsKCQkiZGVmYXVsdCI6IFtdCgl9Cn0K",le={model1:{name:"Epoch System iModel 1",url:ds},model2:{name:"Epoch System iModel 2",url:fs},model3:{name:"Epoch System iModel 3",url:ps}};async function ms(t){if(t in le){const e=await fetch(le[t].url).then(s=>s.json());return e.slow&&await new Promise(s=>setTimeout(s,Math.random()*2e3)),e}return{name:"Unknown",version:"Unknown",data:{default:[]}}}const Ue="Kiwi sandbox",Js=()=>[{title:Ue}],Ys=He(function(){var l;const[e,s]=Xe(),r=e.get("model")||"model1",f=Ut({queryKey:["sandbox-data",r],queryFn:()=>ms(r)});return n.jsxs(bs,{panelContent:n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:j.panelHeader,children:[n.jsxs("div",{children:[n.jsxs(et,{children:[n.jsx(Z,{render:n.jsx(tt,{}),children:"Choose Model"}),n.jsx(st,{render:a=>n.jsx(nt,{className:j.panelTitleWrapper,children:n.jsx(rt,{...a,variant:"ghost",defaultValue:r,onChange:c=>s({model:c.currentTarget.value}),children:Object.entries(le).map(([c,{name:d}])=>n.jsx("option",{value:c,children:d},c))})})})]}),n.jsxs("hgroup",{role:"group",children:[n.jsx(Z,{render:n.jsx("h2",{}),children:(l=le[r])==null?void 0:l.name}),n.jsx(o.Suspense,{fallback:n.jsx(oe,{variant:"text"}),children:n.jsx(gs,{query:f})},r)]})]}),n.jsx("div",{children:n.jsx(ae,{className:j.shiftIconRight,icon:St,label:"Dock panel",variant:"ghost",disabled:!0})})]}),n.jsx(o.Suspense,{fallback:n.jsx(vs,{}),children:n.jsx(Ss,{query:f})},r)]}),children:[n.jsxs("header",{className:j.header,children:[n.jsx("div",{className:j.logo,children:n.jsx(ee,{href:te,size:"large"})}),n.jsx(ce,{render:a=>n.jsx("h1",{...a}),variant:"body-md",children:Ue})]}),n.jsx("div",{className:j.platformBar,children:n.jsxs("div",{className:j.tools,children:[n.jsx(ee,{href:te,size:"large"}),n.jsx(ee,{href:te,size:"large"}),n.jsx(ee,{href:te,size:"large"})]})}),n.jsx("div",{className:j.canvasWrapper,children:n.jsx("div",{className:j.canvas})})]})});function bs(t){const{sliderProps:e,panelProps:s,panelMinSize:r,panelMaxSize:f,resizing:l}=Rs({minSize:{px:256,pct:20},maxSize:{pct:30}}),a=o.useId();return n.jsxs("div",{className:j.appLayout,style:{"--_panel-min-size":r,"--_panel-max-size":f},children:[n.jsx("div",{...s,className:j.leftPanel,style:{position:"relative",...s.style},children:t.panelContent}),n.jsxs("div",{className:j.splitter,"data-resizing":l?"true":void 0,children:[n.jsx(Z,{render:c=>n.jsx("label",{...c,htmlFor:a,children:"Resize layers panel"}),children:"Resize layers panel"}),n.jsx("input",{id:a,type:"range",className:j.slider,...e})]}),t.children]})}function vs(){const t=[1,1,2,2,3,2,3,2,1,1,2,3,4,5,2,3,4,5];return n.jsxs(n.Fragment,{children:[n.jsx("div",{className:j.subheader,children:n.jsx(oe,{variant:"text"})}),n.jsxs("div",{className:j.skeletonTree,children:[t.map((e,s)=>n.jsx(xs,{style:{"--level":e}},`${s}-${e}`)),n.jsx(Z,{children:"Loadingâ€¦"})]})]})}function xs(t){return n.jsxs("div",{...t,className:Ke(j.skeletonTreeItem,t.className),children:[n.jsx(oe,{variant:"object",size:"small"}),n.jsx(oe,{variant:"text"})]})}function gs(t){const{version:e=""}=o.use(t.query.promise);return n.jsx(ce,{className:j.panelCaption,variant:"body-sm",render:n.jsx("p",{}),children:e})}function Ss(t){var a;const{data:e}=o.use(t.query.promise),s=o.useMemo(()=>Object.entries(e).map(([c,d])=>{const u=d.length<=1?[]:d.map(({label:p})=>p);return{name:c,filters:u,content:d.length>0?n.jsx(Ts,{name:c,data:d,length:Object.entries(e).length}):n.jsxs(js,{children:[n.jsx(ce,{variant:"body-sm",children:"No layers"}),n.jsx(We,{children:"Create a layer"})]})}}),[e]),[r,f]=o.useState((a=s[0])==null?void 0:a.name),l=o.useMemo(()=>{var c;return r?((c=s.find(d=>d.name===r))==null?void 0:c.filters)||[]:s[0].filters},[s,r]);return s.length===1?n.jsxs(De,{allFilters:l,children:[n.jsx(Oe,{}),s[0].content]}):n.jsx(De,{allFilters:l,children:n.jsxs(it,{selectOnMove:!1,setSelectedId:f,children:[n.jsx(Oe,{tabs:s.map(c=>n.jsx(at,{id:c.name,children:$e(c.name)},c.name))}),s.map(c=>n.jsx(o.Fragment,{children:c.content},c.name))]})})}function js({children:t}){return n.jsx("div",{className:j.emptyState,children:t})}function Cs(){return n.jsx("div",{style:{textAlign:"center"},children:n.jsx(ce,{variant:"body-sm",children:"No results found"})})}function ys(t,e,s){return Math.min(Math.max(t,e),s)}function Rs(t){const{minSize:e,maxSize:s,onCollapse:r}=t??{},f=o.useId(),l=o.useRef(null),[a,c]=o.useState(void 0),[d,u]=o.useState(void 0),[p,h]=o.useState(void 0),[b,S]=o.useState(!1),[R,M]=o.useState(void 0),v=o.useMemo(()=>{if(e&&d)return Math.min(e.px,e.pct/100*d)},[e,d]),k=o.useMemo(()=>{if(v&&s&&d)return Math.max(v,s.pct/100*d)},[s,d,v]),P=o.useMemo(()=>{if(p==="smallest")return v??0;if(p==="largest")return k??0;if(a&&v&&k)return ys(a,v,k)},[a,v,k,p]);o.useEffect(()=>{const C=l.current;if(!C)return;const I=C.parentElement;if(!I)return;const U=new ResizeObserver(()=>{const he=I.getBoundingClientRect(),de=C.getBoundingClientRect();u(he.width),c(de.width)});return U.observe(I),U.observe(C),()=>{U.disconnect()}},[]);const N=o.useCallback(C=>{const I=l.current;if(!I)return;const U=I.getBoundingClientRect();M(U.width+C),h(void 0),S(!0)},[]),A=o.useCallback(C=>{const I=l.current;if(!I)return;const U=I.parentElement;if(!U)return;const he=U.getBoundingClientRect(),de=C*(he.width*.005),Ae=I.getBoundingClientRect();M(Ae.width+de),h(void 0)},[]),x=o.useCallback(()=>{l.current&&(M(void 0),S(!1))},[]),{moveableProps:D}=Is({onMove:N,onMoveEnd:x,onKeyMove:A}),T=o.useMemo(()=>({...D,onKeyDown:C=>{var I;if((I=D.onKeyDown)==null||I.call(D,C),!C.defaultPrevented)switch(C.key){case"Enter":C.preventDefault(),r==null||r();break;case"Home":C.preventDefault(),h("smallest");break;case"End":C.preventDefault(),h("largest");break}},onChange:C=>{if(b)return;const I=Number(C.target.value);M(I)},value:P===void 0?0:Math.floor(P),min:v===void 0?void 0:Math.floor(v),max:k===void 0?void 0:Math.floor(k)}),[D,P,v,k,r,b]),H=o.useMemo(()=>({style:{WebkitUserSelect:R===void 0?void 0:"none"},id:f,ref:l}),[f,R]),w=v===void 0?void 0:`${Math.floor(v)}px`,B=o.useMemo(()=>{if(R!==void 0&&s!==void 0&&p===void 0)return`min(${Math.floor(R)}px, ${s.pct}%)`;if(P!==void 0)return`${Math.floor(P)}px`},[s,R,P,p]);return{sliderProps:T,panelProps:H,panelMinSize:w,panelMaxSize:B,resizing:b}}function Is(t){const{onMove:e,onMoveEnd:s,onKeyMove:r}=t??{},f=o.useRef(null),l=o.useRef(void 0),a=o.useRef(void 0),c=o.useCallback(()=>{a.current!==void 0&&(a.current=void 0,s==null||s())},[s]);return{moveableProps:o.useMemo(()=>({onPointerDown:u=>{if(u.button!==0||u.ctrlKey)return;const p=f.current;if(!p)return;const h=p.getBoundingClientRect(),b=u.clientX-h.left;a.current=b,u.preventDefault(),p.setPointerCapture(u.pointerId)},onPointerMove:u=>{const p=a.current;if(p===void 0)return;const h=f.current;if(!h)return;const b=h.getBoundingClientRect(),S=u.clientX-p-b.left;u.preventDefault(),e==null||e(S)},onPointerUp:c,onPointerCancel:c,onKeyDown:u=>{if(!u.defaultPrevented)switch(u.key){case"ArrowLeft":u.preventDefault(),r==null||r(-1);break;case"ArrowRight":u.preventDefault(),r==null||r(1);break}},ref:u=>{var h;if(f.current=u,(h=l.current)==null||h.call(l),l.current=void 0,!u)return;const p=b=>{b.preventDefault()};u.addEventListener("touchstart",p),l.current=()=>{u.removeEventListener("touchstart",p)}}}),[r,e,c])}}const Qe=(()=>{let t=0;return e=>({id:`${t++}`,label:`Tree Item ${t}`,expanded:!0,...e,items:((e==null?void 0:e.items)??[]).map(Qe)})})();function _s({items:t,filters:e,search:s}){const r=o.useMemo(()=>e.length===0?t:t.reduce((a,c)=>(e.includes(c.label)&&a.push(c),a),[]),[t,e]),f=o.useMemo(()=>{function a(c){return c.reduce((d,u)=>{const p=a(u.items??[]);return(u.label.toLowerCase().includes(s.toLowerCase())||p.length>0)&&d.push({...u,items:p}),d},[])}return s===""?r:a(r)},[r,s]),l=o.useMemo(()=>{if(e.length===0&&s==="")return;function a(c){return c.reduce((d,u)=>{const p=u.items?a(u.items):0;return d+1+p},0)}return a(f)},[f,e,s]);return{filteredTree:f,itemCount:l}}function ws(t,e,s){return o.useMemo(()=>{function r(f,l,a,c,d){const u=[];let p=1;for(const h of f){const b=h.id===e||c,S=s.includes(h.id)||d;u.push({...h,level:a,parentItem:l,selected:b,hidden:S,parentHidden:d,position:p++,size:f.length}),h.expanded&&u.push(...r(h.items,h,a+1,b,S))}return u}return r(t,void 0,1,!1,!1)},[t,e,s])}function Ve(t,e){for(const s of t){if(s.id===e)return s;const r=Ve(s.items,e);if(r)return r}}function Ts({name:t,data:e,length:s}){var A;const{appliedFilters:r,search:f,setItemCount:l,isSearchboxVisible:a}=o.useContext(ue),[c,d]=o.useState(),[u,p]=o.useState([]),h=o.useCallback(x=>{p(D=>D.includes(x)?D.filter(T=>T!==x):[...D,x])},[]),[b,S]=o.useState(()=>e.map(x=>Qe(x))),{filteredTree:R,itemCount:M}=_s({items:b,filters:r,search:f}),v=ws(R,c,u);o.useEffect(()=>{l(M)},[l,M]);const k=o.useDeferredValue(v);if(k.length===0)return n.jsx(Cs,{});const P=o.useRef(null),N=!a&&s>1?ot:"div";return n.jsx(N,{...N!=="div"&&{tabId:t},className:j.tabPanel,focusable:!1,...N!=="div"&&{unmountOnHide:!0},ref:P,...N==="div"&&(((A=P==null?void 0:P.current)==null?void 0:A.dataset.open)||s===1)&&{"data-open":!0},children:n.jsx(o.Suspense,{fallback:"Loading...",children:n.jsx(dt,{className:j.tree,children:k.map(x=>n.jsx(ft,{label:x.label,description:x.description,"aria-level":x.level,"aria-posinset":x.position,"aria-setsize":x.size,selected:x.selected,onSelectedChange:()=>{if(c===x.id){d(void 0);return}d(x.id)},expanded:x.items.length===0?void 0:x.expanded,onExpandedChange:D=>{S(T=>{const H=Ve(T,x.id);if(!H)return T;const w=[...T];return H.expanded=D,w})},unstable_decorations:n.jsxs(n.Fragment,{children:[x.color?n.jsx(Ms,{color:x.color,alt:x.color}):null,n.jsx(ee,{href:te})]}),actions:[n.jsx(E,{icon:jt,label:"Lock"},"lock"),n.jsx(E,{icon:x.hidden?Ct:It,label:x.hidden?"Show":"Hide",visible:x.hidden?!0:void 0,onClick:()=>{h(x.id)}},"visibility"),n.jsx(E,{label:"Copy"},"copy"),n.jsx(E,{label:"Paste"},"paste"),n.jsx(E,{label:"Copy/Paste as"},"copy-paste"),n.jsx(E,{label:"Move to"},"move"),n.jsx(E,{label:"Bring to front"},"bring-to-front"),n.jsx(E,{label:"Send to back"},"send-to-back"),n.jsx(E,{label:"Group selection"},"group"),n.jsx(E,{label:"Ungroup"},"ungroup"),n.jsx(E,{label:"Rename"},"rename"),n.jsx(E,{label:"Show/hide"},"show-hide"),n.jsx(E,{label:"Lock/unlock"},"lock-unlock"),n.jsx(E,{label:"Isolate object"},"isolate")]},x.id))})})},t)}function Oe({tabs:t}){const{itemCount:e,isFiltered:s,search:r,setSearch:f,isSearchboxVisible:l,setIsSearchboxVisible:a}=o.useContext(ue),c=o.useRef(null),d=o.useRef(null),u=s||!!r,p=l?n.jsxs(n.Fragment,{children:[n.jsx(Fs,{}),t?n.jsx(ae,{className:j.shiftIconRight,icon:yt,label:"Close",variant:"ghost",onClick:()=>{var b;_e.flushSync(()=>a(!1)),(b=d.current)==null||b.focus()}}):null]}):n.jsx(ae,{className:j.shiftIconRight,icon:Me,label:"Search",dot:u?"Some filters or search applied":void 0,variant:"ghost",onClick:()=>{var b;_e.flushSync(()=>a(!0)),(b=c.current)==null||b.focus()}}),h=o.useMemo(()=>{if(s)return e===void 0?"Showing all tree items":`Showing ${e} tree items`},[s,e]);return n.jsxs("div",{className:j.subheader,children:[n.jsx(Z,{"aria-live":"polite","aria-atomic":!0,children:h}),t&&!l?n.jsx(lt,{className:j.tabList,tone:"accent",ref:d,children:t}):null,l?n.jsxs(ct,{className:j.searchInput,children:[n.jsx(ut,{href:Me}),n.jsx(ht,{placeholder:"Search",ref:c,onChange:b=>f(b.currentTarget.value)})]}):null,n.jsx("div",{className:j.subheaderActions,children:p})]})}function Fs(){const t=o.useContext(ue),e=t.appliedFilters.length>0;return n.jsxs(Ge,{children:[n.jsx(Je,{render:n.jsx(ae,{icon:Rt,label:"Filter",dot:e?"Some filters applied":void 0,variant:"ghost",disabled:t.allFilters.length===0})}),n.jsx(Ye,{children:t.allFilters.map(s=>{const r=t.appliedFilters.includes(s);return n.jsx(Ze,{name:s,label:s,checked:r,onChange:()=>{t.toggleFilter(s)}},s)})})]})}function De(t){const[e,s]=o.useState(!1),[r,f]=o.useState([]),[l,a]=o.useState(""),[c,d]=o.useState(!1),[u,p]=o.useState(void 0),h=o.useCallback(R=>{const M=r.includes(R)?r.filter(v=>v!==R):[...r,R];f(M),s(M.length>0)},[r]),b=o.useCallback(()=>{f([]),s(!1)},[]),S=o.useCallback(R=>{a(R),s(!!R)},[]);return n.jsx(ue.Provider,{value:o.useMemo(()=>({allFilters:t.allFilters,appliedFilters:r,isFiltered:e,toggleFilter:h,clearFilters:b,search:l,setSearch:S,isSearchboxVisible:c,setIsSearchboxVisible:d,itemCount:u,setItemCount:p}),[t.allFilters,r,e,h,b,l,S,c,u]),children:t.children})}const ue=o.createContext({allFilters:[],appliedFilters:[],isFiltered:!1,toggleFilter:()=>{},clearFilters:()=>{},search:"",setSearch:()=>{},isSearchboxVisible:!1,setIsSearchboxVisible:()=>{},itemCount:void 0,setItemCount:()=>{}});function Ms(t){return n.jsx("div",{className:j.colorSwatch,style:{"--_color":`var(--_color--${t.color})`},children:t.alt?n.jsx(Z,{children:t.alt}):null})}export{Ys as default,Js as meta};
