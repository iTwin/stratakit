import{z as $,t as G,q as be,c as W,_ as q,G as J,g as P,u as X,b as w,r as Z,d as Q,e as ee,X as Ce,J as xe,m as F,Y as Se,Z as O,v as _,$ as Pe,l as j,a0 as we,a1 as he,y as Ee,n as ye,a2 as Te,a3 as Re}from"./~utils-ChHMGsjo.js";import{a as I,n as De}from"./chunk-K6AXKMTT-BHCV6zel.js";import{u as Fe}from"./KUU7WJ55-BzS6MnHA.js";import{f as Oe}from"./YV4JVR4I-I4X5ERHE.js";var h=$(),_e=h.useContext;h.useScopedContext;h.useProviderContext;var Ae=h.ContextProvider,ke=h.ScopedContextProvider,E=$([Ae],[ke]),ze=E.useContext;E.useScopedContext;var tt=E.useProviderContext,rt=E.ContextProvider,nt=E.ScopedContextProvider,Ke=I.createContext(void 0),Le=I.createContext(void 0),Ne={id:null};function ot(r,n,o=!1){const t=r.findIndex(u=>u.id===n);return[...r.slice(t+1),...o?[Ne]:[],...r.slice(0,t)]}function it(r,n){return r.find(o=>!o.disabled)}function Be(r,n){return n&&r.item(n)||null}function st(r){const n=[];for(const o of r){const t=n.find(u=>{var d;return((d=u[0])==null?void 0:d.rowId)===o.rowId});t?t.push(o):n.push([o])}return n}function Me(r,n=!1){if(G(r))r.setSelectionRange(n?r.value.length:0,r.value.length);else if(r.isContentEditable){const o=be(r).getSelection();o==null||o.selectAllChildren(r),n&&(o==null||o.collapseToEnd())}}var A=Symbol("FOCUS_SILENTLY");function He(r){r[A]=!0,r.focus({preventScroll:!0})}function at(r){const n=r[A];return delete r[A],n}function te(r,n,o){return!(!n||n===o||!r.item(n.id))}var Ue="div",re=W(function(n){var o=n,{store:t,shouldRegisterItem:u=!0,getItem:d=Ce,element:b}=o,v=q(o,["store","shouldRegisterItem","getItem","element"]);const c=_e();t=t||c;const m=J(v.id),p=I.useRef(b);return I.useEffect(()=>{const i=p.current;if(!m||!i||!u)return;const C=d({id:m,element:i});return t==null?void 0:t.renderItem(C)},[m,u,d,t]),v=P(w({},v),{ref:X(p,v.ref)}),Z(v)});Q(function(n){const o=re(n);return ee(Ue,o)});var Ve="button";function je(r){return O(r)?!0:r.tagName==="INPUT"&&!Te(r)}function Ye(r,n=!1){const o=r.clientHeight,{top:t}=r.getBoundingClientRect(),u=Math.max(o*.875,o-40)*1.5,d=n?o-u+t:u+t;return r.tagName==="HTML"?d+r.scrollTop:d}function $e(r,n=!1){const{top:o}=r.getBoundingClientRect();return n?o+r.clientHeight:o}function Y(r,n,o,t=!1){var u;if(!n||!o)return;const{renderedItems:d}=n.getState(),b=Re(r);if(!b)return;const v=Ye(b,t);let c,m;for(let p=0;p<d.length;p+=1){const i=c;if(c=o(p),!c)break;if(c===i)continue;const C=(u=Be(n,c))==null?void 0:u.element;if(!C)continue;const x=$e(C,t)-v,l=Math.abs(x);if(t&&x<=0||!t&&x>=0){m!==void 0&&m<l&&(c=i);break}m=l}return c}function Ge(r,n){return _(r)?!1:te(n,r.target)}var We=W(function(n){var o=n,{store:t,rowId:u,preventScrollOnKeyDown:d=!1,moveOnKeyPress:b=!0,tabbable:v=!1,getItem:c,"aria-setsize":m,"aria-posinset":p}=o,i=q(o,["store","rowId","preventScrollOnKeyDown","moveOnKeyPress","tabbable","getItem","aria-setsize","aria-posinset"]);const C=ze();t=t||C;const f=J(i.id),x=I.useRef(null),l=I.useContext(Le),k=xe(i)&&!i.accessibleWhenDisabled,{rowId:T,baseElement:z,isActiveItem:ne,ariaSetSize:oe,ariaPosInSet:ie,isTabbable:se}=Oe(t,{rowId(e){if(u)return u;if(e&&l!=null&&l.baseElement&&l.baseElement===e.baseElement)return l.id},baseElement(e){return(e==null?void 0:e.baseElement)||void 0},isActiveItem(e){return!!e&&e.activeId===f},ariaSetSize(e){if(m!=null)return m;if(e&&l!=null&&l.ariaSetSize&&l.baseElement===e.baseElement)return l.ariaSetSize},ariaPosInSet(e){if(p!=null)return p;if(!e||!(l!=null&&l.ariaPosInSet)||l.baseElement!==e.baseElement)return;const s=e.renderedItems.filter(a=>a.rowId===T);return l.ariaPosInSet+s.findIndex(a=>a.id===f)},isTabbable(e){if(!(e!=null&&e.renderedItems.length))return!0;if(e.virtualFocus)return!1;if(v)return!0;if(e.activeId===null)return!1;const s=t==null?void 0:t.item(e.activeId);return s!=null&&s.disabled||!(s!=null&&s.element)?!0:e.activeId===f}}),ae=I.useCallback(e=>{var s;const a=P(w({},e),{id:f||e.id,rowId:T,disabled:!!k,children:(s=e.element)==null?void 0:s.textContent});return c?c(a):a},[f,T,k,c]),K=i.onFocus,R=I.useRef(!1),ue=F(e=>{if(K==null||K(e),e.defaultPrevented||Se(e)||!f||!t||Ge(e,t))return;const{virtualFocus:s,baseElement:a}=t.getState();if(t.setActiveId(f),O(e.currentTarget)&&Me(e.currentTarget),!s||!_(e)||je(e.currentTarget)||!(a!=null&&a.isConnected))return;Pe()&&e.currentTarget.hasAttribute("data-autofocus")&&e.currentTarget.scrollIntoView({block:"nearest",inline:"nearest"}),R.current=!0,e.relatedTarget===a||te(t,e.relatedTarget)?He(a):a.focus()}),L=i.onBlurCapture,le=F(e=>{if(L==null||L(e),e.defaultPrevented)return;const s=t==null?void 0:t.getState();s!=null&&s.virtualFocus&&R.current&&(R.current=!1,e.preventDefault(),e.stopPropagation())}),N=i.onKeyDown,ce=j(d),fe=j(b),de=F(e=>{if(N==null||N(e),e.defaultPrevented||!_(e)||!t)return;const{currentTarget:s}=e,a=t.getState(),D=t.item(f),g=!!(D!=null&&D.rowId),y=a.orientation!=="horizontal",S=a.orientation!=="vertical",M=()=>!!(g||S||!a.baseElement||!G(a.baseElement)),H={ArrowUp:(g||y)&&t.up,ArrowRight:(g||S)&&t.next,ArrowDown:(g||y)&&t.down,ArrowLeft:(g||S)&&t.previous,Home:()=>{if(M())return!g||e.ctrlKey?t==null?void 0:t.first():t==null?void 0:t.previous(-1)},End:()=>{if(M())return!g||e.ctrlKey?t==null?void 0:t.last():t==null?void 0:t.next(-1)},PageUp:()=>Y(s,t,t==null?void 0:t.up,!0),PageDown:()=>Y(s,t,t==null?void 0:t.down)}[e.key];if(H){if(O(s)){const V=we(s),me=S&&e.key==="ArrowLeft",ve=S&&e.key==="ArrowRight",pe=y&&e.key==="ArrowUp",Ie=y&&e.key==="ArrowDown";if(ve||Ie){const{length:ge}=he(s);if(V.end!==ge)return}else if((me||pe)&&V.start!==0)return}const U=H();if(ce(e)||U!==void 0){if(!fe(e))return;e.preventDefault(),t.move(U)}}}),B=I.useMemo(()=>({id:f,baseElement:z}),[f,z]);return i=Ee(i,e=>De.jsx(Ke.Provider,{value:B,children:e}),[B]),i=P(w({id:f,"data-active-item":ne||void 0},i),{ref:X(x,i.ref),tabIndex:se?i.tabIndex:-1,onFocus:ue,onBlurCapture:le,onKeyDown:de}),i=Fe(i),i=re(P(w({store:t},i),{getItem:ae,shouldRegisterItem:f?i.shouldRegisterItem:!1})),Z(P(w({},i),{"aria-setsize":oe,"aria-posinset":ie}))}),ut=ye(Q(function(n){const o=We(n);return ee(Ve,o)}));export{nt as C,rt as a,We as b,ut as c,re as d,tt as e,ot as f,Be as g,it as h,te as i,st as j,at as s,ze as u};
