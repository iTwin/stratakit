import{u as ie,g as k,s as re,i as O,a as ue,f as ae,c as oe}from"./WZWDIE3S.Aq4DbAHm.js";import{f as se,a as le,s as ce,a_ as de,a$ as fe,b0 as Y,b1 as R,b2 as ve,b3 as me,w as H,aO as T,t as Ie,aJ as Z,g as ge,j as Se,d as Ee,b4 as ye,b5 as we,e as be,ay as I,az as he,aA as xe,b6 as Fe,aG as Ce,b as Pe,aI as P}from"./ExamplePreview.ROT6mk1O.js";import{r as K}from"./index.DIfZGIpv.js";import{d as ke,e as Ae}from"./GVAFFF2B.DjV5NlY6.js";function ee(t){const e=[];for(const n of t)e.push(...n);return e}function q(t){return t.slice().reverse()}var _e="div";function Le(t){return t.some(e=>!!e.rowId)}function Be(t){const e=t.target;return e&&!Z(e)?!1:t.key.length===1&&!t.ctrlKey&&!t.metaKey}function Re(t){return t.key==="Shift"||t.key==="Control"||t.key==="Alt"||t.key==="Meta"}function Q(t,e,n){return H(a=>{var s;if(e?.(a),a.defaultPrevented||a.isPropagationStopped()||!T(a)||Re(a)||Be(a))return;const u=t.getState(),o=(s=k(t,u.activeId))==null?void 0:s.element;if(!o)return;const{view:C,...i}=a,g=n?.current;o!==g&&o.focus(),we(o,a.type,i)||a.preventDefault(),a.currentTarget.contains(o)&&a.stopPropagation()})}function Te(t){return ae(ee(q(oe(t))))}function Ke(t){const[e,n]=K.useState(!1),a=K.useCallback(()=>n(!0),[]),s=t.useState(u=>k(t,u.activeId));return K.useEffect(()=>{const u=s?.element;e&&u&&(n(!1),u.focus({preventScroll:!0}))},[s,e]),a}var De=le(function({store:e,composite:n=!0,focusOnMove:a=n,moveOnKeyPress:s=!0,...u}){const o=ie();e=e||o,ce(e,!1);const C=K.useRef(null),i=K.useRef(null),g=Ke(e),S=e.useState("moves"),[,N]=de(n?e.setBaseElement:null);K.useEffect(()=>{var r;if(!e||!S||!n||!a)return;const{activeId:l}=e.getState(),d=(r=k(e,l))==null?void 0:r.element;d&&fe(d)},[e,S,n,a]),Y(()=>{if(!e||!S||!n)return;const{baseElement:r,activeId:l}=e.getState();if(!(l===null)||!r)return;const f=i.current;i.current=null,f&&R(f,{relatedTarget:r}),ve(r)||r.focus()},[e,S,n]);const E=e.useState("activeId"),A=e.useState("virtualFocus");Y(()=>{var r;if(!e||!n||!A)return;const l=i.current;if(i.current=null,!l)return;const f=((r=k(e,E))==null?void 0:r.element)||me(l);f!==l&&R(l,{relatedTarget:f})},[e,E,A,n]);const y=Q(e,u.onKeyDownCapture,i),$=Q(e,u.onKeyUpCapture,i),_=u.onFocusCapture,D=H(r=>{if(_?.(r),r.defaultPrevented||!e)return;const{virtualFocus:l}=e.getState();if(!l)return;const d=r.relatedTarget,f=re(r.currentTarget);T(r)&&f&&(r.stopPropagation(),i.current=d)}),z=u.onFocus,U=H(r=>{if(z?.(r),r.defaultPrevented||!n||!e)return;const{relatedTarget:l}=r,{virtualFocus:d}=e.getState();d?T(r)&&!O(e,l)&&queueMicrotask(g):T(r)&&e.setActiveId(null)}),M=u.onBlurCapture,w=H(r=>{var l;if(M?.(r),r.defaultPrevented||!e)return;const{virtualFocus:d,activeId:f}=e.getState();if(!d)return;const b=(l=k(e,f))==null?void 0:l.element,x=r.relatedTarget,h=O(e,x),m=i.current;i.current=null,T(r)&&h?(x===b?m&&m!==x&&R(m,r):b?R(b,r):m&&R(m,r),r.stopPropagation()):!O(e,r.target)&&b&&R(b,r)}),W=u.onKeyDown,V=Ie(s),j=H(r=>{var l;if(W?.(r),r.nativeEvent.isComposing||r.defaultPrevented||!e||!T(r))return;const{orientation:d,renderedItems:f,activeId:b}=e.getState(),x=k(e,b);if((l=x?.element)!=null&&l.isConnected)return;const h=d!=="horizontal",m=d!=="vertical",c=Le(f);if((r.key==="ArrowLeft"||r.key==="ArrowRight"||r.key==="Home"||r.key==="End")&&Z(r.currentTarget))return;const J={ArrowUp:(c||h)&&(()=>{if(c){const p=Te(f);return p?.id}return e?.last()}),ArrowRight:(c||m)&&e.first,ArrowDown:(c||h)&&e.first,ArrowLeft:(c||m)&&e.last,Home:e.first,End:e.last,PageUp:e.first,PageDown:e.last}[r.key];if(J){const p=J();if(p!==void 0){if(!V(r))return;r.preventDefault(),e.move(p)}}});u=ge(u,r=>Se.jsx(ue,{value:e,children:r}),[e]),u={"aria-activedescendant":e.useState(r=>{var l;if(e&&n&&r.virtualFocus)return(l=k(e,r.activeId))==null?void 0:l.id}),...u,ref:Ee(C,N,u.ref),onKeyDownCapture:y,onKeyUpCapture:$,onFocusCapture:D,onFocus:U,onBlurCapture:w,onKeyDown:j};const L=e.useState(r=>n&&(r.virtualFocus||r.activeId===null));return u=ye({focusable:L,...u}),u}),Ye=se(function(e){const n=De(e);return be(_e,n)}),ze={id:null};function F(t,e){return t.find(n=>e?!n.disabled&&n.id!==e:!n.disabled)}function Me(t,e){return t.filter(n=>e?!n.disabled&&n.id!==e:!n.disabled)}function X(t,e){return t.filter(n=>n.rowId===e)}function We(t,e,n=!1){const a=t.findIndex(s=>s.id===e);return[...t.slice(a+1),...n?[ze]:[],...t.slice(0,a)]}function te(t){const e=[];for(const n of t){const a=e.find(s=>{var u;return((u=s[0])==null?void 0:u.rowId)===n.rowId});a?a.push(n):e.push([n])}return e}function ne(t){let e=0;for(const{length:n}of t)n>e&&(e=n);return e}function pe(t){return{id:"__EMPTY_ITEM__",disabled:!0,rowId:t}}function He(t,e,n){const a=ne(t);for(const s of t)for(let u=0;u<a;u+=1){const o=s[u];if(!o||n&&o.disabled){const i=u===0&&n?F(s):s[u-1];s[u]=i&&e!==i.id&&n?i:pe(i?.rowId)}}return t}function Ne(t){const e=te(t),n=ne(e),a=[];for(let s=0;s<n;s+=1)for(const u of e){const o=u[s];o&&a.push({...o,rowId:o.rowId?`${s}`:void 0})}return a}function Ue(t={}){var e;const n=(e=t.store)==null?void 0:e.getState(),a=ke(t),s=I(t.activeId,n?.activeId,t.defaultActiveId),u={...a.getState(),id:I(t.id,n?.id,`id-${Math.random().toString(36).slice(2,8)}`),activeId:s,baseElement:I(n?.baseElement,null),includesBaseElement:I(t.includesBaseElement,n?.includesBaseElement,s===null),moves:I(n?.moves,0),orientation:I(t.orientation,n?.orientation,"both"),rtl:I(t.rtl,n?.rtl,!1),virtualFocus:I(t.virtualFocus,n?.virtualFocus,!1),focusLoop:I(t.focusLoop,n?.focusLoop,!1),focusWrap:I(t.focusWrap,n?.focusWrap,!1),focusShift:I(t.focusShift,n?.focusShift,!1)},o=he(u,a,t.store);xe(o,()=>Fe(o,["renderedItems","activeId"],i=>{o.setState("activeId",g=>{var S;return g!==void 0?g:(S=F(i.renderedItems))==null?void 0:S.id})}));const C=(i="next",g={})=>{var S,N;const E=o.getState(),{skip:A=0,activeId:y=E.activeId,focusShift:$=E.focusShift,focusLoop:_=E.focusLoop,focusWrap:D=E.focusWrap,includesBaseElement:z=E.includesBaseElement,renderedItems:U=E.renderedItems,rtl:M=E.rtl}=g,w=i==="up"||i==="down",W=i==="next"||i==="down",V=W?M&&!w:!M||w,j=$&&!A;let v=w?ee(He(te(U),y,j)):U;if(v=V?q(v):v,v=w?Ne(v):v,y==null)return(S=F(v))==null?void 0:S.id;const L=v.find(c=>c.id===y);if(!L)return(N=F(v))==null?void 0:N.id;const r=v.some(c=>c.rowId),l=v.indexOf(L),d=v.slice(l+1),f=X(d,L.rowId);if(A){const c=Me(f,y),B=c.slice(A)[0]||c[c.length-1];return B?.id}const b=_&&(w?_!=="horizontal":_!=="vertical"),x=r&&D&&(w?D!=="horizontal":D!=="vertical"),h=W?(!r||w)&&b&&z:w?z:!1;if(b){const c=x&&!h?v:X(v,L.rowId),B=We(c,y,h),G=F(B,y);return G?.id}if(x){const c=F(h?f:d,y);return h?c?.id||null:c?.id}const m=F(f,y);return!m&&h?null:m?.id};return{...a,...o,setBaseElement:i=>o.setState("baseElement",i),setActiveId:i=>o.setState("activeId",i),move:i=>{i!==void 0&&(o.setState("activeId",i),o.setState("moves",g=>g+1))},first:()=>{var i;return(i=F(o.getState().renderedItems))==null?void 0:i.id},last:()=>{var i;return(i=F(q(o.getState().renderedItems)))==null?void 0:i.id},next:i=>(i!==void 0&&typeof i=="number"&&(i={skip:i}),C("next",i)),previous:i=>(i!==void 0&&typeof i=="number"&&(i={skip:i}),C("previous",i)),down:i=>(i!==void 0&&typeof i=="number"&&(i={skip:i}),C("down",i)),up:i=>(i!==void 0&&typeof i=="number"&&(i={skip:i}),C("up",i))}}function $e(t){return{id:Pe(t.id),...t}}function Ve(t,e,n){return t=Ae(t,e,n),P(t,n,"activeId","setActiveId"),P(t,n,"includesBaseElement"),P(t,n,"virtualFocus"),P(t,n,"orientation"),P(t,n,"rtl"),P(t,n,"focusLoop"),P(t,n,"focusWrap"),P(t,n,"focusShift"),t}function Qe(t={}){t=$e(t);const[e,n]=Ce(Ue,t);return Ve(e,n,t)}export{Ye as C,Ve as a,De as b,Ue as c,Qe as u};
