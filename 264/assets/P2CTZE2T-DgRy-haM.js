import{z as $,t as G,q as Ce,c as W,_ as q,G as J,g as P,u as X,b as w,r as Z,d as Q,e as ee,X as xe,J as ve,m as F,Y as Se,Z as O,v as _,$ as Pe,l as j,a0 as we,a1 as he,y as Ee,n as ye,a2 as Te,a3 as Re}from"./~utils-42rWkPQx.js";import{a as g,n as De}from"./chunk-K6AXKMTT-B_QCnNdX.js";import{u as Fe}from"./KUU7WJ55-C0RLZClQ.js";import{f as Oe}from"./YV4JVR4I-uTAyjRpX.js";var h=$(),_e=h.useContext;h.useScopedContext;h.useProviderContext;var Ae=h.ContextProvider,ke=h.ScopedContextProvider,E=$([Ae],[ke]),ze=E.useContext;E.useScopedContext;var tt=E.useProviderContext,nt=E.ContextProvider,rt=E.ScopedContextProvider,Ke=g.createContext(void 0),Le=g.createContext(void 0),Ne={id:null};function ot(n,r,o=!1){const t=n.findIndex(a=>a.id===r);return[...n.slice(t+1),...o?[Ne]:[],...n.slice(0,t)]}function it(n,r){return n.find(o=>!o.disabled)}function Be(n,r){return r&&n.item(r)||null}function st(n){const r=[];for(const o of n){const t=r.find(a=>{var c;return((c=a[0])==null?void 0:c.rowId)===o.rowId});t?t.push(o):r.push([o])}return r}function Me(n,r=!1){if(G(n))n.setSelectionRange(r?n.value.length:0,n.value.length);else if(n.isContentEditable){const o=Ce(n).getSelection();o==null||o.selectAllChildren(n),r&&(o==null||o.collapseToEnd())}}var A=Symbol("FOCUS_SILENTLY");function He(n){n[A]=!0,n.focus({preventScroll:!0})}function ut(n){const r=n[A];return delete n[A],r}function te(n,r,o){return!(!r||r===o||!n.item(r.id))}var Ue="div",ne=W(function(r){var o=r,{store:t,shouldRegisterItem:a=!0,getItem:c=xe,element:C}=o,p=q(o,["store","shouldRegisterItem","getItem","element"]);const f=_e();t=t||f;const m=J(p.id),I=g.useRef(C);return g.useEffect(()=>{const i=I.current;if(!m||!i||!a)return;const x=c({id:m,element:i});return t==null?void 0:t.renderItem(x)},[m,a,c,t]),p=P(w({},p),{ref:X(I,p.ref)}),Z(p)});Q(function(r){const o=ne(r);return ee(Ue,o)});var Ve="button";function je(n){return O(n)?!0:n.tagName==="INPUT"&&!Te(n)}function Ye(n,r=!1){const o=n.clientHeight,{top:t}=n.getBoundingClientRect(),a=Math.max(o*.875,o-40)*1.5,c=r?o-a+t:a+t;return n.tagName==="HTML"?c+n.scrollTop:c}function $e(n,r=!1){const{top:o}=n.getBoundingClientRect();return r?o+n.clientHeight:o}function Y(n,r,o,t=!1){var a;if(!r||!o)return;const{renderedItems:c}=r.getState(),C=Re(n);if(!C)return;const p=Ye(C,t);let f,m;for(let I=0;I<c.length;I+=1){const i=f;if(f=o(I),!f)break;if(f===i)continue;const x=(a=Be(r,f))==null?void 0:a.element;if(!x)continue;const v=$e(x,t)-p,l=Math.abs(v);if(t&&v<=0||!t&&v>=0){m!==void 0&&m<l&&(f=i);break}m=l}return f}function Ge(n,r){return _(n)?!1:te(r,n.target)}var We=W(function(r){var o=r,{store:t,rowId:a,preventScrollOnKeyDown:c=!1,moveOnKeyPress:C=!0,tabbable:p=!1,getItem:f,"aria-setsize":m,"aria-posinset":I}=o,i=q(o,["store","rowId","preventScrollOnKeyDown","moveOnKeyPress","tabbable","getItem","aria-setsize","aria-posinset"]);const x=ze();t=t||x;const d=J(i.id),v=g.useRef(null),l=g.useContext(Le),k=ve(i)&&!i.accessibleWhenDisabled,{rowId:T,baseElement:z,isActiveItem:re,ariaSetSize:oe,ariaPosInSet:ie,isTabbable:se}=Oe(t,{rowId(e){if(a)return a;if(e&&l!=null&&l.baseElement&&l.baseElement===e.baseElement)return l.id},baseElement(e){return(e==null?void 0:e.baseElement)||void 0},isActiveItem(e){return!!e&&e.activeId===d},ariaSetSize(e){if(m!=null)return m;if(e&&l!=null&&l.ariaSetSize&&l.baseElement===e.baseElement)return l.ariaSetSize},ariaPosInSet(e){if(I!=null)return I;if(!e||!(l!=null&&l.ariaPosInSet)||l.baseElement!==e.baseElement)return;const s=e.renderedItems.filter(u=>u.rowId===T);return l.ariaPosInSet+s.findIndex(u=>u.id===d)},isTabbable(e){if(!(e!=null&&e.renderedItems.length))return!0;if(e.virtualFocus)return!1;if(p)return!0;if(e.activeId===null)return!1;const s=t==null?void 0:t.item(e.activeId);return s!=null&&s.disabled||!(s!=null&&s.element)?!0:e.activeId===d}}),ue=g.useCallback(e=>{var s;const u=P(w({},e),{id:d||e.id,rowId:T,disabled:!!k,children:(s=e.element)==null?void 0:s.textContent});return f?f(u):u},[d,T,k,f]),K=i.onFocus,R=g.useRef(!1),ae=F(e=>{if(K==null||K(e),e.defaultPrevented||Se(e)||!d||!t||Ge(e,t))return;const{virtualFocus:s,baseElement:u}=t.getState();if(t.setActiveId(d),O(e.currentTarget)&&Me(e.currentTarget),!s||!_(e)||je(e.currentTarget)||!(u!=null&&u.isConnected))return;Pe()&&e.currentTarget.hasAttribute("data-autofocus")&&e.currentTarget.scrollIntoView({block:"nearest",inline:"nearest"}),R.current=!0,e.relatedTarget===u||te(t,e.relatedTarget)?He(u):u.focus()}),L=i.onBlurCapture,le=F(e=>{if(L==null||L(e),e.defaultPrevented)return;const s=t==null?void 0:t.getState();s!=null&&s.virtualFocus&&R.current&&(R.current=!1,e.preventDefault(),e.stopPropagation())}),N=i.onKeyDown,fe=j(c),de=j(C),ce=F(e=>{if(N==null||N(e),e.defaultPrevented||!_(e)||!t)return;const{currentTarget:s}=e,u=t.getState(),D=t.item(d),b=!!(D!=null&&D.rowId),y=u.orientation!=="horizontal",S=u.orientation!=="vertical",M=()=>!!(b||S||!u.baseElement||!G(u.baseElement)),H={ArrowUp:(b||y)&&t.up,ArrowRight:(b||S)&&t.next,ArrowDown:(b||y)&&t.down,ArrowLeft:(b||S)&&t.previous,Home:()=>{if(M())return!b||e.ctrlKey?t==null?void 0:t.first():t==null?void 0:t.previous(-1)},End:()=>{if(M())return!b||e.ctrlKey?t==null?void 0:t.last():t==null?void 0:t.next(-1)},PageUp:()=>Y(s,t,t==null?void 0:t.up,!0),PageDown:()=>Y(s,t,t==null?void 0:t.down)}[e.key];if(H){if(O(s)){const V=we(s),me=S&&e.key==="ArrowLeft",pe=S&&e.key==="ArrowRight",Ie=y&&e.key==="ArrowUp",ge=y&&e.key==="ArrowDown";if(pe||ge){const{length:be}=he(s);if(V.end!==be)return}else if((me||Ie)&&V.start!==0)return}const U=H();if(fe(e)||U!==void 0){if(!de(e))return;e.preventDefault(),t.move(U)}}}),B=g.useMemo(()=>({id:d,baseElement:z}),[d,z]);return i=Ee(i,e=>De.jsx(Ke.Provider,{value:B,children:e}),[B]),i=P(w({id:d,"data-active-item":re||void 0},i),{ref:X(v,i.ref),tabIndex:se?i.tabIndex:-1,onFocus:ae,onBlurCapture:le,onKeyDown:ce}),i=Fe(i),i=ne(P(w({store:t},i),{getItem:ue,shouldRegisterItem:d?i.shouldRegisterItem:!1})),Z(P(w({},i),{"aria-setsize":oe,"aria-posinset":ie}))}),at=ye(Q(function(r){const o=We(r);return ee(Ve,o)}));export{rt as C,nt as a,We as b,at as c,ne as d,tt as e,ot as f,Be as g,it as h,te as i,st as j,ut as s,ze as u};
