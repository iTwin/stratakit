/*---------------------------------------------------------------------------------------------
 * Copyright (c) Bentley Systems, Incorporated. All rights reserved.
 * See LICENSE.md in the project root for license terms and full copyright notice.
 *--------------------------------------------------------------------------------------------*/

.ğŸ¥NavigationRail {
	--âœ¨size--collapsed: calc(1.5rem + 4 * var(--stratakit-space-x2));
	--âœ¨size--expanded: 256px;

	@layer base {
		display: inline-flex;
		flex-direction: column;
		gap: var(--stratakit-space-x1);

		block-size: 100%;
		min-inline-size: var(--âœ¨size--collapsed);
		inline-size: var(--ğŸ¥NavigationRail-inline-size);

		background-color: var(--stratakit-color-bg-page-depth);
		border-inline-end: 1px solid var(--stratakit-color-border-neutral-muted);

		--ğŸ¥Divider-cross-axis-margin: var(--stratakit-space-x1);
	}

	@layer modifiers {
		&:where([data-_sk-expanded="true"]) {
			--ğŸ¥NavigationRail-inline-size: var(--âœ¨size--expanded);
		}
	}
}

.ğŸ¥NavigationRailHeader {
	--âœ¨header-height: 56px;

	@layer base {
		position: relative;
		display: flex;
		align-items: center;

		padding-block: var(--stratakit-space-x2);
		padding-inline: var(--stratakit-space-x4);
		min-block-size: var(--âœ¨header-height);
	}
}

.ğŸ¥NavigationRailToggleButton {
	--âœ¨size--outer: 1rem;

	@layer base {
		inline-size: var(--âœ¨size--outer);
		block-size: var(--âœ¨size--outer);
		margin-inline-start: auto;

		border-radius: 9999px;
		border: 1px solid var(--stratakit-color-border-neutral-muted);
		background-color: var(--stratakit-color-bg-page-base);
		color: var(--stratakit-color-icon-neutral-base);

		display: grid;
		place-items: center;

		transition: rotate 150ms ease-out;

		&::before {
			content: "";
			position: absolute;
			inline-size: 24px;
			block-size: 24px;
		}
	}

	@layer states {
		@media (any-hover: hover) {
			&:where(:hover) {
				border-color: color-mix(
					in oklch,
					var(--stratakit-color-border-neutral-muted) 100%,
					var(--stratakit-color-glow-hue) var(--stratakit-color-border-glow-base-hover-\%)
				);
			}
		}

		/* Should be floating above the right edge of the header during collapsed state */
		:where(.ğŸ¥NavigationRailHeader:not([data-_sk-expanded="true"])) & {
			position: absolute;
			inset-inline-end: 0;
			translate: 50%;
		}

		&:where([aria-pressed="true"]) {
			rotate: 180deg;
		}
	}
}

.ğŸ¥NavigationRailContent {
	@layer base {
		padding-block: var(--stratakit-space-x1);
		padding-inline: var(--stratakit-space-x2);

		flex: 999;
		overflow: auto;

		display: flex;
		flex-direction: column;
	}
}

.ğŸ¥NavigationRailList {
	@layer base {
		display: flex;
		flex-direction: column;
	}
}

.ğŸ¥NavigationRailListItem {
	@layer base {
		flex-shrink: 0;
	}
}

.ğŸ¥NavigationRailItemAction {
	--âœ¨height: calc(1.5rem + 2 * var(--stratakit-space-x2));

	--âœ¨bg--default: transparent;
	--âœ¨bg--hover: var(--stratakit-color-bg-glow-on-surface-neutral-hover);
	--âœ¨bg--pressed: var(--stratakit-color-bg-glow-on-surface-neutral-pressed);
	--âœ¨bg--active: var(--stratakit-color-bg-glow-on-surface-accent-pressed);
	--âœ¨bg--disabled: transparent;

	--âœ¨color--default: var(--stratakit-color-text-neutral-primary);
	--âœ¨color--hover: var(--stratakit-color-text-neutral-primary);
	--âœ¨color--pressed: var(--stratakit-color-text-neutral-primary);
	--âœ¨color--active: var(--stratakit-color-text-accent-strong);
	--âœ¨color--disabled: var(--stratakit-color-text-neutral-disabled);

	--âœ¨icon--default: var(--stratakit-color-icon-neutral-base);
	--âœ¨icon--hover: var(--stratakit-color-icon-neutral-primary);
	--âœ¨icon--pressed: var(--stratakit-color-icon-neutral-primary);
	--âœ¨icon--active: var(--stratakit-color-icon-accent-strong);
	--âœ¨icon--disabled: var(--stratakit-color-icon-neutral-disabled);

	--âœ¨border--default: transparent;
	--âœ¨border--hover: transparent;
	--âœ¨border--pressed: transparent;
	--âœ¨border--active: var(--stratakit-color-border-accent-base);
	--âœ¨border--disabled: transparent;

	@layer base {
		@apply --typography("body-md");
		text-decoration: none;

		display: inline-flex;
		align-items: center;
		gap: var(--stratakit-space-x3);

		border-radius: 4px;
		inline-size: stretch;
		min-block-size: var(--âœ¨height);
		padding: var(--stratakit-space-x2);
		--ğŸ¥Icon-size: 1.5rem;
		border: 1px solid;

		background-color: var(--ğŸŒ€NavigationRailItemAction-state--default, var(--âœ¨bg--default))
			var(--ğŸŒ€NavigationRailItemAction-state--hover, var(--âœ¨bg--hover))
			var(--ğŸŒ€NavigationRailItemAction-state--pressed, var(--âœ¨bg--pressed))
			var(--ğŸŒ€NavigationRailItemAction-state--active, var(--âœ¨bg--active))
			var(--ğŸŒ€NavigationRailItemAction-state--disabled, var(--âœ¨bg--disabled));
		color: var(--ğŸŒ€NavigationRailItemAction-state--default, var(--âœ¨color--default))
			var(--ğŸŒ€NavigationRailItemAction-state--hover, var(--âœ¨color--hover))
			var(--ğŸŒ€NavigationRailItemAction-state--pressed, var(--âœ¨color--pressed))
			var(--ğŸŒ€NavigationRailItemAction-state--active, var(--âœ¨color--active))
			var(--ğŸŒ€NavigationRailItemAction-state--disabled, var(--âœ¨color--disabled));
		--ğŸ¥Icon-color: var(--ğŸŒ€NavigationRailItemAction-state--default, var(--âœ¨icon--default))
			var(--ğŸŒ€NavigationRailItemAction-state--hover, var(--âœ¨icon--hover))
			var(--ğŸŒ€NavigationRailItemAction-state--pressed, var(--âœ¨icon--pressed))
			var(--ğŸŒ€NavigationRailItemAction-state--active, var(--âœ¨icon--active))
			var(--ğŸŒ€NavigationRailItemAction-state--disabled, var(--âœ¨icon--disabled));
		border-color: var(--ğŸŒ€NavigationRailItemAction-state--default, var(--âœ¨border--default))
			var(--ğŸŒ€NavigationRailItemAction-state--hover, var(--âœ¨border--hover))
			var(--ğŸŒ€NavigationRailItemAction-state--pressed, var(--âœ¨border--pressed))
			var(--ğŸŒ€NavigationRailItemAction-state--active, var(--âœ¨border--active))
			var(--ğŸŒ€NavigationRailItemAction-state--disabled, var(--âœ¨border--disabled));

		transition: background-color 150ms ease-out;
		-webkit-tap-highlight-color: var(--stratakit-color-bg-glow-on-surface-neutral-pressed);
	}

	@layer states {
		@media (any-hover: hover) {
			&:where(:hover) {
				--ğŸŒ€NavigationRailItemAction-state: var(--ğŸŒ€NavigationRailItemAction-state--hover);
			}
		}

		/* Reuse hover state when an associated popover is open. */
		&:where([data-has-popover-open]) {
			--ğŸŒ€NavigationRailItemAction-state: var(--ğŸŒ€NavigationRailItemAction-state--hover);
		}

		&:where(:active) {
			--ğŸŒ€NavigationRailItemAction-state: var(--ğŸŒ€NavigationRailItemAction-state--pressed);
		}

		&:where([aria-pressed="true"], [aria-current]:not([aria-current="false"])) {
			--ğŸŒ€NavigationRailItemAction-state: var(--ğŸŒ€NavigationRailItemAction-state--active);
		}

		&:where(:disabled, [aria-disabled="true"]) {
			--ğŸŒ€NavigationRailItemAction-state: var(--ğŸŒ€NavigationRailItemAction-state--disabled);
			cursor: not-allowed;
			-webkit-tap-highlight-color: transparent;
		}
	}

	@layer base.ğŸŒ€ {
		/* See https://kizu.dev/cyclic-toggles/ */
		--ğŸŒ€NavigationRailItemAction-state: var(--ğŸŒ€NavigationRailItemAction-state--default);
		--ğŸŒ€NavigationRailItemAction-state--default: var(--ğŸŒ€NavigationRailItemAction-state,);
		--ğŸŒ€NavigationRailItemAction-state--hover: var(--ğŸŒ€NavigationRailItemAction-state,);
		--ğŸŒ€NavigationRailItemAction-state--pressed: var(--ğŸŒ€NavigationRailItemAction-state,);
		--ğŸŒ€NavigationRailItemAction-state--active: var(--ğŸŒ€NavigationRailItemAction-state,);
		--ğŸŒ€NavigationRailItemAction-state--disabled: var(--ğŸŒ€NavigationRailItemAction-state,);
	}
}

.ğŸ¥NavigationRailItemActionLabel {
	@layer base {
		/* TODO: Find a better solution than truncation. */
		overflow: hidden;
		white-space: nowrap;
		text-overflow: ellipsis;
	}
}

.ğŸ¥NavigationRailFooter {
	@layer base {
		margin-block-start: auto;
	}
}

@media (forced-colors: active) {
	.ğŸ¥NavigationRailItemAction {
		&:where([aria-current]:not([aria-current="false"])) {
			forced-color-adjust: none;
			background-color: SelectedItem;
			border-color: LinkText;
			color: SelectedItemText;
		}
	}
}
