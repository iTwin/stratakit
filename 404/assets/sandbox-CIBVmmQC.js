import{w as te}from"./LMDWO4NN-G2tlRUli.js";import{t as ne,a as n,n as e}from"./chunk-K6AXKMTT-B_QCnNdX.js";import{a as F}from"./index-Dr3kRIaJ.js";import{B as se}from"./Button-vCON22Gs.js";import{D as T}from"./DropdownMenu-BfRW1vk5.js";import{I as w}from"./Icon-08QoRTUL.js";import{I as N}from"./IconButton-4naaWfQF.js";import{S as ae,H as re}from"./Select-DcysZIZs.js";import{T as X,a as le,b as O,c as ie}from"./Tabs-C8V52WZ_.js";import{T as K}from"./Text-CDoFYC-n.js";import{T as oe,a as ce,b as de}from"./TextBox-CW5YR0xs.js";import{V as k}from"./VisuallyHidden-Ce61h_wa.js";import{T as ue,a as fe,b as S}from"./Tree-D3uzSRgV.js";import{p as C}from"./placeholder-CXRUGZqy.js";import{p as pe,l as me,h as he,s as G,d as be,f as xe}from"./visibility-hide-CnRYYOmE.js";import{s as ge}from"./visibility-show-BuFNxMaa.js";import"./index-jyeBNHV5.js";import"./~utils-Cznddkjz.js";import"./X5NMLKT6-xRyrR8vD.js";import"./KUU7WJ55-G7fqY68D.js";import"./LVA2YJMS-DW71ZDOL.js";import"./XL7CSKGW-BS8QFSwD.js";import"./Kbd-B6GfDsHw.js";import"./menu-item-checkbox-D_q-yJax.js";import"./ITI7HKP4-CHsCx14c.js";import"./C3IKGW5T-CJtGBc2Y.js";import"./YV4JVR4I-jdyf4nx_.js";import"./P2CTZE2T-C_Eisgu2.js";import"./RZ4GPYOB-ItWB07lz.js";import"./MTZPJQMC-DX0XKTxx.js";import"./VGCJ63VH-BKwcZMwt.js";import"./BYC7LY2E-BYTmtnol.js";import"./XX67R432-BIy8araW.js";import"./P4IRICAX-B_VUFaE7.js";import"./ASMQKSDT-3ncuFIAz.js";import"./Tooltip-5h5g_kUu.js";import"./tooltip-anchor-D0ihYcSw.js";import"./BOLVLGVE-DTVrBxmX.js";import"./Field-DoPPJIPe.js";import"./~hooks-Wdjhtx2E.js";import"./ListItem-DfQIlsd-.js";import"./~utils-KZaJJO_T.js";import"./~hooks-C5TuCbpZ.js";const Ce="_appLayout_1yfwh_5",je="_header_1yfwh_22",ye="_platformBar_1yfwh_32",Se="_logo_1yfwh_38",_e="_tools_1yfwh_48",ve="_leftPanel_1yfwh_58",Ie="_panelHeader_1yfwh_70",Ae="_panelTitleWrapper_1yfwh_78",Pe="_panelCaption_1yfwh_82",Re="_shiftIconRight_1yfwh_86",we="_subheader_1yfwh_90",Me="_subheaderTitle_1yfwh_101",Te="_searchInput_1yfwh_106",Ne="_subheaderActions_1yfwh_110",ke="_tabList_1yfwh_114",Be="_emptyState_1yfwh_119",ze="_canvasWrapper_1yfwh_128",De="_canvas_1yfwh_128",Ee="_splitter_1yfwh_165",Ke="_tabPanel_1yfwh_211",Le="_tree_1yfwh_219",Fe="_slider_1yfwh_223",x={appLayout:Ce,header:je,platformBar:ye,logo:Se,tools:_e,leftPanel:ve,panelHeader:Ie,panelTitleWrapper:Ae,panelCaption:Pe,shiftIconRight:Re,subheader:we,subheaderTitle:Me,searchInput:Te,subheaderActions:Ne,tabList:ke,emptyState:Be,canvasWrapper:ze,canvas:De,splitter:Ee,tabPanel:Ke,tree:Le,slider:Fe},$="Kiwi sandbox",Ot=()=>[{title:$}],Gt=te(function(){const[a,s]=ne(),l=a.get("tree")==="empty"?"epoch-2":"epoch-1",b=n.useCallback(i=>{s(p=>(i==="epoch-2"?p.set("tree","empty"):p.delete("tree"),p))},[s]),u=n.useMemo(()=>({"epoch-1":"Epoch System iModel 1","epoch-2":"Epoch System iModel 2"}),[]),o=n.useId();return e.jsxs(Xe,{panelContent:e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:x.panelHeader,children:[e.jsxs("div",{children:[e.jsx(k,{render:i=>e.jsx("label",{...i,htmlFor:o}),children:"Choose Model"}),e.jsx(ae,{className:x.panelTitleWrapper,children:e.jsx(re,{id:o,variant:"ghost",defaultValue:l,onChange:i=>b(i.target.value),children:Object.entries(u).map(([i,p])=>e.jsx("option",{value:i,children:p},i))})}),e.jsxs("hgroup",{role:"group",children:[e.jsx(k,{render:i=>e.jsx("h2",{...i}),children:u[l]}),e.jsx("p",{className:x.panelCaption,children:"2024 Refresh"})]})]}),e.jsx("div",{children:e.jsx(N,{className:x.shiftIconRight,icon:pe,label:"Dock panel",variant:"ghost",disabled:!0})})]}),e.jsx(Ye,{children:e.jsxs(Qe,{children:[e.jsx(qe,{}),e.jsx(X,{tabId:"simple",className:x.tabPanel,focusable:!1,children:l==="epoch-2"?e.jsx(H,{}):e.jsx(W,{tree:"simple"})}),e.jsx(X,{tabId:"complex",className:x.tabPanel,focusable:!1,children:l==="epoch-2"?e.jsx(H,{}):e.jsx(W,{tree:"complex"})})]})})]}),children:[e.jsxs("header",{className:x.header,children:[e.jsx("div",{className:x.logo,children:e.jsx(w,{href:C,size:"large"})}),e.jsx(K,{render:i=>e.jsx("h1",{...i}),variant:"body-md",children:$})]}),e.jsx("div",{className:x.platformBar,children:e.jsxs("div",{className:x.tools,children:[e.jsx(w,{href:C,size:"large"}),e.jsx(w,{href:C,size:"large"}),e.jsx(w,{href:C,size:"large"})]})}),e.jsx("div",{className:x.canvasWrapper,children:e.jsx("div",{className:x.canvas})})]})});function Xe(c){const{sliderProps:a,panelProps:s,panelMinSize:l,panelMaxSize:b,resizing:u}=He({minSize:{px:256,pct:20},maxSize:{pct:30}}),o=n.useId();return e.jsxs("div",{className:x.appLayout,style:{"--_panel-min-size":l,"--_panel-max-size":b},children:[e.jsx("div",{...s,className:x.leftPanel,style:{position:"relative",...s.style},children:c.panelContent}),e.jsxs("div",{className:x.splitter,"data-resizing":u?"true":void 0,children:[e.jsx(k,{render:i=>e.jsx("label",{...i,htmlFor:o,children:"Resize layers panel"}),children:"Resize layers panel"}),e.jsx("input",{id:o,type:"range",className:x.slider,...a})]}),c.children]})}function H(){return e.jsxs("div",{className:x.emptyState,children:[e.jsx(K,{variant:"body-sm",children:"No layers"}),e.jsx(se,{children:"Create a layer"})]})}function Oe(){return e.jsx("div",{style:{textAlign:"center"},children:e.jsx(K,{variant:"body-sm",children:"No results found"})})}function Ge(c,a,s){return Math.min(Math.max(c,a),s)}function He(c){const{minSize:a,maxSize:s,onCollapse:l}=c,b=n.useId(),u=n.useRef(null),[o,i]=n.useState(void 0),[p,r]=n.useState(void 0),[f,h]=n.useState(void 0),[m,y]=n.useState(!1),[I,P]=n.useState(void 0),d=n.useMemo(()=>{if(a&&p)return Math.min(a.px,a.pct/100*p)},[a,p]),_=n.useMemo(()=>{if(d&&s&&p)return Math.max(d,s.pct/100*p)},[s,p,d]),v=n.useMemo(()=>{if(f==="smallest")return d??0;if(f==="largest")return _??0;if(o&&d&&_)return Ge(o,d,_)},[o,d,_,f]);n.useEffect(()=>{const g=u.current;if(!g)return;const j=g.parentElement;if(!j)return;const A=new ResizeObserver(()=>{const D=j.getBoundingClientRect(),E=g.getBoundingClientRect();r(D.width),i(E.width)});return A.observe(j),A.observe(g),()=>{A.disconnect()}},[]);const M=n.useCallback(g=>{const j=u.current;if(!j)return;const A=j.getBoundingClientRect();P(A.width+g),h(void 0),y(!0)},[]),z=n.useCallback(g=>{const j=u.current;if(!j)return;const A=j.parentElement;if(!A)return;const D=A.getBoundingClientRect(),E=g*(D.width*.005),ee=j.getBoundingClientRect();P(ee.width+E),h(void 0)},[]),q=n.useCallback(()=>{u.current&&(P(void 0),y(!1))},[]),{moveableProps:R}=We({onMove:M,onMoveEnd:q,onKeyMove:z}),J=n.useMemo(()=>({...R,onKeyDown:g=>{var j;if((j=R.onKeyDown)==null||j.call(R,g),!g.defaultPrevented)switch(g.key){case"Enter":g.preventDefault(),l==null||l();break;case"Home":g.preventDefault(),h("smallest");break;case"End":g.preventDefault(),h("largest");break}},onChange:g=>{if(m)return;const j=Number(g.target.value);P(j)},value:v===void 0?0:Math.floor(v),min:d===void 0?void 0:Math.floor(d),max:_===void 0?void 0:Math.floor(_)}),[R,v,d,_,l,m]),Q=n.useMemo(()=>({style:{WebkitUserSelect:I===void 0?void 0:"none"},id:b,ref:u}),[b,I]),Y=d===void 0?void 0:`${Math.floor(d)}px`,Z=n.useMemo(()=>{if(I!==void 0&&s!==void 0&&f===void 0)return`min(${Math.floor(I)}px, ${s.pct}%)`;if(v!==void 0)return`${Math.floor(v)}px`},[s,I,v,f]);return{sliderProps:J,panelProps:Q,panelMinSize:Y,panelMaxSize:Z,resizing:m}}function We(c){const{onMove:a,onMoveEnd:s,onKeyMove:l}=c,b=n.useRef(null),u=n.useRef(void 0),o=n.useRef(void 0),i=n.useCallback(()=>{o.current!==void 0&&(o.current=void 0,s==null||s())},[s]);return{moveableProps:n.useMemo(()=>({onPointerDown:r=>{if(r.button!==0||r.ctrlKey)return;const f=b.current;if(!f)return;const h=f.getBoundingClientRect(),m=r.clientX-h.left;o.current=m,r.preventDefault(),f.setPointerCapture(r.pointerId)},onPointerMove:r=>{const f=o.current;if(f===void 0)return;const h=b.current;if(!h)return;const m=h.getBoundingClientRect(),y=r.clientX-f-m.left;r.preventDefault(),a==null||a(y)},onPointerUp:i,onPointerCancel:i,onKeyDown:r=>{if(!r.defaultPrevented)switch(r.key){case"ArrowLeft":r.preventDefault(),l==null||l(-1);break;case"ArrowRight":r.preventDefault(),l==null||l(1);break}},ref:r=>{var h;if(b.current=r,(h=u.current)==null||h.call(u),u.current=void 0,!r)return;const f=m=>{m.preventDefault()};r.addEventListener("touchstart",f),u.current=()=>{r.removeEventListener("touchstart",f)}}}),[l,a,i])}}const t=(()=>{let c=0;return a=>({id:`${c++}`,label:`Tree Item ${c}`,items:[],expanded:!0,...a})})(),V={filters:["Guides","Other","Road","Parking lot","Building","Sewer","Project boundary","Map"],items:[t({label:"Guides",type:"Guides",items:[t({label:"Tree",items:[t({label:"Guide 4"}),t({label:"Guide 3"}),t({label:"Guide 2"}),t({label:"Guide 1"})]})]}),t({label:"Other",type:"Other",items:[t({label:"Object 2",items:[t({label:"Path 3"})]}),t({label:"Object 1"})]}),t({label:"Road",type:"Road",items:[t({label:"Parking lot access"}),t({label:"Site access"})]}),t({label:"Parking lot",type:"Parking lot",items:[t({label:"Parking area",items:[t({label:"Bay point 2"}),t({label:"Bay point 1"}),t({label:"Space point 1"}),t({label:"Path 6"})]})]}),t({label:"Building",type:"Building",items:[t({label:"Building area",items:[t({label:"Path 5"})]})]}),t({label:"Sewer",type:"Building",items:[t({label:"Run off pipe",items:[t({label:"Path 4"})]})]}),t({label:"Project boundary",type:"Project boundary",items:[t({label:"Property area",items:[t({label:"Path 1"})]})]}),t({label:"Map",type:"Map",items:[t({label:"Location",items:[t({label:"Terrain"})]})]})]},$e={filters:[],items:[t({label:"ITC_Master",items:[t({label:"002_Substation",expanded:!1,items:[t({label:"002_Substation_A"})]}),t({label:"005-BENROAD-00-XX-M3-D-00003.dgn",expanded:!1,items:[t({label:"005-BENROAD-00-XX-M3-D-00003-A"})]}),t({label:"005-BENROAD-00-XX-M3-D-00005.dgn",expanded:!1,items:[t({label:"005-BENROAD-00-XX-M3-D-00005-A"})]}),t({label:"005-BENROAD-00-XX-M3-G-00002.dgn",expanded:!1,items:[t({label:"005-BENROAD-00-XX-M3-G-00002-A"})]}),t({label:"005-BENROAD-00-XX-M3-G-00003.dgn",expanded:!1,items:[t({label:"005-BENROAD-00-XX-M3-G-00003-A"})]}),t({label:"007-aa_master.dgn",items:[t({label:"A-CLNG-LITE",expanded:!1,items:[t({label:"A-CLNG-LITE-A"})]}),t({label:"A-CLNG-TILE",items:[t({label:"A-DOOR-2D-PLAN",items:[t({label:"P00003 [2-KA62]",items:[t({label:"Cell [2-KA63]",items:[t({label:"Cell [2-KA64]",items:[t({label:"Complex Chain [2-KA6A]"}),t({label:"Complex Chain [2-KA6B]"}),t({label:"Complex Chain [2-KA6C]"}),t({label:"Complex Chain [2-KA6D]"}),t({label:"Complex Chain [2-KA6E]"}),t({label:"Complex Chain [2-KA6F]"}),t({label:"Complex Chain [2-KA6G]"}),t({label:"Complex Chain [2-KA6H]"}),t({label:"Complex Chain [2-KA61]"}),t({label:"Complex Chain [2-KA65]"}),t({label:"Complex Chain [2-KA66]"}),t({label:"Complex Chain [2-KA67]"}),t({label:"Complex Chain [2-KA68]"}),t({label:"Complex Chain [2-KA69]"})]})]})]}),t({label:"P00003 [2-KA74]",expanded:!1,items:[t({label:"P00003 [2-KA74-A]"})]}),t({label:"P00003 [2-KA86]",expanded:!1,items:[t({label:"P00003 [2-KA74-A]"})]}),t({label:"P00003 [2-KA98]",expanded:!1,items:[t({label:"P00003 [2-KA98-A]"})]}),t({label:"P00003 [2-KAAA]",expanded:!1,items:[t({label:"P00003 [2-KAAA-A]"})]})]})]})]})]})]};function Ve({items:c,filters:a,search:s}){const l=n.useMemo(()=>a.length===0?c:c.reduce((o,i)=>(!i.type||!a.includes(i.type)||o.push(i),o),[]),[c,a]),b=n.useMemo(()=>{function o(i){return i.reduce((p,r)=>{const f=o(r.items??[]);return(r.label.toLowerCase().includes(s.toLowerCase())||f.length>0)&&p.push({...r,items:f}),p},[])}return s===""?l:o(l)},[l,s]),u=n.useMemo(()=>{if(a.length===0&&s==="")return;function o(i){return i.reduce((p,r)=>{const f=r.items?o(r.items):0;return p+1+f},0)}return o(b)},[b,a,s]);return{filteredTree:b,itemCount:u}}function Ue(c,a,s){return n.useMemo(()=>{function l(b,u,o,i,p){const r=[];let f=1;for(const h of b){const m=h.id===a||i,y=s.includes(h.id)||p;r.push({...h,level:o,parentItem:u,selected:m,hidden:y,parentHidden:p,position:f++,size:b.length}),h.expanded&&r.push(...l(h.items,h,o+1,m,y))}return r}return l(c,void 0,1,!1,!1)},[c,a,s])}function U(c,a){for(const s of c){if(s.id===a)return s;const l=U(s.items,a);if(l)return l}}function W({tree:c}){const{selectedId:a}=n.useContext(L),{filters:s,search:l,setItemCount:b}=n.useContext(B),[u,o]=n.useState(),[i,p]=n.useState([]),r=n.useCallback(d=>{p(_=>_.includes(d)?_.filter(v=>v!==d):[..._,d])},[]),[f,h]=n.useState(()=>c==="complex"?$e.items:V.items),{filteredTree:m,itemCount:y}=Ve({items:f,filters:s,search:l}),I=Ue(m,u,i);n.useEffect(()=>{c===a&&b(y)},[c,a,b,y]);const P=n.useDeferredValue(I);return P.length===0?e.jsx(Oe,{}):e.jsx(n.Suspense,{fallback:"Loading...",children:e.jsx(ue,{className:x.tree,children:P.map(d=>e.jsx(fe,{label:d.label,"aria-level":d.level,"aria-posinset":d.position,"aria-setsize":d.size,selected:d.selected,onSelectedChange:()=>{if(u===d.id){o(void 0);return}o(d.id)},expanded:d.items.length===0?void 0:d.expanded,onExpandedChange:_=>{h(v=>{const M=U(v,d.id);if(!M)return v;const z=[...v];return M.expanded=_,z})},icon:e.jsx(w,{href:C,style:{display:"inline"}}),actions:[e.jsx(S,{icon:me,label:"Lock",visible:d.hidden?!1:void 0},"lock"),e.jsx(S,{icon:d.hidden?he:ge,label:d.hidden?"Show":"Hide",visible:d.hidden?!0:void 0,onClick:()=>{r(d.id)}},"visibility"),e.jsx(S,{label:"Copy",icon:C},"copy"),e.jsx(S,{label:"Paste",icon:C},"paste"),e.jsx(S,{label:"Copy/Paste as",icon:C},"copy-paste"),e.jsx(S,{label:"Move to",icon:C},"move"),e.jsx(S,{label:"Bring to front",icon:C},"bring-to-front"),e.jsx(S,{label:"Send to back",icon:C},"send-to-back"),e.jsx(S,{label:"Group selection",icon:C},"group"),e.jsx(S,{label:"Ungroup",icon:C},"ungroup"),e.jsx(S,{label:"Rename",icon:C},"rename"),e.jsx(S,{label:"Show/hide",icon:C},"show-hide"),e.jsx(S,{label:"Lock/unlock",icon:C},"lock-unlock"),e.jsx(S,{label:"Isolate object",icon:C},"isolate")]},d.id))})})}function qe(){const{selectedId:c}=n.useContext(L),{itemCount:a,filtered:s,clearFilters:l,search:b,setSearch:u}=n.useContext(B),[o,i]=n.useState(!1),p=n.useRef(null),r=n.useRef(null),f=o?e.jsxs(e.Fragment,{children:[e.jsx(Je,{filters:c==="simple"?V.filters:[]}),e.jsx(N,{className:x.shiftIconRight,icon:be,label:"Close",variant:"ghost",onClick:()=>{var m;u(""),l(),F.flushSync(()=>i(!1)),(m=r.current)==null||m.focus()}})]}):e.jsx(N,{className:x.shiftIconRight,icon:G,label:"Search",variant:"ghost",onClick:()=>{var m;F.flushSync(()=>i(!0)),(m=p.current)==null||m.focus()}}),h=n.useMemo(()=>{if(s)return a===void 0?"Showing all tree items":`Showing ${a} tree items`},[s,a]);return e.jsxs("div",{className:x.subheader,children:[e.jsx(k,{"aria-live":"polite","aria-atomic":!0,children:h}),o?void 0:e.jsxs(le,{className:x.tabList,tone:"accent",ref:r,children:[e.jsx(O,{id:"simple",children:"Simple"}),e.jsx(O,{id:"complex",children:"Complex"})]}),o?e.jsxs(oe,{className:x.searchInput,children:[e.jsx(ce,{href:G}),e.jsx(de,{placeholder:"Search",ref:p,onChange:m=>{u(m.target.value)},value:b})]}):null,e.jsx("div",{className:x.subheaderActions,children:f})]})}function Je({filters:c}){const a=n.useContext(B);return e.jsxs(T.Root,{children:[e.jsx(T.Button,{render:e.jsx(N,{icon:xe,label:"Filter",variant:"ghost",disabled:c.length===0,isActive:a.filters.length>0})}),e.jsx(T.Content,{children:c.map(s=>{const l=a.filters.includes(s);return e.jsx(T.CheckboxItem,{name:s,checked:l,onChange:()=>{a.toggleFilter(s)},children:s},s)})})]})}function Qe(c){const[a,s]=n.useState(!1),[l,b]=n.useState([]),[u,o]=n.useState(""),[i,p]=n.useState(void 0),r=n.useCallback(m=>{b(y=>y.includes(m)?y.filter(I=>I!==m):[...y,m]),s(!0)},[]),f=n.useCallback(()=>{b([]),s(!0)},[]),h=n.useCallback(m=>{o(m),s(!0)},[]);return e.jsx(B.Provider,{value:n.useMemo(()=>({filters:l,filtered:a,toggleFilter:r,clearFilters:f,search:u,setSearch:h,itemCount:i,setItemCount:p}),[l,a,r,f,u,h,i]),children:c.children})}function Ye(c){const[a,s]=n.useState(void 0);return e.jsx(L.Provider,{value:n.useMemo(()=>({selectedId:a??""}),[a]),children:e.jsx(ie,{setSelectedId:s,selectedId:a,children:c.children})})}const B=n.createContext({filters:[],filtered:!1,toggleFilter:()=>{},clearFilters:()=>{},search:"",setSearch:()=>{},itemCount:void 0,setItemCount:()=>{}}),L=n.createContext({selectedId:""});export{Gt as default,Ot as meta};
