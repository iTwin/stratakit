import{Y as ue,aC as Y,aA as le,J as fe,L as ce,$ as de,a1 as me,bd as pe,a4 as P,M as w,a3 as R,be,bf as F,aD as A,bg as ve,aQ as V,bh as Ie,bi as ge,ap as Ce,a5 as xe,bj as Se,a6 as Pe,Z as we,bk as he,bl as Ee,F as ye,K as Te}from"./~utils-W0hTFgn7.js";import{e as De,g as Re,a as Fe}from"./RZ4GPYOB-DWe4jsKc.js";import{b as p,q as Ae}from"./index-BoeBPSKS.js";var h=ue([Re],[De]),Oe=h.useContext,Qe=h.useProviderContext,Ze=h.ContextProvider,$e=h.ScopedContextProvider,ke=p.createContext(void 0),_e=p.createContext(void 0),Ke={id:null};function Xe(r,n,o=!1){const t=r.findIndex(f=>f.id===n);return[...r.slice(t+1),...o?[Ke]:[],...r.slice(0,t)]}function et(r,n){return r.find(o=>!o.disabled)}function Le(r,n){return n&&r.item(n)||null}function tt(r){const n=[];for(const o of r){const t=n.find(f=>{var d;return((d=f[0])==null?void 0:d.rowId)===o.rowId});t?t.push(o):n.push([o])}return n}function ze(r,n=!1){if(Y(r))r.setSelectionRange(n?r.value.length:0,r.value.length);else if(r.isContentEditable){const o=le(r).getSelection();o==null||o.selectAllChildren(r),n&&(o==null||o.collapseToEnd())}}var O=Symbol("FOCUS_SILENTLY");function Me(r){r[O]=!0,r.focus({preventScroll:!0})}function rt(r){const n=r[O];return delete r[O],n}function W(r,n,o){return!(!n||n===o||!r.item(n.id))}var Ne="button";function Be(r){return F(r)?!0:r.tagName==="INPUT"&&!he(r)}function He(r,n=!1){const o=r.clientHeight,{top:t}=r.getBoundingClientRect(),f=Math.max(o*.875,o-40)*1.5,d=n?o-f+t:f+t;return r.tagName==="HTML"?d+r.scrollTop:d}function Ue(r,n=!1){const{top:o}=r.getBoundingClientRect();return n?o+r.clientHeight:o}function j(r,n,o,t=!1){var f;if(!n||!o)return;const{renderedItems:d}=n.getState(),C=Ee(r);if(!C)return;const E=He(C,t);let c,b;for(let v=0;v<d.length;v+=1){const i=c;if(c=o(v),!c)break;if(c===i)continue;const x=(f=Le(n,c))==null?void 0:f.element;if(!x)continue;const I=Ue(x,t)-E,u=Math.abs(I);if(t&&I<=0||!t&&I>=0){b!==void 0&&b<u&&(c=i);break}b=u}return c}function Ve(r,n){return A(r)?!1:W(n,r.target)}var je=fe(function(n){var o=n,{store:t,rowId:f,preventScrollOnKeyDown:d=!1,moveOnKeyPress:C=!0,tabbable:E=!1,getItem:c,"aria-setsize":b,"aria-posinset":v}=o,i=ce(o,["store","rowId","preventScrollOnKeyDown","moveOnKeyPress","tabbable","getItem","aria-setsize","aria-posinset"]);const x=Oe();t=t||x;const l=de(i.id),I=p.useRef(null),u=p.useContext(_e),k=me(i)&&!i.accessibleWhenDisabled,{rowId:y,baseElement:_,isActiveItem:q,ariaSetSize:G,ariaPosInSet:J,isTabbable:Q}=pe(t,{rowId(e){if(f)return f;if(e&&u!=null&&u.baseElement&&u.baseElement===e.baseElement)return u.id},baseElement(e){return(e==null?void 0:e.baseElement)||void 0},isActiveItem(e){return!!e&&e.activeId===l},ariaSetSize(e){if(b!=null)return b;if(e&&u!=null&&u.ariaSetSize&&u.baseElement===e.baseElement)return u.ariaSetSize},ariaPosInSet(e){if(v!=null)return v;if(!e||!(u!=null&&u.ariaPosInSet)||u.baseElement!==e.baseElement)return;const s=e.renderedItems.filter(a=>a.rowId===y);return u.ariaPosInSet+s.findIndex(a=>a.id===l)},isTabbable(e){if(!(e!=null&&e.renderedItems.length))return!0;if(e.virtualFocus)return!1;if(E)return!0;if(e.activeId===null)return!1;const s=t==null?void 0:t.item(e.activeId);return s!=null&&s.disabled||!(s!=null&&s.element)?!0:e.activeId===l}}),Z=p.useCallback(e=>{var s;const a=P(w({},e),{id:l||e.id,rowId:y,disabled:!!k,children:(s=e.element)==null?void 0:s.textContent});return c?c(a):a},[l,y,k,c]),K=i.onFocus,T=p.useRef(!1),$=R(e=>{if(K==null||K(e),e.defaultPrevented||be(e)||!l||!t||Ve(e,t))return;const{virtualFocus:s,baseElement:a}=t.getState();if(t.setActiveId(l),F(e.currentTarget)&&ze(e.currentTarget),!s||!A(e)||Be(e.currentTarget)||!(a!=null&&a.isConnected))return;ve()&&e.currentTarget.hasAttribute("data-autofocus")&&e.currentTarget.scrollIntoView({block:"nearest",inline:"nearest"}),T.current=!0,e.relatedTarget===a||W(t,e.relatedTarget)?Me(a):a.focus()}),L=i.onBlurCapture,X=R(e=>{if(L==null||L(e),e.defaultPrevented)return;const s=t==null?void 0:t.getState();s!=null&&s.virtualFocus&&T.current&&(T.current=!1,e.preventDefault(),e.stopPropagation())}),z=i.onKeyDown,ee=V(d),te=V(C),re=R(e=>{if(z==null||z(e),e.defaultPrevented||!A(e)||!t)return;const{currentTarget:s}=e,a=t.getState(),D=t.item(l),m=!!(D!=null&&D.rowId),S=a.orientation!=="horizontal",g=a.orientation!=="vertical",N=()=>!!(m||g||!a.baseElement||!Y(a.baseElement)),B={ArrowUp:(m||S)&&t.up,ArrowRight:(m||g)&&t.next,ArrowDown:(m||S)&&t.down,ArrowLeft:(m||g)&&t.previous,Home:()=>{if(N())return!m||e.ctrlKey?t==null?void 0:t.first():t==null?void 0:t.previous(-1)},End:()=>{if(N())return!m||e.ctrlKey?t==null?void 0:t.last():t==null?void 0:t.next(-1)},PageUp:()=>j(s,t,t==null?void 0:t.up,!0),PageDown:()=>j(s,t,t==null?void 0:t.down)}[e.key];if(B){if(F(s)){const U=Ie(s),ne=g&&e.key==="ArrowLeft",oe=g&&e.key==="ArrowRight",ie=S&&e.key==="ArrowUp",se=S&&e.key==="ArrowDown";if(oe||se){const{length:ae}=ge(s);if(U.end!==ae)return}else if((ne||ie)&&U.start!==0)return}const H=B();if(ee(e)||H!==void 0){if(!te(e))return;e.preventDefault(),t.move(H)}}}),M=p.useMemo(()=>({id:l,baseElement:_}),[l,_]);return i=Ce(i,e=>Ae.jsx(ke.Provider,{value:M,children:e}),[M]),i=P(w({id:l,"data-active-item":q||void 0},i),{ref:xe(I,i.ref),tabIndex:Q?i.tabIndex:-1,onFocus:$,onBlurCapture:X,onKeyDown:re}),i=Se(i),i=Fe(P(w({store:t},i),{getItem:Z,shouldRegisterItem:l?i.shouldRegisterItem:!1})),Pe(P(w({},i),{"aria-setsize":G,"aria-posinset":J}))}),nt=we(ye(function(n){const o=je(n);return Te(Ne,o)}));export{$e as C,Ze as a,nt as b,Oe as c,Qe as d,et as e,Xe as f,Le as g,tt as h,W as i,rt as s,je as u};
