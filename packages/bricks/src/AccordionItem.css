/*---------------------------------------------------------------------------------------------
 * Copyright (c) Bentley Systems, Incorporated. All rights reserved.
 * See LICENSE.md in the project root for license terms and full copyright notice.
 *--------------------------------------------------------------------------------------------*/

.ğŸ¥-accordion-item {
	--âœ¨focus-outline: 2px solid var(--ids-color-border-accent-strong);

	--ğŸ¥accordion-item-gap: 12px;
	--ğŸ¥accordion-item-padding: 12px;
	--ğŸ¥accordion-item-transition-duration: 150ms;
	--ğŸ¥accordion-item-transition-timing-function: linear;

	@layer base {
		contain: paint;
		display: grid;
		/* biome-ignore format: improve readability */
		grid-template-columns:
			[decoration-before-start] auto [decoration-before-end
			content-start] minmax(0, 1fr) [content-end
			decoration-after-start] auto [decoration-after-end];
		grid-template-rows: [trigger-start] auto [trigger-end content-start] auto [content-end];
		border-block-end: 1px solid var(--ids-color-border-neutral-muted);
	}
}

.ğŸ¥-accordion-item-trigger {
	@layer base {
		grid-row: trigger;
		grid-column: decoration-before-start / decoration-after-end;

		display: grid;
		align-items: center;
		padding: var(--ğŸ¥accordion-item-padding);
		border-radius: 12px;
		outline-offset: -4px;
		cursor: pointer;
		text-box: cap alphabetic;

		/* TODO: improve the layout for the fallback (i.e. content doesnâ€™t align with the label if thereâ€™s a decoration) */
		grid-template-columns: inherit;

		@supports (grid-template-columns: subgrid) {
			grid-template-columns: subgrid;
		}
	}

	@layer states {
		@media (any-hover: hover) {
			&:hover .ğŸ¥-button {
				--ğŸŒ€button-state: var(--ğŸŒ€button-state--hover);
			}
		}

		&:where([aria-expanded="true"]) {
			--ğŸ¥chevron-down-rotate: -0.5turn;
		}
	}
}

.ğŸ¥-accordion-item-marker {
	@layer base {
		grid-row: 1;
		grid-column: decoration-after;
		margin-inline-start: var(--ğŸ¥accordion-item-gap);
		/* TODO: We can only use GhostAligner to apply alignment to block or inline, so weâ€™re manually applying it here. */
		margin-inline-end: calc(-1 * var(--ğŸ¥ghost-inline-offset));

		transition: background-color var(--ğŸ¥-accordion-item-transition-duration)
			var(--ğŸ¥accordion-item-transition-timing-function);

		.ğŸ¥-chevron-down {
			transition-property: rotate, color;
			transition-duration: var(--ğŸ¥accordion-item-transition-duration);
			transition-timing-function: var(--ğŸ¥accordion-item-transition-timing-function);
		}
	}
}

.ğŸ¥-accordion-item-label:is(.ğŸ¥-text) {
	@layer base {
		grid-column: content;
		hyphens: auto;
		word-break: break-word;
		text-box: cap alphabetic;
	}
}

.ğŸ¥-accordion-item-content {
	--âœ¨total-duration: var(--ğŸ¥accordion-item-transition-duration);

	@layer base {
		grid-row: content;
		grid-column: content;
		padding-block-end: var(--ğŸ¥accordion-item-padding);
		text-box: cap alphabetic;
		color: var(--ids-color-text-neutral-secondary);
	}

	@layer states {
		@media (prefers-reduced-motion: no-preference) {
			@supports (interpolate-size: allow-keywords) and (transition-behavior: allow-discrete) {
				/* Exit transition */
				&:where(:not([data-enter])) {
					opacity: 0;
					block-size: 0;
					padding-block-end: 0;
					/* biome-ignore format: improve readability */
					transition:
							display 0s var(--âœ¨total-duration) allow-discrete,
							block-size var(--âœ¨total-duration) allow-discrete,
							padding var(--âœ¨total-duration),
							opacity calc(var(--âœ¨total-duration) * 1 / 3);
					transition-timing-function: var(--ğŸ¥accordion-item-transition-timing-function);
				}

				/* Entrance transition */
				&:where([data-enter]) {
					/* biome-ignore format: improve readability */
					transition:
						padding var(--âœ¨total-duration),
						block-size var(--âœ¨total-duration) allow-discrete,
						opacity calc(var(--âœ¨total-duration) * 2 / 3) calc(var(--âœ¨total-duration) * 2 / 3);
					transition-timing-function: var(--ğŸ¥accordion-item-transition-timing-function);
				}
			}
		}
	}
}

.ğŸ¥-accordion-item-decoration {
	@layer base {
		grid-column: decoration-before;
		margin-inline-end: var(--ğŸ¥accordion-item-gap);
	}
}
