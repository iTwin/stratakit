/*---------------------------------------------------------------------------------------------
 * Copyright (c) Bentley Systems, Incorporated. All rights reserved.
 * See LICENSE.md in the project root for license terms and full copyright notice.
 *--------------------------------------------------------------------------------------------*/
.ğŸ¥SelectRoot {
	@layer base {
		&:where(:has(select.ğŸ¥Select), [data-_sk-has-select="true"]) {
			display: inline-grid;
			align-items: center;
			isolation: isolate;

			> * {
				grid-area: 1 / 1 / -1 / -1;
			}
		}

		&:has(.ğŸ¥-select:open) {
			--ğŸ¥disclosure-arrow-rotate: 0.5turn;
		}
	}
}

.ğŸ¥Select:is(.ğŸ¥Button) {
	--âœ¨padding-inline-start: var(--stratakit-space-x2);
	--âœ¨padding-inline-end: calc(
		var(--stratakit-space-x1) /* Gap */ +
		var(--stratakit-space-x4) /* Arrow size */ +
		var(--stratakit-space-x1) /* Padding - disclosure arrow offset */
	);

	@layer base {
		min-inline-size: calc(var(--âœ¨padding-inline-start) + 1ch + var(--âœ¨padding-inline-end));
		text-overflow: ellipsis;

		&:where(select:not([multiple])) {
			appearance: none;
			--ğŸ¥Button-padding-inline: var(--âœ¨padding-inline-start) var(--âœ¨padding-inline-end);
			--ğŸ¥GhostAligner-inline-offset: var(--âœ¨padding-inline-start);

			/* > option {
				background-color: var(--stratakit-color-bg-neutral-base);
			} */
		}

		&:where(select) {
			appearance: base-select;

			&::picker-icon {
				display: none;
			}
		}
	}
}

.ğŸ¥SelectArrow:is(.ğŸ¥DisclosureArrow) {
	@layer base {
		justify-self: end;
		margin-inline-end: var(--stratakit-space-x1); /* (padding - disclosure offset) */
		pointer-events: none;
		z-index: 1; /* should be above the button */

		--ğŸ¥Icon-color: var(--ğŸŒ€SelectArrow-state--default, var(--stratakit-color-icon-neutral-base))
			var(--ğŸŒ€SelectArrow-state--hover, var(--stratakit-color-icon-neutral-hover))
			var(--ğŸŒ€SelectArrow-state--disabled, var(--stratakit-color-icon-neutral-disabled));
	}

	@layer states {
		@media (any-hover: hover) {
			:where(.ğŸ¥Select:hover) + & {
				--ğŸŒ€SelectArrow-state: var(--ğŸŒ€SelectArrow-state--hover);
			}
		}

		:where(.ğŸ¥Select:disabled) + & {
			--ğŸŒ€SelectArrow-state: var(--ğŸŒ€SelectArrow-state--disabled);
		}
	}

	@layer base.ğŸŒ€ {
		--ğŸŒ€SelectArrow-state: var(--ğŸŒ€SelectArrow-state--default);
		--ğŸŒ€SelectArrow-state--default: var(--ğŸŒ€SelectArrow-state,);
		--ğŸŒ€SelectArrow-state--hover: var(--ğŸŒ€SelectArrow-state,);
		--ğŸŒ€SelectArrow-state--disabled: var(--ğŸŒ€SelectArrow-state,);
	}
}

selectedcontent {
	@layer base {
		display: inline-flex;
		align-items: center;
		flex-shrink: 0;
		gap: var(--stratakit-space-x1);
	}
}

option {
	/* --âœ¨bg--default: var(--stratakit-color-bg-neutral-base); */
	--âœ¨bg--default: transparent;
	--âœ¨bg--hover: var(--stratakit-color-bg-glow-on-surface-neutral-hover);
	--âœ¨bg--pressed: var(--stratakit-color-bg-glow-on-surface-neutral-pressed);
	--âœ¨bg--disabled: transparent;

	--âœ¨color--default: var(--stratakit-color-text-neutral-primary);
	--âœ¨color--active: var(--stratakit-color-text-accent-strong);
	--âœ¨color--disabled: var(--âœ¨bg--disabled);

	@layer base {
		border-radius: 4px;
		padding-inline: 4px;

		background-color: var(--ğŸ¥select-option-background-color);

		--ğŸ¥select-option-background-color: var(--ğŸŒ€select-option-state--default, var(--âœ¨bg--default))
			var(--ğŸŒ€select-option-state--hover, var(--âœ¨bg--hover))
			var(--ğŸŒ€select-option-state--pressed, var(--âœ¨bg--pressed))
			var(--ğŸŒ€select-option-state--disabled, var(--âœ¨bg--default));

		color: var(--stratakit-color-text-neutral-primary);

		--ğŸ¥icon-color: var(--ğŸŒ€select-option-state--default, var(--stratakit-color-icon-neutral-base))
			var(--ğŸŒ€select-option-state--hover, var(--stratakit-color-icon-neutral-hover))
			var(--ğŸŒ€select-option-state--pressed, var(--stratakit-color-icon-neutral-hover))
			var(--ğŸŒ€select-option-state--active, var(--stratakit-color-icon-accent-strong))
			var(--ğŸŒ€select-option-state--active-hover, var(--stratakit-color-icon-accent-strong))
			var(--ğŸŒ€select-option-state--disabled, var(--stratakit-color-icon-neutral-disabled));

		&::checkmark {
			order: 1;
			margin-left: auto;
			content: "âœ“";
			color: var(--stratakit-color-icon-neutral-base);
		}
	}

	@layer states {
		@media (any-hover: hover) {
			&:where(:hover) {
				--ğŸŒ€select-option-state: var(--ğŸŒ€select-option-state--hover);
			}
		}

		&:where(:active) {
			--ğŸŒ€select-option-state: var(--ğŸŒ€select-option-state--pressed);
		}

		&:where(:disabled, [aria-disabled="true"]) {
			--ğŸŒ€select-option-state: var(--ğŸŒ€select-option-state--disabled);
			cursor: not-allowed;
			color: var(--stratakit-color-text-neutral-disabled);
		}
	}

	@layer base.ğŸŒ€ {
		/* See https://kizu.dev/cyclic-toggles/ */
		--ğŸŒ€select-option-state: var(--ğŸŒ€select-option-state--default);
		--ğŸŒ€select-option-state--default: var(--ğŸŒ€select-option-state,);
		--ğŸŒ€select-option-state--hover: var(--ğŸŒ€select-option-state,);
		--ğŸŒ€select-option-state--pressed: var(--ğŸŒ€select-option-state,);
		--ğŸŒ€select-option-state--active: var(--ğŸŒ€select-option-state,);
		--ğŸŒ€select-option-state--active-hover: var(--ğŸŒ€select-option-state,);
		--ğŸŒ€select-option-state--disabled: var(--ğŸŒ€select-option-state,);
	}
}

@media (forced-colors: active) {
	option {
		&:where(:checked) {
			forced-color-adjust: none;
			background-color: SelectedItem;
			color: SelectedItemText;
		}

		&:where(:disabled, [aria-disabled="true"]) {
			color: GrayText;
		}
	}
}
