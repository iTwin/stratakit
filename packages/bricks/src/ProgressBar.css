/*---------------------------------------------------------------------------------------------
 * Copyright (c) Bentley Systems, Incorporated. All rights reserved.
 * See LICENSE.md in the project root for license terms and full copyright notice.
 *--------------------------------------------------------------------------------------------*/

.-progress-bar {
	--牢ount: 4;
	--牡uration: 1.5s;
	--牠asing: cubic-bezier(0.5, 0, 0.5, 1);
	--究teps: 4;

	--災nimation--indeterminate-steps: calc(var(--究teps) * var(--牡uration))
		--progress-bar-animation-indeterminate steps(var(--究teps), end) infinite;
	--災nimation--indeterminate: var(--牡uration) --progress-bar-animation-indeterminate
		var(--牠asing) var(--牢ount);
	--災nimation--indeterminate-slow: calc(var(--牡uration) * 2)
		--progress-bar-animation-indeterminate-slow var(--牠asing)
		calc(var(--牢ount) * var(--牡uration)) infinite;

	@layer base {
		block-size: var(--progress-bar-size);
		inline-size: 100%;
		border-radius: 9999px;
		contain: strict;
		display: grid;
		background-color: var(--progress-bar-track-color);

		&::before {
			content: "";
			block-size: inherit;
			inline-size: var(--progress-bar-fill-size);
			border-radius: inherit;
			background-color: var(--progress-bar-fill-color);
			animation: var(--progress-bar-animation);
		}
	}

	@layer modifiers {
		&:where([data-kiwi-tone="neutral"]) {
			--progress-bar-fill-color: var(--ids-color-icon-neutral-base);
			--progress-bar-track-color: var(--ids-color-border-page-base);
		}

		&:where([data-kiwi-tone="accent"]) {
			--progress-bar-fill-color: var(--ids-color-icon-accent-strong);
			--progress-bar-track-color: var(--ids-color-bg-accent-muted);
		}

		&:where([data-kiwi-size="small"]) {
			--progress-bar-size: 0.063rem;
		}

		&:where([data-kiwi-size="medium"]) {
			--progress-bar-size: 0.125rem;
		}

		&:where([data-kiwi-size="large"]) {
			--progress-bar-size: 0.25rem;
		}

		&:where([data-kiwi-variant="indeterminate"]) {
			--progress-bar-animation: var(--災nimation--indeterminate-steps);
			--progress-bar-fill-size: 25%;

			@media (prefers-reduced-motion: no-preference) {
				--progress-bar-animation: var(--災nimation--indeterminate),
					var(--災nimation--indeterminate-slow);
			}
		}
	}
}

@keyframes --progress-bar-animation-indeterminate {
	from {
		transform: translateX(-100%); /* -100% moves the fill out of view on the left side. */
	}

	to {
		transform: translateX(400%); /* The fill is 25% width of the container, multiplied by 4 moves the fill out of view on the right side. */
	}
}

@keyframes --progress-bar-animation-indeterminate-slow {
	0% {
		transform: translateX(-100%); /* -100% moves the fill out of view on the left side. */
	}
	50% {
		transform: translateX(-95%); /* Simulate a short slowdown between each cycle to help with WCAG SC 2.2.2. */
	}
	100% {
		transform: translateX(400%); /* The fill is 25% width of the container, multiplied by 4 moves the fill out of view on the right side. */
	}
}

@media (forced-colors: active) {
	.-progress-bar {
		--progress-bar-fill-color: Canvas;
		--progress-bar-track-color: CanvasText;
		outline: calc(var(--progress-bar-size) * 0.5) solid CanvasText;
	}
}
