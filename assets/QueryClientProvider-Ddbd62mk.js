import{a as w,p as Q}from"./chunk-C37GKA54-CQGMo0Pk.js";var P=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},p=typeof window>"u"||"Deno"in globalThis;function j(){}function ot(t,e){return typeof t=="function"?t(e):t}function k(t){return typeof t=="number"&&t>=0&&t!==1/0}function I(t,e){return Math.max(t+(e||0)-Date.now(),0)}function G(t,e){return typeof t=="function"?t(e):t}function H(t,e){return typeof t=="function"?t(e):t}function at(t,e){const{type:s="all",exact:r,fetchStatus:n,predicate:a,queryKey:u,stale:o}=t;if(u){if(r){if(e.queryHash!==N(u,e.options))return!1}else if(!O(e.queryKey,u))return!1}if(s!=="all"){const i=e.isActive();if(s==="active"&&!i||s==="inactive"&&i)return!1}return!(typeof o=="boolean"&&e.isStale()!==o||n&&n!==e.state.fetchStatus||a&&!a(e))}function ut(t,e){const{exact:s,status:r,predicate:n,mutationKey:a}=t;if(a){if(!e.options.mutationKey)return!1;if(s){if(g(e.options.mutationKey)!==g(a))return!1}else if(!O(e.options.mutationKey,a))return!1}return!(r&&e.state.status!==r||n&&!n(e))}function N(t,e){return(e?.queryKeyHashFn||g)(t)}function g(t){return JSON.stringify(t,(e,s)=>C(s)?Object.keys(s).sort().reduce((r,n)=>(r[n]=s[n],r),{}):s)}function O(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?Object.keys(e).every(s=>O(t[s],e[s])):!1}function U(t,e){if(t===e)return t;const s=q(t)&&q(e);if(s||C(t)&&C(e)){const r=s?t:Object.keys(t),n=r.length,a=s?e:Object.keys(e),u=a.length,o=s?[]:{},i=new Set(r);let h=0;for(let f=0;f<u;f++){const c=s?f:a[f];(!s&&i.has(c)||s)&&t[c]===void 0&&e[c]===void 0?(o[c]=void 0,h++):(o[c]=U(t[c],e[c]),o[c]===t[c]&&t[c]!==void 0&&h++)}return n===u&&h===n?t:o}return e}function ct(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const s in t)if(t[s]!==e[s])return!1;return!0}function q(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function C(t){if(!R(t))return!1;const e=t.constructor;if(e===void 0)return!0;const s=e.prototype;return!(!R(s)||!s.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function R(t){return Object.prototype.toString.call(t)==="[object Object]"}function z(t){return new Promise(e=>{setTimeout(e,t)})}function B(t,e,s){return typeof s.structuralSharing=="function"?s.structuralSharing(t,e):s.structuralSharing!==!1?U(t,e):e}function ht(t,e,s=0){const r=[...t,e];return s&&r.length>s?r.slice(1):r}function lt(t,e,s=0){const r=[e,...t];return s&&r.length>s?r.slice(0,-1):r}var T=Symbol();function V(t,e){return!t.queryFn&&e?.initialPromise?()=>e.initialPromise:!t.queryFn||t.queryFn===T?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}function ft(t,e){return typeof t=="function"?t(...e):!!t}var $=class extends P{#t;#s;#e;constructor(){super(),this.#e=t=>{if(!p&&window.addEventListener){const e=()=>t();return window.addEventListener("visibilitychange",e,!1),()=>{window.removeEventListener("visibilitychange",e)}}}}onSubscribe(){this.#s||this.setEventListener(this.#e)}onUnsubscribe(){this.hasListeners()||(this.#s?.(),this.#s=void 0)}setEventListener(t){this.#e=t,this.#s?.(),this.#s=t(e=>{typeof e=="boolean"?this.setFocused(e):this.onFocus()})}setFocused(t){this.#t!==t&&(this.#t=t,this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(e=>{e(t)})}isFocused(){return typeof this.#t=="boolean"?this.#t:globalThis.document?.visibilityState!=="hidden"}},J=new $,W=class extends P{#t=!0;#s;#e;constructor(){super(),this.#e=t=>{if(!p&&window.addEventListener){const e=()=>t(!0),s=()=>t(!1);return window.addEventListener("online",e,!1),window.addEventListener("offline",s,!1),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",s)}}}}onSubscribe(){this.#s||this.setEventListener(this.#e)}onUnsubscribe(){this.hasListeners()||(this.#s?.(),this.#s=void 0)}setEventListener(t){this.#e=t,this.#s?.(),this.#s=t(this.setOnline.bind(this))}setOnline(t){this.#t!==t&&(this.#t=t,this.listeners.forEach(s=>{s(t)}))}isOnline(){return this.#t}},x=new W;function _(){let t,e;const s=new Promise((n,a)=>{t=n,e=a});s.status="pending",s.catch(()=>{});function r(n){Object.assign(s,n),delete s.resolve,delete s.reject}return s.resolve=n=>{r({status:"fulfilled",value:n}),t(n)},s.reject=n=>{r({status:"rejected",reason:n}),e(n)},s}function X(t){return Math.min(1e3*2**t,3e4)}function D(t){return(t??"online")==="online"?x.isOnline():!0}var A=class extends Error{constructor(t){super("CancelledError"),this.revert=t?.revert,this.silent=t?.silent}};function F(t){return t instanceof A}function Y(t){let e=!1,s=0,r=!1,n;const a=_(),u=l=>{r||(v(new A(l)),t.abort?.())},o=()=>{e=!0},i=()=>{e=!1},h=()=>J.isFocused()&&(t.networkMode==="always"||x.isOnline())&&t.canRun(),f=()=>D(t.networkMode)&&t.canRun(),c=l=>{r||(r=!0,t.onSuccess?.(l),n?.(),a.resolve(l))},v=l=>{r||(r=!0,t.onError?.(l),n?.(),a.reject(l))},E=()=>new Promise(l=>{n=m=>{(r||h())&&l(m)},t.onPause?.()}).then(()=>{n=void 0,r||t.onContinue?.()}),b=()=>{if(r)return;let l;const m=s===0?t.initialPromise:void 0;try{l=m??t.fn()}catch(d){l=Promise.reject(d)}Promise.resolve(l).then(c).catch(d=>{if(r)return;const y=t.retry??(p?0:3),S=t.retryDelay??X,L=typeof S=="function"?S(s,d):S,K=y===!0||typeof y=="number"&&s<y||typeof y=="function"&&y(s,d);if(e||!K){v(d);return}s++,t.onFail?.(s,d),z(L).then(()=>h()?void 0:E()).then(()=>{e?v(d):b()})})};return{promise:a,cancel:u,continue:()=>(n?.(),a),cancelRetry:o,continueRetry:i,canStart:f,start:()=>(f()?b():E().then(b),a)}}var Z=t=>setTimeout(t,0);function tt(){let t=[],e=0,s=o=>{o()},r=o=>{o()},n=Z;const a=o=>{e?t.push(o):n(()=>{s(o)})},u=()=>{const o=t;t=[],o.length&&n(()=>{r(()=>{o.forEach(i=>{s(i)})})})};return{batch:o=>{let i;e++;try{i=o()}finally{e--,e||u()}return i},batchCalls:o=>(...i)=>{a(()=>{o(...i)})},schedule:a,setNotifyFunction:o=>{s=o},setBatchNotifyFunction:o=>{r=o},setScheduler:o=>{n=o}}}var et=tt(),st=class{#t;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),k(this.gcTime)&&(this.#t=setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(p?1/0:300*1e3))}clearGcTimeout(){this.#t&&(clearTimeout(this.#t),this.#t=void 0)}},dt=class extends st{#t;#s;#e;#n;#r;#a;#o;constructor(t){super(),this.#o=!1,this.#a=t.defaultOptions,this.setOptions(t.options),this.observers=[],this.#n=t.client,this.#e=this.#n.getQueryCache(),this.queryKey=t.queryKey,this.queryHash=t.queryHash,this.#t=it(this.options),this.state=t.state??this.#t,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#r?.promise}setOptions(t){this.options={...this.#a,...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#e.remove(this)}setData(t,e){const s=B(this.state.data,t,this.options);return this.#i({data:s,type:"success",dataUpdatedAt:e?.updatedAt,manual:e?.manual}),s}setState(t,e){this.#i({type:"setState",state:t,setStateOptions:e})}cancel(t){const e=this.#r?.promise;return this.#r?.cancel(t),e?e.then(j).catch(j):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#t)}isActive(){return this.observers.some(t=>H(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===T||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>G(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!I(this.state.dataUpdatedAt,t)}onFocus(){this.observers.find(e=>e.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#r?.continue()}onOnline(){this.observers.find(e=>e.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#r?.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),this.#e.notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(e=>e!==t),this.observers.length||(this.#r&&(this.#o?this.#r.cancel({revert:!0}):this.#r.cancelRetry()),this.scheduleGc()),this.#e.notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#i({type:"invalidate"})}fetch(t,e){if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&e?.cancelRefetch)this.cancel({silent:!0});else if(this.#r)return this.#r.continueRetry(),this.#r.promise}if(t&&this.setOptions(t),!this.options.queryFn){const i=this.observers.find(h=>h.options.queryFn);i&&this.setOptions(i.options)}const s=new AbortController,r=i=>{Object.defineProperty(i,"signal",{enumerable:!0,get:()=>(this.#o=!0,s.signal)})},n=()=>{const i=V(this.options,e),f=(()=>{const c={client:this.#n,queryKey:this.queryKey,meta:this.meta};return r(c),c})();return this.#o=!1,this.options.persister?this.options.persister(i,f,this):i(f)},u=(()=>{const i={fetchOptions:e,options:this.options,queryKey:this.queryKey,client:this.#n,state:this.state,fetchFn:n};return r(i),i})();this.options.behavior?.onFetch(u,this),this.#s=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==u.fetchOptions?.meta)&&this.#i({type:"fetch",meta:u.fetchOptions?.meta});const o=i=>{F(i)&&i.silent||this.#i({type:"error",error:i}),F(i)||(this.#e.config.onError?.(i,this),this.#e.config.onSettled?.(this.state.data,i,this)),this.scheduleGc()};return this.#r=Y({initialPromise:e?.initialPromise,fn:u.fetchFn,abort:s.abort.bind(s),onSuccess:i=>{if(i===void 0){o(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(i)}catch(h){o(h);return}this.#e.config.onSuccess?.(i,this),this.#e.config.onSettled?.(i,this.state.error,this),this.scheduleGc()},onError:o,onFail:(i,h)=>{this.#i({type:"failed",failureCount:i,error:h})},onPause:()=>{this.#i({type:"pause"})},onContinue:()=>{this.#i({type:"continue"})},retry:u.options.retry,retryDelay:u.options.retryDelay,networkMode:u.options.networkMode,canRun:()=>!0}),this.#r.start()}#i(t){const e=s=>{switch(t.type){case"failed":return{...s,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...s,fetchStatus:"paused"};case"continue":return{...s,fetchStatus:"fetching"};case"fetch":return{...s,...rt(s.data,this.options),fetchMeta:t.meta??null};case"success":return this.#s=void 0,{...s,data:t.data,dataUpdateCount:s.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const r=t.error;return F(r)&&r.revert&&this.#s?{...this.#s,fetchStatus:"idle"}:{...s,error:r,errorUpdateCount:s.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:s.fetchFailureCount+1,fetchFailureReason:r,fetchStatus:"idle",status:"error"};case"invalidate":return{...s,isInvalidated:!0};case"setState":return{...s,...t.state}}};this.state=e(this.state),et.batch(()=>{this.observers.forEach(s=>{s.onQueryUpdate()}),this.#e.notify({query:this,type:"updated",action:t})})}};function rt(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:D(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function it(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,s=e!==void 0,r=s?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:s?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:s?"success":"pending",fetchStatus:"idle"}}var M=w.createContext(void 0),yt=t=>{const e=w.useContext(M);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},pt=({client:t,children:e})=>(w.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),Q.jsx(M.Provider,{value:t,children:e}));export{yt as A,dt as Q,st as R,P as S,ut as a,j as b,Y as c,lt as d,V as e,ht as f,J as g,N as h,ot as i,g as j,pt as k,_ as l,at as m,et as n,x as o,O as p,H as q,G as r,T as s,ct as t,p as u,k as v,I as w,rt as x,B as y,ft as z};
