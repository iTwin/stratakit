import{D as G,z as W,x as Ce,c as Y,d as J,_ as Z,G as q,g as S,u as Q,b as w,r as X,e as ee,Z as xe,n as ve,J as Pe,m as A,l as j,C as Se,$ as we,a0 as F,A as O,a1 as he,a2 as Ee,a3 as ye,a4 as Te,a5 as Re}from"./~utils-BuKH_XhK.js";import{a as g,n as De}from"./chunk-K6AXKMTT-B_QCnNdX.js";import{u as Ae}from"./KUU7WJ55-CvL3dvMd.js";import{f as Fe}from"./YV4JVR4I-xwnP9gdF.js";var E=G(),Oe=E.useContext,tt=E.useProviderContext,_e=E.ContextProvider,ke=E.ScopedContextProvider,y=G([_e],[ke]),ze=y.useContext,nt=y.useProviderContext,rt=y.ContextProvider,ot=y.ScopedContextProvider,Ke=g.createContext(void 0),Le=g.createContext(void 0),Ne={id:null};function it(n,r,o=!1){const t=n.findIndex(a=>a.id===r);return[...n.slice(t+1),...o?[Ne]:[],...n.slice(0,t)]}function st(n,r){return n.find(o=>!o.disabled)}function Be(n,r){return r&&n.item(r)||null}function ut(n){const r=[];for(const o of n){const t=r.find(a=>{var c;return((c=a[0])==null?void 0:c.rowId)===o.rowId});t?t.push(o):r.push([o])}return r}function Me(n,r=!1){if(W(n))n.setSelectionRange(r?n.value.length:0,n.value.length);else if(n.isContentEditable){const o=Ce(n).getSelection();o==null||o.selectAllChildren(n),r&&(o==null||o.collapseToEnd())}}var _=Symbol("FOCUS_SILENTLY");function He(n){n[_]=!0,n.focus({preventScroll:!0})}function at(n){const r=n[_];return delete n[_],r}function te(n,r,o){return!(!r||r===o||!n.item(r.id))}var Ue="div",ne=Y(function(r){var o=r,{store:t,shouldRegisterItem:a=!0,getItem:c=xe,element:C}=o,p=Z(o,["store","shouldRegisterItem","getItem","element"]);const f=Oe();t=t||f;const m=q(p.id),I=g.useRef(C);return g.useEffect(()=>{const i=I.current;if(!m||!i||!a)return;const x=c({id:m,element:i});return t==null?void 0:t.renderItem(x)},[m,a,c,t]),p=S(w({},p),{ref:Q(I,p.ref)}),X(p)}),lt=J(function(r){const o=ne(r);return ee(Ue,o)}),Ve="button";function je(n){return F(n)?!0:n.tagName==="INPUT"&&!Te(n)}function $e(n,r=!1){const o=n.clientHeight,{top:t}=n.getBoundingClientRect(),a=Math.max(o*.875,o-40)*1.5,c=r?o-a+t:a+t;return n.tagName==="HTML"?c+n.scrollTop:c}function Ge(n,r=!1){const{top:o}=n.getBoundingClientRect();return r?o+n.clientHeight:o}function $(n,r,o,t=!1){var a;if(!r||!o)return;const{renderedItems:c}=r.getState(),C=Re(n);if(!C)return;const p=$e(C,t);let f,m;for(let I=0;I<c.length;I+=1){const i=f;if(f=o(I),!f)break;if(f===i)continue;const x=(a=Be(r,f))==null?void 0:a.element;if(!x)continue;const v=Ge(x,t)-p,l=Math.abs(v);if(t&&v<=0||!t&&v>=0){m!==void 0&&m<l&&(f=i);break}m=l}return f}function We(n,r){return O(n)?!1:te(r,n.target)}var Ye=Y(function(r){var o=r,{store:t,rowId:a,preventScrollOnKeyDown:c=!1,moveOnKeyPress:C=!0,tabbable:p=!1,getItem:f,"aria-setsize":m,"aria-posinset":I}=o,i=Z(o,["store","rowId","preventScrollOnKeyDown","moveOnKeyPress","tabbable","getItem","aria-setsize","aria-posinset"]);const x=ze();t=t||x;const d=q(i.id),v=g.useRef(null),l=g.useContext(Le),k=Pe(i)&&!i.accessibleWhenDisabled,{rowId:T,baseElement:z,isActiveItem:re,ariaSetSize:oe,ariaPosInSet:ie,isTabbable:se}=Fe(t,{rowId(e){if(a)return a;if(e&&l!=null&&l.baseElement&&l.baseElement===e.baseElement)return l.id},baseElement(e){return(e==null?void 0:e.baseElement)||void 0},isActiveItem(e){return!!e&&e.activeId===d},ariaSetSize(e){if(m!=null)return m;if(e&&l!=null&&l.ariaSetSize&&l.baseElement===e.baseElement)return l.ariaSetSize},ariaPosInSet(e){if(I!=null)return I;if(!e||!(l!=null&&l.ariaPosInSet)||l.baseElement!==e.baseElement)return;const s=e.renderedItems.filter(u=>u.rowId===T);return l.ariaPosInSet+s.findIndex(u=>u.id===d)},isTabbable(e){if(!(e!=null&&e.renderedItems.length))return!0;if(e.virtualFocus)return!1;if(p)return!0;if(e.activeId===null)return!1;const s=t==null?void 0:t.item(e.activeId);return s!=null&&s.disabled||!(s!=null&&s.element)?!0:e.activeId===d}}),ue=g.useCallback(e=>{var s;const u=S(w({},e),{id:d||e.id,rowId:T,disabled:!!k,children:(s=e.element)==null?void 0:s.textContent});return f?f(u):u},[d,T,k,f]),K=i.onFocus,R=g.useRef(!1),ae=A(e=>{if(K==null||K(e),e.defaultPrevented||we(e)||!d||!t||We(e,t))return;const{virtualFocus:s,baseElement:u}=t.getState();if(t.setActiveId(d),F(e.currentTarget)&&Me(e.currentTarget),!s||!O(e)||je(e.currentTarget)||!(u!=null&&u.isConnected))return;he()&&e.currentTarget.hasAttribute("data-autofocus")&&e.currentTarget.scrollIntoView({block:"nearest",inline:"nearest"}),R.current=!0,e.relatedTarget===u||te(t,e.relatedTarget)?He(u):u.focus()}),L=i.onBlurCapture,le=A(e=>{if(L==null||L(e),e.defaultPrevented)return;const s=t==null?void 0:t.getState();s!=null&&s.virtualFocus&&R.current&&(R.current=!1,e.preventDefault(),e.stopPropagation())}),N=i.onKeyDown,fe=j(c),de=j(C),ce=A(e=>{if(N==null||N(e),e.defaultPrevented||!O(e)||!t)return;const{currentTarget:s}=e,u=t.getState(),D=t.item(d),b=!!(D!=null&&D.rowId),h=u.orientation!=="horizontal",P=u.orientation!=="vertical",M=()=>!!(b||P||!u.baseElement||!W(u.baseElement)),H={ArrowUp:(b||h)&&t.up,ArrowRight:(b||P)&&t.next,ArrowDown:(b||h)&&t.down,ArrowLeft:(b||P)&&t.previous,Home:()=>{if(M())return!b||e.ctrlKey?t==null?void 0:t.first():t==null?void 0:t.previous(-1)},End:()=>{if(M())return!b||e.ctrlKey?t==null?void 0:t.last():t==null?void 0:t.next(-1)},PageUp:()=>$(s,t,t==null?void 0:t.up,!0),PageDown:()=>$(s,t,t==null?void 0:t.down)}[e.key];if(H){if(F(s)){const V=Ee(s),me=P&&e.key==="ArrowLeft",pe=P&&e.key==="ArrowRight",Ie=h&&e.key==="ArrowUp",ge=h&&e.key==="ArrowDown";if(pe||ge){const{length:be}=ye(s);if(V.end!==be)return}else if((me||Ie)&&V.start!==0)return}const U=H();if(fe(e)||U!==void 0){if(!de(e))return;e.preventDefault(),t.move(U)}}}),B=g.useMemo(()=>({id:d,baseElement:z}),[d,z]);return i=Se(i,e=>De.jsx(Ke.Provider,{value:B,children:e}),[B]),i=S(w({id:d,"data-active-item":re||void 0},i),{ref:Q(v,i.ref),tabIndex:se?i.tabIndex:-1,onFocus:ae,onBlurCapture:le,onKeyDown:ce}),i=Ae(i),i=ne(S(w({store:t},i),{getItem:ue,shouldRegisterItem:d?i.shouldRegisterItem:!1})),X(S(w({},i),{"aria-setsize":oe,"aria-posinset":ie}))}),ft=ve(J(function(r){const o=Ye(r);return ee(Ve,o)}));export{ot as C,rt as a,Ye as b,ft as c,ne as d,tt as e,it as f,ke as g,lt as h,nt as i,Be as j,te as k,st as l,ut as m,at as s,ze as u};
