var _e=t=>{throw TypeError(t)};var fe=(t,e,s)=>e.has(t)||_e("Cannot "+s);var i=(t,e,s)=>(fe(t,e,"read from private field"),s?s.call(t):e.get(t)),T=(t,e,s)=>e.has(t)?_e("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,s),y=(t,e,s,r)=>(fe(t,e,"write to private field"),r?r.call(t,s):e.set(t,s),s),I=(t,e,s)=>(fe(t,e,"access private method"),s);import{w as Ge,I as ee,V as Z,b as ae,B as Xe,c as Je,d as Ye}from"./~utils-DI3yI_ih.js";import{b as o,w as Ze,p as n,n as we}from"./index-DDCMeoDP.js";import{D as Ue,a as qe,b as Be,c as O,d as et}from"./DropdownMenu-D6j9j96j.js";import{F as tt,a as st,b as nt}from"./Field-2N87J1p6.js";import{S as rt,H as it}from"./Select-Cv2X_RAg.js";import{S as oe}from"./Skeleton-B_k0P4Rn.js";import{T as at,a as ot,b as lt,c as ct}from"./Tabs-D4cxVwuT.js";import{T as ce}from"./Text-DMZeM15d.js";import{T as ut,a as dt,b as ht}from"./TextBox-BoQYhOHX.js";import{T as ft,a as pt,b as pe}from"./Tree--iFLs4NF.js";import{S as mt,l as Te,q as U,t as me,r as ie,b as vt,u as ve,v as Me,w as xt,g as bt,x as gt,y as Fe,n as Qe,z as jt}from"./QueryClientProvider-BZJipc45.js";import{p as te}from"./placeholder-UZ_lwBqM.js";import{p as Ct,l as St,h as yt,s as ke,m as Rt,d as It,f as _t}from"./visibility-hide-C13rsBci.js";import{s as wt}from"./visibility-show-CsRoR_5s.js";import"./~utils.ListItem-C4zSZW2f.js";import"./Kbd-B0ltp174.js";import"./ITI7HKP4-OaI4jL81.js";import"./C3IKGW5T-CQmNlAHf.js";import"./VEVQD5MH-BXX-Zj38.js";import"./P4IRICAX-COeS1Nf_.js";import"./ASMQKSDT-C6kxLmT9.js";var z,v,ne,P,V,G,A,L,re,X,J,W,$,H,Y,g,se,xe,be,ge,je,Ce,Se,ye,Ae,Le,Tt=(Le=class extends mt{constructor(e,s){super();T(this,g);T(this,z);T(this,v);T(this,ne);T(this,P);T(this,V);T(this,G);T(this,A);T(this,L);T(this,re);T(this,X);T(this,J);T(this,W);T(this,$);T(this,H);T(this,Y,new Set);this.options=s,y(this,z,e),y(this,L,null),y(this,A,Te()),this.options.experimental_prefetchInRender||i(this,A).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(s)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(i(this,v).addObserver(this),Pe(i(this,v),this.options)?I(this,g,se).call(this):this.updateResult(),I(this,g,je).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Re(i(this,v),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Re(i(this,v),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,I(this,g,Ce).call(this),I(this,g,Se).call(this),i(this,v).removeObserver(this)}setOptions(e,s){const r=this.options,c=i(this,v);if(this.options=i(this,z).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof U(this.options.enabled,i(this,v))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");I(this,g,ye).call(this),i(this,v).setOptions(this.options),r._defaulted&&!me(this.options,r)&&i(this,z).getQueryCache().notify({type:"observerOptionsUpdated",query:i(this,v),observer:this});const u=this.hasListeners();u&&ze(i(this,v),c,this.options,r)&&I(this,g,se).call(this),this.updateResult(s),u&&(i(this,v)!==c||U(this.options.enabled,i(this,v))!==U(r.enabled,i(this,v))||ie(this.options.staleTime,i(this,v))!==ie(r.staleTime,i(this,v)))&&I(this,g,xe).call(this);const a=I(this,g,be).call(this);u&&(i(this,v)!==c||U(this.options.enabled,i(this,v))!==U(r.enabled,i(this,v))||a!==i(this,H))&&I(this,g,ge).call(this,a)}getOptimisticResult(e){const s=i(this,z).getQueryCache().build(i(this,z),e),r=this.createResult(s,e);return Ft(this,r)&&(y(this,P,r),y(this,G,this.options),y(this,V,i(this,v).state)),r}getCurrentResult(){return i(this,P)}trackResult(e,s){const r={};return Object.keys(e).forEach(c=>{Object.defineProperty(r,c,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(c),s==null||s(c),e[c])})}),r}trackProp(e){i(this,Y).add(e)}getCurrentQuery(){return i(this,v)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const s=i(this,z).defaultQueryOptions(e),r=i(this,z).getQueryCache().build(i(this,z),s);return r.fetch().then(()=>this.createResult(r,s))}fetch(e){return I(this,g,se).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),i(this,P)))}createResult(e,s){var K;const r=i(this,v),c=this.options,u=i(this,P),a=i(this,V),p=i(this,G),l=e!==r?e.state:i(this,ne),{state:h}=e;let d={...h},m=!1,j;if(s._optimisticResults){const w=this.hasListeners(),B=!w&&Pe(e,s),S=w&&ze(e,r,s,c);(B||S)&&(d={...d,...gt(h.data,e.options)}),s._optimisticResults==="isRestoring"&&(d.fetchStatus="idle")}let{error:M,errorUpdatedAt:E,status:C}=d;if(s.select&&d.data!==void 0)if(u&&d.data===(a==null?void 0:a.data)&&s.select===i(this,re))j=i(this,X);else try{y(this,re,s.select),j=s.select(d.data),j=Fe(u==null?void 0:u.data,j,s),y(this,X,j),y(this,L,null)}catch(w){y(this,L,w)}else j=d.data;if(s.placeholderData!==void 0&&j===void 0&&C==="pending"){let w;if(u!=null&&u.isPlaceholderData&&s.placeholderData===(p==null?void 0:p.placeholderData))w=u.data;else if(w=typeof s.placeholderData=="function"?s.placeholderData((K=i(this,J))==null?void 0:K.state.data,i(this,J)):s.placeholderData,s.select&&w!==void 0)try{w=s.select(w),y(this,L,null)}catch(B){y(this,L,B)}w!==void 0&&(C="success",j=Fe(u==null?void 0:u.data,w,s),m=!0)}i(this,L)&&(M=i(this,L),j=i(this,X),E=Date.now(),C="error");const _=d.fetchStatus==="fetching",F=C==="pending",q=C==="error",b=F&&_,D=j!==void 0,k={status:C,fetchStatus:d.fetchStatus,isPending:F,isSuccess:C==="success",isError:q,isInitialLoading:b,isLoading:b,data:j,dataUpdatedAt:d.dataUpdatedAt,error:M,errorUpdatedAt:E,failureCount:d.fetchFailureCount,failureReason:d.fetchFailureReason,errorUpdateCount:d.errorUpdateCount,isFetched:d.dataUpdateCount>0||d.errorUpdateCount>0,isFetchedAfterMount:d.dataUpdateCount>l.dataUpdateCount||d.errorUpdateCount>l.errorUpdateCount,isFetching:_,isRefetching:_&&!F,isLoadingError:q&&!D,isPaused:d.fetchStatus==="paused",isPlaceholderData:m,isRefetchError:q&&D,isStale:Ie(e,s),refetch:this.refetch,promise:i(this,A)};if(this.options.experimental_prefetchInRender){const w=R=>{k.status==="error"?R.reject(k.error):k.data!==void 0&&R.resolve(k.data)},B=()=>{const R=y(this,A,k.promise=Te());w(R)},S=i(this,A);switch(S.status){case"pending":e.queryHash===r.queryHash&&w(S);break;case"fulfilled":(k.status==="error"||k.data!==S.value)&&B();break;case"rejected":(k.status!=="error"||k.error!==S.reason)&&B();break}}return k}updateResult(e){const s=i(this,P),r=this.createResult(i(this,v),this.options);if(y(this,V,i(this,v).state),y(this,G,this.options),i(this,V).data!==void 0&&y(this,J,i(this,v)),me(r,s))return;y(this,P,r);const c={},u=()=>{if(!s)return!0;const{notifyOnChangeProps:a}=this.options,p=typeof a=="function"?a():a;if(p==="all"||!p&&!i(this,Y).size)return!0;const f=new Set(p??i(this,Y));return this.options.throwOnError&&f.add("error"),Object.keys(i(this,P)).some(l=>{const h=l;return i(this,P)[h]!==s[h]&&f.has(h)})};(e==null?void 0:e.listeners)!==!1&&u()&&(c.listeners=!0),I(this,g,Ae).call(this,{...c,...e})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&I(this,g,je).call(this)}},z=new WeakMap,v=new WeakMap,ne=new WeakMap,P=new WeakMap,V=new WeakMap,G=new WeakMap,A=new WeakMap,L=new WeakMap,re=new WeakMap,X=new WeakMap,J=new WeakMap,W=new WeakMap,$=new WeakMap,H=new WeakMap,Y=new WeakMap,g=new WeakSet,se=function(e){I(this,g,ye).call(this);let s=i(this,v).fetch(this.options,e);return e!=null&&e.throwOnError||(s=s.catch(vt)),s},xe=function(){I(this,g,Ce).call(this);const e=ie(this.options.staleTime,i(this,v));if(ve||i(this,P).isStale||!Me(e))return;const r=xt(i(this,P).dataUpdatedAt,e)+1;y(this,W,setTimeout(()=>{i(this,P).isStale||this.updateResult()},r))},be=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(i(this,v)):this.options.refetchInterval)??!1},ge=function(e){I(this,g,Se).call(this),y(this,H,e),!(ve||U(this.options.enabled,i(this,v))===!1||!Me(i(this,H))||i(this,H)===0)&&y(this,$,setInterval(()=>{(this.options.refetchIntervalInBackground||bt.isFocused())&&I(this,g,se).call(this)},i(this,H)))},je=function(){I(this,g,xe).call(this),I(this,g,ge).call(this,I(this,g,be).call(this))},Ce=function(){i(this,W)&&(clearTimeout(i(this,W)),y(this,W,void 0))},Se=function(){i(this,$)&&(clearInterval(i(this,$)),y(this,$,void 0))},ye=function(){const e=i(this,z).getQueryCache().build(i(this,z),this.options);if(e===i(this,v))return;const s=i(this,v);y(this,v,e),y(this,ne,e.state),this.hasListeners()&&(s==null||s.removeObserver(this),e.addObserver(this))},Ae=function(e){Qe.batch(()=>{e.listeners&&this.listeners.forEach(s=>{s(i(this,P))}),i(this,z).getQueryCache().notify({query:i(this,v),type:"observerResultsUpdated"})})},Le);function Mt(t,e){return U(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function Pe(t,e){return Mt(t,e)||t.state.data!==void 0&&Re(t,e,e.refetchOnMount)}function Re(t,e,s){if(U(e.enabled,t)!==!1){const r=typeof s=="function"?s(t):s;return r==="always"||r!==!1&&Ie(t,e)}return!1}function ze(t,e,s,r){return(t!==e||U(r.enabled,t)===!1)&&(!s.suspense||t.state.status!=="error")&&Ie(t,s)}function Ie(t,e){return U(e.enabled,t)!==!1&&t.isStaleByTime(ie(e.staleTime,t))}function Ft(t,e){return!me(t.getCurrentResult(),e)}var He=o.createContext(!1),kt=()=>o.useContext(He);He.Provider;function Pt(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var zt=o.createContext(Pt()),Et=()=>o.useContext(zt);function Nt(t,e){return typeof t=="function"?t(...e):!!t}function Ee(){}var Ot=(t,e)=>{(t.suspense||t.throwOnError||t.experimental_prefetchInRender)&&(e.isReset()||(t.retryOnMount=!1))},Dt=t=>{o.useEffect(()=>{t.clearReset()},[t])},Lt=({result:t,errorResetBoundary:e,throwOnError:s,query:r,suspense:c})=>t.isError&&!e.isReset()&&!t.isFetching&&r&&(c&&t.data===void 0||Nt(s,[t.error,r])),Ut=t=>{const e=t.staleTime;t.suspense&&(t.staleTime=typeof e=="function"?(...s)=>Math.max(e(...s),1e3):Math.max(e??1e3,1e3),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3)))},qt=(t,e)=>t.isLoading&&t.isFetching&&!e,Bt=(t,e)=>(t==null?void 0:t.suspense)&&e.isPending,Ne=(t,e,s)=>e.fetchOptimistic(t).catch(()=>{s.clearReset()});function Qt(t,e,s){var d,m,j,M,E;const r=jt(),c=kt(),u=Et(),a=r.defaultQueryOptions(t);(m=(d=r.getDefaultOptions().queries)==null?void 0:d._experimental_beforeQuery)==null||m.call(d,a),a._optimisticResults=c?"isRestoring":"optimistic",Ut(a),Ot(a,u),Dt(u);const p=!r.getQueryCache().get(a.queryHash),[f]=o.useState(()=>new e(r,a)),l=f.getOptimisticResult(a),h=!c&&t.subscribed!==!1;if(o.useSyncExternalStore(o.useCallback(C=>{const _=h?f.subscribe(Qe.batchCalls(C)):Ee;return f.updateResult(),_},[f,h]),()=>f.getCurrentResult(),()=>f.getCurrentResult()),o.useEffect(()=>{f.setOptions(a,{listeners:!1})},[a,f]),Bt(a,l))throw Ne(a,f,u);if(Lt({result:l,errorResetBoundary:u,throwOnError:a.throwOnError,query:r.getQueryCache().get(a.queryHash),suspense:a.suspense}))throw l.error;if((M=(j=r.getDefaultOptions().queries)==null?void 0:j._experimental_afterQuery)==null||M.call(j,a,l),a.experimental_prefetchInRender&&!ve&&qt(l,c)){const C=p?Ne(a,f,u):(E=r.getQueryCache().get(a.queryHash))==null?void 0:E.promise;C==null||C.catch(Ee).finally(()=>{f.updateResult()})}return a.notifyOnChangeProps?l:f.trackResult(l)}function At(t,e){return Qt(t,Tt)}const Ht="_appLayout_1l3qw_5",Vt="_header_1l3qw_22",Wt="_platformBar_1l3qw_32",$t="_logo_1l3qw_38",Kt="_tools_1l3qw_48",Gt="_leftPanel_1l3qw_58",Xt="_panelHeader_1l3qw_70",Jt="_panelTitleWrapper_1l3qw_78",Yt="_panelCaption_1l3qw_82",Zt="_shiftIconRight_1l3qw_86",es="_subheader_1l3qw_90",ts="_searchInput_1l3qw_106",ss="_subheaderActions_1l3qw_110",ns="_tabList_1l3qw_114",rs="_emptyState_1l3qw_119",is="_skeletonTree_1l3qw_128",as="_skeletonTreeItem_1l3qw_135",os="_canvasWrapper_1l3qw_144",ls="_canvas_1l3qw_144",cs="_splitter_1l3qw_181",us="_tabPanel_1l3qw_227",ds="_tree_1l3qw_239",hs="_slider_1l3qw_254",fs="_colorSwatch_1l3qw_263",x={appLayout:Ht,header:Vt,platformBar:Wt,logo:$t,tools:Kt,leftPanel:Gt,panelHeader:Xt,panelTitleWrapper:Jt,panelCaption:Yt,shiftIconRight:Zt,subheader:es,searchInput:ts,subheaderActions:ss,tabList:ns,emptyState:rs,skeletonTree:is,skeletonTreeItem:as,canvasWrapper:os,canvas:ls,splitter:cs,tabPanel:us,tree:ds,slider:hs,colorSwatch:fs},ps="/463/assets/sandbox.model1-CoozF5xy.json",ms="/463/assets/sandbox.model2-Bi69Ub92.json",vs="data:application/json;base64,ewoJIm5hbWUiOiAiRXBvY2ggU3lzdGVtIGlNb2RlbCAzIiwKCSJ2ZXJzaW9uIjogIjIwMjQgUmVmcmVzaCIsCgkiZGF0YSI6IHsKCQkiZGVmYXVsdCI6IFtdCgl9Cn0K",le={model1:{name:"Epoch System iModel 1",url:ps},model2:{name:"Epoch System iModel 2",url:ms},model3:{name:"Epoch System iModel 3",url:vs}};async function xs(t){if(t in le){const e=await fetch(le[t].url).then(s=>s.json());return e.slow&&await new Promise(s=>setTimeout(s,Math.random()*2e3)),e}return{name:"Unknown",version:"Unknown",data:{default:[]}}}const Ve="Kiwi sandbox",sn=()=>[{title:Ve}],nn=Ge(function(){var u;const[e,s]=Ze(),r=e.get("model")||"model1",c=At({queryKey:["sandbox-data",r],queryFn:()=>xs(r)});return n.jsxs(bs,{panelContent:n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:x.panelHeader,children:[n.jsxs("div",{children:[n.jsxs(tt,{children:[n.jsx(Z,{render:n.jsx(st,{}),children:"Choose Model"}),n.jsx(nt,{render:a=>n.jsx(rt,{className:x.panelTitleWrapper,children:n.jsx(it,{...a,variant:"ghost",defaultValue:r,onChange:p=>s({model:p.currentTarget.value}),children:Object.entries(le).map(([p,{name:f}])=>n.jsx("option",{value:p,children:f},p))})})})]}),n.jsxs("hgroup",{role:"group",children:[n.jsx(Z,{render:n.jsx("h2",{}),children:(u=le[r])==null?void 0:u.name}),n.jsx(o.Suspense,{fallback:n.jsx(oe,{variant:"text"}),children:n.jsx(Cs,{query:c})},r)]})]}),n.jsx("div",{className:x.actions,children:n.jsx(ae,{className:x.shiftIconRight,icon:Ct,label:"Dock panel",variant:"ghost",disabled:!0})})]}),n.jsx(o.Suspense,{fallback:n.jsx(gs,{}),children:n.jsx(Ss,{query:c})},r)]}),children:[n.jsxs("header",{className:x.header,children:[n.jsx("div",{className:x.logo,children:n.jsx(ee,{href:te,size:"large"})}),n.jsx(ce,{render:a=>n.jsx("h1",{...a}),variant:"body-md",children:Ve})]}),n.jsx("div",{className:x.platformBar,children:n.jsxs("div",{className:x.tools,children:[n.jsx(ee,{href:te,size:"large"}),n.jsx(ee,{href:te,size:"large"}),n.jsx(ee,{href:te,size:"large"})]})}),n.jsx("div",{className:x.canvasWrapper,children:n.jsx("div",{className:x.canvas})})]})});function bs(t){const{sliderProps:e,panelProps:s,panelMinSize:r,panelMaxSize:c,resizing:u}=_s({minSize:{px:256,pct:20},maxSize:{pct:30}}),a=o.useId();return n.jsxs("div",{className:x.appLayout,style:{"--_panel-min-size":r,"--_panel-max-size":c},children:[n.jsx("div",{...s,className:x.leftPanel,style:{position:"relative",...s.style},children:t.panelContent}),n.jsxs("div",{className:x.splitter,"data-resizing":u?"true":void 0,children:[n.jsx(Z,{render:p=>n.jsx("label",{...p,htmlFor:a,children:"Resize layers panel"}),children:"Resize layers panel"}),n.jsx("input",{id:a,type:"range",className:x.slider,...e})]}),t.children]})}function gs(){const t=[1,1,2,2,3,2,3,2,1,1,2,3,4,5,2,3,4,5];return n.jsxs(n.Fragment,{children:[n.jsx("div",{className:x.subheader,children:n.jsx(oe,{variant:"text"})}),n.jsxs("div",{className:x.skeletonTree,children:[t.map((e,s)=>n.jsx(js,{style:{"--level":e}},`${s}-${e}`)),n.jsx(Z,{children:"Loadingâ€¦"})]})]})}function js(t){return n.jsxs("div",{...t,className:Ye(x.skeletonTreeItem,t.className),children:[n.jsx(oe,{variant:"object",size:"small"}),n.jsx(oe,{variant:"text"})]})}function Cs(t){const{version:e=""}=o.use(t.query.promise);return n.jsx(ce,{className:x.panelCaption,variant:"body-sm",render:n.jsx("p",{}),children:e})}function Ss(t){var f;const{data:e}=o.use(t.query.promise),[s,r]=o.useState(!e),c=o.useMemo(()=>Object.entries(e).map(([l,h])=>{const d=h.length<=1?[]:h.map(({label:m})=>m);return{name:l,filters:d,content:h.length>0?n.jsx(Fs,{name:l,data:h,isSearchboxVisible:s}):n.jsxs(ys,{children:[n.jsx(ce,{variant:"body-sm",children:"No layers"}),n.jsx(Xe,{children:"Create a layer"})]})}}),[e,s]),[u,a]=o.useState((f=c[0])==null?void 0:f.name),p=o.useMemo(()=>{var l;return u?((l=c.find(h=>h.name===u))==null?void 0:l.filters)||[]:c[0].filters},[c,u]);return c.length===1?n.jsxs(De,{allFilters:p,children:[n.jsx(Oe,{isSearchboxVisible:s,setIsSearchboxVisible:r}),c[0].content]}):n.jsx(De,{allFilters:p,children:n.jsxs(at,{selectOnMove:!1,setSelectedId:a,children:[n.jsx(Oe,{tabs:c.map(l=>n.jsx(ot,{id:l.name,children:Je(l.name)},l.name)),isSearchboxVisible:s,setIsSearchboxVisible:r}),c.map(l=>n.jsx(o.Fragment,{children:l.content},l.name))]})})}function ys({children:t}){return n.jsx("div",{className:x.emptyState,children:t})}function Rs(){return n.jsx("div",{style:{textAlign:"center"},children:n.jsx(ce,{variant:"body-sm",children:"No results found"})})}function Is(t,e,s){return Math.min(Math.max(t,e),s)}function _s(t){const{minSize:e,maxSize:s,onCollapse:r}=t??{},c=o.useId(),u=o.useRef(null),[a,p]=o.useState(void 0),[f,l]=o.useState(void 0),[h,d]=o.useState(void 0),[m,j]=o.useState(!1),[M,E]=o.useState(void 0),C=o.useMemo(()=>{if(e&&f)return Math.min(e.px,e.pct/100*f)},[e,f]),_=o.useMemo(()=>{if(C&&s&&f)return Math.max(C,s.pct/100*f)},[s,f,C]),F=o.useMemo(()=>{if(h==="smallest")return C??0;if(h==="largest")return _??0;if(a&&C&&_)return Is(a,C,_)},[a,C,_,h]);o.useEffect(()=>{const S=u.current;if(!S)return;const R=S.parentElement;if(!R)return;const Q=new ResizeObserver(()=>{const de=R.getBoundingClientRect(),he=S.getBoundingClientRect();l(de.width),p(he.width)});return Q.observe(R),Q.observe(S),()=>{Q.disconnect()}},[]);const q=o.useCallback(S=>{const R=u.current;if(!R)return;const Q=R.getBoundingClientRect();E(Q.width+S),d(void 0),j(!0)},[]),b=o.useCallback(S=>{const R=u.current;if(!R)return;const Q=R.parentElement;if(!Q)return;const de=Q.getBoundingClientRect(),he=S*(de.width*.005),Ke=R.getBoundingClientRect();E(Ke.width+he),d(void 0)},[]),D=o.useCallback(()=>{u.current&&(E(void 0),j(!1))},[]),{moveableProps:N}=ws({onMove:q,onMoveEnd:D,onKeyMove:b}),k=o.useMemo(()=>({...N,onKeyDown:S=>{var R;if((R=N.onKeyDown)==null||R.call(N,S),!S.defaultPrevented)switch(S.key){case"Enter":S.preventDefault(),r==null||r();break;case"Home":S.preventDefault(),d("smallest");break;case"End":S.preventDefault(),d("largest");break}},onChange:S=>{if(m)return;const R=Number(S.target.value);E(R)},value:F===void 0?0:Math.floor(F),min:C===void 0?void 0:Math.floor(C),max:_===void 0?void 0:Math.floor(_)}),[N,F,C,_,r,m]),K=o.useMemo(()=>({style:{WebkitUserSelect:M===void 0?void 0:"none"},id:c,ref:u}),[c,M]),w=C===void 0?void 0:`${Math.floor(C)}px`,B=o.useMemo(()=>{if(M!==void 0&&s!==void 0&&h===void 0)return`min(${Math.floor(M)}px, ${s.pct}%)`;if(F!==void 0)return`${Math.floor(F)}px`},[s,M,F,h]);return{sliderProps:k,panelProps:K,panelMinSize:w,panelMaxSize:B,resizing:m}}function ws(t){const{onMove:e,onMoveEnd:s,onKeyMove:r}=t??{},c=o.useRef(null),u=o.useRef(void 0),a=o.useRef(void 0),p=o.useCallback(()=>{a.current!==void 0&&(a.current=void 0,s==null||s())},[s]);return{moveableProps:o.useMemo(()=>({onPointerDown:l=>{if(l.button!==0||l.ctrlKey)return;const h=c.current;if(!h)return;const d=h.getBoundingClientRect(),m=l.clientX-d.left;a.current=m,l.preventDefault(),h.setPointerCapture(l.pointerId)},onPointerMove:l=>{const h=a.current;if(h===void 0)return;const d=c.current;if(!d)return;const m=d.getBoundingClientRect(),j=l.clientX-h-m.left;l.preventDefault(),e==null||e(j)},onPointerUp:p,onPointerCancel:p,onKeyDown:l=>{if(!l.defaultPrevented)switch(l.key){case"ArrowLeft":l.preventDefault(),r==null||r(-1);break;case"ArrowRight":l.preventDefault(),r==null||r(1);break}},ref:l=>{var d;if(c.current=l,(d=u.current)==null||d.call(u),u.current=void 0,!l)return;const h=m=>{m.preventDefault()};l.addEventListener("touchstart",h),u.current=()=>{l.removeEventListener("touchstart",h)}}}),[r,e,p])}}const We=(()=>{let t=0;return e=>({id:`${t++}`,label:`Tree Item ${t}`,expanded:!0,...e,items:((e==null?void 0:e.items)??[]).map(We)})})();function Ts({items:t,filters:e,search:s}){const r=o.useMemo(()=>e.length===0?t:t.reduce((a,p)=>(e.includes(p.label)&&a.push(p),a),[]),[t,e]),c=o.useMemo(()=>{function a(p){return p.reduce((f,l)=>{const h=a(l.items??[]);return(l.label.toLowerCase().includes(s.toLowerCase())||h.length>0)&&f.push({...l,items:h}),f},[])}return s===""?r:a(r)},[r,s]),u=o.useMemo(()=>{if(e.length===0&&s==="")return;function a(p){return p.reduce((f,l)=>{const h=l.items?a(l.items):0;return f+1+h},0)}return a(c)},[c,e,s]);return{filteredTree:c,itemCount:u}}function Ms(t,e,s){return o.useMemo(()=>{function r(c,u,a,p,f){const l=[];let h=1;for(const d of c){const m=d.id===e||p,j=s.includes(d.id)||f;l.push({...d,level:a,parentItem:u,selected:m,hidden:j,parentHidden:f,position:h++,size:c.length}),d.expanded&&l.push(...r(d.items,d,a+1,m,j))}return l}return r(t,void 0,1,!1,!1)},[t,e,s])}function $e(t,e){for(const s of t){if(s.id===e)return s;const r=$e(s.items,e);if(r)return r}}function Fs({name:t,data:e,isSearchboxVisible:s}){var q;const{appliedFilters:r,search:c,setItemCount:u}=o.useContext(ue),[a,p]=o.useState(),[f,l]=o.useState([]),h=o.useCallback(b=>{l(D=>D.includes(b)?D.filter(N=>N!==b):[...D,b])},[]),[d,m]=o.useState(()=>e.map(b=>We(b))),{filteredTree:j,itemCount:M}=Ts({items:d,filters:r,search:c}),E=Ms(j,a,f);o.useEffect(()=>{u(M)},[u,M]);const C=o.useDeferredValue(E);if(C.length===0)return n.jsx(Rs,{});const _=o.useRef(null),F=s?"div":lt;return n.jsx(F,{...F!=="div"&&{tabId:t},className:x.tabPanel,focusable:!1,...F!=="div"&&{unmountOnHide:!0},ref:_,...F==="div"&&((q=_==null?void 0:_.current)==null?void 0:q.dataset.open)&&{"data-open":!0},children:n.jsx(o.Suspense,{fallback:"Loading...",children:n.jsx(ft,{className:x.tree,children:C.map(b=>n.jsx(pt,{label:b.label,description:b.description,"aria-level":b.level,"aria-posinset":b.position,"aria-setsize":b.size,selected:b.selected,onSelectedChange:()=>{if(a===b.id){p(void 0);return}p(b.id)},expanded:b.items.length===0?void 0:b.expanded,onExpandedChange:D=>{m(N=>{const k=$e(N,b.id);if(!k)return N;const K=[...N];return k.expanded=D,K})},unstable_decorations:n.jsxs(n.Fragment,{children:[b.color?n.jsx(zs,{color:b.color,alt:b.color}):null,n.jsx(ee,{href:te})]}),actions:[n.jsx(pe,{className:x.action,icon:St,label:"Lock"},"lock"),n.jsx(pe,{className:x.action,icon:b.hidden?yt:wt,label:b.hidden?"Show":"Hide",visible:b.hidden?!0:void 0,onClick:()=>{h(b.id)}},"visibility"),n.jsx(ks,{},"more")]},b.id))})})},t)}function ks(){return n.jsxs(Ue,{children:[n.jsx(qe,{className:x.action,render:n.jsx(pe,{icon:Rt,label:"More"})}),n.jsxs(Be,{style:{minInlineSize:164},children:[n.jsx(O,{label:"Copy",shortcuts:"Command+C"}),n.jsx(O,{label:"Paste",shortcuts:"Command+P"}),n.jsx(O,{label:"Copy/Paste as",shortcuts:"Command+V"}),n.jsx(O,{label:"Move to",shortcuts:"Command+M"}),n.jsx(O,{label:"Bring to front",shortcuts:"]"}),n.jsx(O,{label:"Send to back",shortcuts:"["}),n.jsx(O,{label:"Group selection",shortcuts:"Command+G"}),n.jsx(O,{label:"Ungroup",shortcuts:"Command+U"}),n.jsx(O,{label:"Rename",shortcuts:"Command+R"}),n.jsx(O,{label:"Show/hide",shortcuts:"Shift+Command+V"}),n.jsx(O,{label:"Lock/unlock",shortcuts:"Shift+Command+L"}),n.jsx(O,{label:"Isolate object",shortcuts:"I"})]})]})}function Oe({tabs:t,isSearchboxVisible:e,setIsSearchboxVisible:s}){const{itemCount:r,isFiltered:c,search:u,setSearch:a}=o.useContext(ue),p=o.useRef(null),f=o.useRef(null),l=c||!!u,h=e?n.jsxs(n.Fragment,{children:[n.jsx(Ps,{}),t?n.jsx(ae,{className:x.shiftIconRight,icon:It,label:"Close",variant:"ghost",onClick:()=>{var m;we.flushSync(()=>s(!1)),(m=f.current)==null||m.focus()}}):null]}):n.jsx(ae,{className:x.shiftIconRight,icon:ke,label:"Search",dot:l?"Some filters or search applied":void 0,variant:"ghost",onClick:()=>{var m;we.flushSync(()=>s(!0)),(m=p.current)==null||m.focus()}}),d=o.useMemo(()=>{if(c)return r===void 0?"Showing all tree items":`Showing ${r} tree items`},[c,r]);return n.jsxs("div",{className:x.subheader,children:[n.jsx(Z,{"aria-live":"polite","aria-atomic":!0,children:d}),t&&!e?n.jsx(ct,{className:x.tabList,tone:"accent",ref:f,children:t}):null,e?n.jsxs(ut,{className:x.searchInput,children:[n.jsx(dt,{href:ke}),n.jsx(ht,{placeholder:"Search",ref:p,onChange:m=>a(m.currentTarget.value)})]}):null,n.jsx("div",{className:x.subheaderActions,children:h})]})}function Ps(){const t=o.useContext(ue),e=t.appliedFilters.length>0;return n.jsxs(Ue,{children:[n.jsx(qe,{render:n.jsx(ae,{icon:_t,label:"Filter",dot:e?"Some filters applied":void 0,variant:"ghost",disabled:t.allFilters.length===0})}),n.jsx(Be,{children:t.allFilters.map(s=>{const r=t.appliedFilters.includes(s);return n.jsx(et,{name:s,label:s,checked:r,onChange:()=>{t.toggleFilter(s)}},s)})})]})}function De(t){const[e,s]=o.useState(!1),[r,c]=o.useState([]),[u,a]=o.useState(""),[p,f]=o.useState(void 0),l=o.useCallback(m=>{const j=r.includes(m)?r.filter(M=>M!==m):[...r,m];c(j),s(j.length>0)},[r]),h=o.useCallback(()=>{c([]),s(!1)},[]),d=o.useCallback(m=>{a(m),s(!!m)},[]);return n.jsx(ue.Provider,{value:o.useMemo(()=>({allFilters:t.allFilters,appliedFilters:r,isFiltered:e,toggleFilter:l,clearFilters:h,search:u,setSearch:d,itemCount:p,setItemCount:f}),[t.allFilters,r,e,l,h,u,d,p]),children:t.children})}const ue=o.createContext({allFilters:[],appliedFilters:[],isFiltered:!1,toggleFilter:()=>{},clearFilters:()=>{},search:"",setSearch:()=>{},itemCount:void 0,setItemCount:()=>{}});function zs(t){return n.jsx("div",{className:x.colorSwatch,style:{"--_color":`var(--_color--${t.color})`},children:t.alt?n.jsx(Z,{children:t.alt}):null})}export{nn as default,sn as meta};
